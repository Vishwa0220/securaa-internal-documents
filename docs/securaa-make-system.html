<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Securaa Platform Documentation - Securaa Make System">
    <title>Securaa Make System - Securaa Documentation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>

:root {
    --primary-color: #4f46e5;
    --primary-dark: #3730a3;
    --primary-light: #818cf8;
    --secondary-color: #06b6d4;
    --accent-color: #f59e0b;
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
    --text-muted: #9ca3af;
    --bg-primary: #ffffff;
    --bg-secondary: #f9fafb;
    --bg-tertiary: #f3f4f6;
    --border-color: #e5e7eb;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    scroll-behavior: smooth;
    font-size: 16px;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.7;
    color: var(--text-primary);
    background-color: var(--bg-secondary);
}

/* Header */
.main-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 1rem 2rem;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: var(--shadow-lg);
}

.header-content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-logo {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -0.025em;
}

.header-logo span {
    color: var(--secondary-color);
}

/* Navigation */
.documentation-nav {
    background: var(--bg-primary);
    border-bottom: 1px solid var(--border-color);
    padding: 0.75rem 2rem;
    position: sticky;
    top: 60px;
    z-index: 999;
    box-shadow: var(--shadow-sm);
}

.nav-links {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    justify-content: center;
}

.nav-links a {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    transition: all 0.2s ease;
}

.nav-links a:hover {
    color: var(--primary-color);
    background: var(--bg-tertiary);
}

/* Main Content */
.main-content {
    max-width: 1000px;
    margin: 2rem auto;
    padding: 2.5rem;
    background: var(--bg-primary);
    border-radius: 1rem;
    box-shadow: var(--shadow-md);
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary);
    font-weight: 700;
    line-height: 1.3;
    margin-top: 2rem;
    margin-bottom: 1rem;
}

h1 {
    font-size: 2.5rem;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    padding-bottom: 0.75rem;
    border-bottom: 3px solid var(--primary-color);
    margin-top: 0;
}

h2 {
    font-size: 1.875rem;
    color: var(--primary-dark);
    border-bottom: 2px solid var(--border-color);
    padding-bottom: 0.5rem;
}

h3 {
    font-size: 1.5rem;
    color: var(--text-primary);
}

h4 {
    font-size: 1.25rem;
    color: var(--text-secondary);
}

h5 {
    font-size: 1.125rem;
}

h6 {
    font-size: 1rem;
    color: var(--text-muted);
}

p {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

/* Links */
a {
    color: var(--primary-color);
    text-decoration: none;
    transition: color 0.2s ease;
}

a:hover {
    color: var(--primary-dark);
    text-decoration: underline;
}

/* Lists */
ul, ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
}

li {
    margin-bottom: 0.5rem;
}

li > ul, li > ol {
    margin-top: 0.5rem;
    margin-bottom: 0;
}

/* Code Blocks */
pre {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 1.25rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    line-height: 1.6;
    box-shadow: var(--shadow-md);
}

code {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    font-size: 0.875em;
}

:not(pre) > code {
    background: var(--bg-tertiary);
    color: var(--primary-dark);
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
}

/* Tables */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.9rem;
    box-shadow: var(--shadow-sm);
    border-radius: 0.5rem;
    overflow: hidden;
}

thead {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
}

th {
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
}

td {
    padding: 0.875rem 1rem;
    border-bottom: 1px solid var(--border-color);
}

tr:nth-child(even) {
    background: var(--bg-secondary);
}

tr:hover {
    background: var(--bg-tertiary);
}

/* Blockquotes */
blockquote {
    border-left: 4px solid var(--primary-color);
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    background: var(--bg-secondary);
    border-radius: 0 0.5rem 0.5rem 0;
    font-style: italic;
    color: var(--text-secondary);
}

blockquote p:last-child {
    margin-bottom: 0;
}

/* Mermaid Diagrams - Enhanced Styling */
.mermaid {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 2rem 0;
    padding: 1.5rem;
    background: linear-gradient(135deg, #fafbfc 0%, #f0f4f8 100%);
    border-radius: 0.75rem;
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-sm);
    overflow-x: auto;
    overflow-y: visible;
    min-height: 200px;
}

.mermaid svg {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 0 auto;
}

/* Ensure diagrams scale properly */
.mermaid[data-processed="true"] {
    min-height: auto;
}

/* Diagram container for better control */
.diagram-container {
    width: 100%;
    overflow-x: auto;
    padding: 1rem 0;
}

/* HR Styling */
hr {
    border: none;
    border-top: 2px solid var(--border-color);
    margin: 2.5rem 0;
}

/* Table of Contents */
.toc {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: 0.5rem;
    margin-bottom: 2rem;
    border: 1px solid var(--border-color);
}

.toc-title {
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 1rem;
    font-size: 1.125rem;
}

.toc ul {
    list-style: none;
    padding-left: 0;
}

.toc li {
    margin-bottom: 0.5rem;
}

.toc a {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.toc a:hover {
    color: var(--primary-color);
}

/* Document Info Box */
.doc-info {
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    font-size: 0.875rem;
}

.doc-info strong {
    color: var(--primary-color);
}

/* Footer */
.footer {
    text-align: center;
    padding: 2rem;
    background: var(--bg-tertiary);
    color: var(--text-muted);
    font-size: 0.875rem;
    margin-top: 2rem;
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-tertiary);
}

::-webkit-scrollbar-thumb {
    background: var(--text-muted);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* Print Styles */
@media print {
    .main-header, .documentation-nav, .footer {
        display: none !important;
    }

    .main-content {
        max-width: none;
        margin: 0;
        padding: 20px;
        box-shadow: none;
        border-radius: 0;
    }

    body {
        background: white;
        font-size: 11pt;
    }

    h1 {
        font-size: 24pt;
        -webkit-text-fill-color: var(--primary-dark);
        page-break-after: avoid;
    }

    h2, h3, h4 {
        page-break-after: avoid;
    }

    pre {
        background: #f5f5f5 !important;
        color: #333 !important;
        border: 1px solid #ddd;
        page-break-inside: avoid;
        font-size: 9pt;
    }

    table {
        page-break-inside: avoid;
    }

    .mermaid {
        page-break-inside: avoid;
        background: white !important;
        border: 1px solid #ddd;
        max-width: 100% !important;
    }

    .mermaid svg {
        max-width: 100% !important;
        max-height: 700px !important;
    }

    a {
        color: var(--primary-dark) !important;
        text-decoration: none !important;
    }
}

/* Responsive Design */
@media (max-width: 768px) {
    .main-content {
        margin: 1rem;
        padding: 1.5rem;
        border-radius: 0.5rem;
    }

    h1 {
        font-size: 1.75rem;
    }

    h2 {
        font-size: 1.5rem;
    }

    .nav-links {
        gap: 0.75rem;
    }

    .nav-links a {
        font-size: 0.75rem;
        padding: 0.375rem 0.5rem;
    }

    pre {
        font-size: 0.8rem;
        padding: 1rem;
    }

    table {
        font-size: 0.8rem;
    }

    th, td {
        padding: 0.5rem;
    }
}

/* Animation for smooth transitions */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.main-content {
    animation: fadeIn 0.3s ease-out;
}

/* Index-specific styles */
.hero {
    text-align: center;
    padding: 3rem 0;
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border-radius: 1rem;
    margin-bottom: 3rem;
}

.hero h1 {
    font-size: 3rem;
    margin-bottom: 1rem;
    border: none;
    padding: 0;
}

.hero p {
    font-size: 1.25rem;
    color: var(--text-secondary);
    max-width: 600px;
    margin: 0 auto;
}

.doc-sections {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
}

.doc-card {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 0.75rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-sm);
}

.doc-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary-light);
}

.doc-card h3 {
    color: var(--primary-color);
    font-size: 1.25rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
}

.doc-card p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.doc-card .links {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.doc-card .links a {
    font-size: 0.875rem;
    padding: 0.5rem 1rem;
    background: var(--bg-secondary);
    border-radius: 0.375rem;
    transition: all 0.2s ease;
}

.doc-card .links a:hover {
    background: var(--primary-color);
    color: white;
    text-decoration: none;
}

.section-title {
    font-size: 1.75rem;
    color: var(--primary-dark);
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--border-color);
}

    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="header-logo">Securaa<span>Docs</span></div>
            <div class="header-meta">
                <span>Generated: December 04, 2025</span>
            </div>
        </div>
    </header>

    <nav class="documentation-nav">
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="securaa-platform-high-level-design.html">Platform</a>
            <a href="securaa-playbook-high-level-design.html">Playbook</a>
            <a href="securaa-siem-high-level-design.html">SIEM</a>
            <a href="securaa-user-high-level-design.html">User Service</a>
            <a href="securaa-custom-services-high-level-design.html">Custom Services</a>
            <a href="sia-service-high-level-design.html">SIA Service</a>
            <a href="securaa-ris-high-level-design.html">RIS</a>
        </div>
    </nav>

    <main class="main-content">
        <h1 id="securaa-make-system-comprehensive-documentation">SECURAA Make System Comprehensive Documentation</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#system-flow-diagrams">System Flow Diagrams</a></li>
<li><a href="#core-repositories">Core Repositories</a></li>
<li><a href="#build-system-components">Build System Components</a></li>
<li><a href="#detailed-component-analysis">Detailed Component Analysis</a></li>
<li><a href="#common-makefile-patterns">Common Makefile Patterns</a></li>
<li><a href="#environment-configuration">Environment Configuration</a></li>
<li><a href="#build-targets-reference">Build Targets Reference</a></li>
<li><a href="#docker-integration">Docker Integration</a></li>
<li><a href="#package-management">Package Management</a></li>
<li><a href="#cicd-integration">CI/CD Integration</a></li>
<li><a href="#development-workflows">Development Workflows</a></li>
<li><a href="#performance-optimization">Performance Optimization</a></li>
<li><a href="#security-considerations">Security Considerations</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#advanced-configuration">Advanced Configuration</a></li>
</ol>
<h2 id="overview">Overview</h2>
<p>The SECURAA project employs a sophisticated multi-level Make system designed to manage the build, packaging, and deployment of a complex cybersecurity platform. This system orchestrates the compilation, testing, packaging, and deployment of over 200 microservices across multiple deployment environments.</p>
<h3 id="key-statistics">Key Statistics</h3>
<ul>
<li><strong>Total Services</strong>: 200+ microservices</li>
<li><strong>Integration Connectors</strong>: 150+ external system integrations</li>
<li><strong>Core Platform Services</strong>: 18 essential services</li>
<li><strong>Threat Intelligence Services</strong>: 19 specialized TIP services</li>
<li><strong>Batch Processing Services</strong>: 22+ data processing services</li>
<li><strong>Package Types</strong>: 6 different RPM package configurations</li>
<li><strong>Supported Environments</strong>: Development, Staging, Production, Cloud (AWS/Azure/GCP)</li>
<li><strong>Container Registries</strong>: Local, ECR, Custom registries</li>
<li><strong>Build Complexity</strong>: Multi-stage builds with dependency management</li>
</ul>
<h3 id="system-scope">System Scope</h3>
<p>The make system is organized into several distinct layers:</p>
<ul>
<li><strong>Library Layer</strong>: <code>securaa</code>, <code>securaa_lib</code>, <code>securaa_pylib</code>, and <code>securaa_ris_client</code> (Go libraries, Python libraries, and shared components)</li>
<li><strong>Database Layer</strong>: <code>securaa_db</code> (MongoDB configuration and schema)</li>
<li><strong>Core Services Layer</strong>: <code>zona_services</code>, <code>zona_batch</code>, <code>zona_tip_batch</code> (core runtime services)</li>
<li><strong>Integration Layer</strong>: <code>integrations</code> (external system connectors)</li>
<li><strong>Build/Packaging Layer</strong>: <code>build_securaa</code>, <code>build_tip_securaa</code> (RPM packaging and deployment)</li>
<li><strong>Configuration Layer</strong>: Environment-specific configurations and deployment scripts</li>
</ul>
<h3 id="business-value">Business Value</h3>
<ul>
<li><strong>Scalability</strong>: Supports massive horizontal scaling with microservices architecture</li>
<li><strong>Maintainability</strong>: Standardized build patterns across all components</li>
<li><strong>Reliability</strong>: Consistent packaging and deployment processes</li>
<li><strong>Security</strong>: Multi-layered security with containerization and access controls</li>
<li><strong>Efficiency</strong>: Parallel builds and optimized dependency management</li>
</ul>
<h2 id="architecture">Architecture</h2>
<h3 id="high-level-system-architecture">High-Level System Architecture</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                           SECURAA PLATFORM ARCHITECTURE                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │   Client Layer  │    │   API Gateway   │    │  Load Balancer  │          │
│  │                 │    │                 │    │                 │          │
│  │ • Web UI        │◄──►│ • Authentication│◄──►│ • HAProxy       │          │
│  │ • API Clients   │    │ • Rate Limiting │    │ • Nginx         │          │
│  │                 │    │ • Routing       │    │ • Health Checks │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        CORE SERVICES LAYER                             │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┤ │
│  │  │                     zona_services (18 services)                    │ │
│  │  │                                                                     │ │
│  │  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐     │ │
│  │  │ │ zona_siem   │ │zona_playbook│ │zona_manager │ │ zona_user   │     │ │
│  │  │ │             │ │             │ │             │ │             │     │ │
│  │  │ │• Event Proc │ │• Automation │ │• Orchestrat │ │• Identity   │     │ │
│  │  │ │• Correlation│ │• Workflows  │ │• Service Mgmt│ │• Access Ctrl│     │ │
│  │  │ │• Analytics  │ │• Response   │ │• Health Mon │ │• User Mgmt  │     │ │
│  │  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘     │ │
│  │  │                                                                     │ │
│  │  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐     │ │
│  │  │ │zona_queryb. │ │zona_ris_srv │ │zona_custom  │ │zona_release │     │ │
│  │  │ │             │ │             │ │             │ │             │     │ │
│  │  │ │• Query Build│ │• Risk Intel │ │• Custom Logic│ │• Release Mgmt│     │ │
│  │  │ │• SQL Gener. │ │• Scoring    │ │• Extensions │ │• Versioning │     │ │
│  │  │ │• Validation │ │• Assessment │ │• Plugins    │ │• Deployment │     │ │
│  │  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘     │ │
│  │  └─────────────────────────────────────────────────────────────────────┤ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                    PROCESSING &amp; INTELLIGENCE LAYER                     │ │
│  │                                                                         │ │
│  │ ┌─────────────────────────┐    ┌─────────────────────────────────────┐   │ │
│  │ │    zona_batch (4)       │    │       zona_tip_batch (19)           │   │ │
│  │ │                         │    │                                     │   │ │
│  │ │ • Data Ingestion        │    │ • Threat Intelligence Feeds        │   │ │
│  │ │ • Batch Processing      │◄──►│ • IOC Processing                   │   │ │
│  │ │ • Case Management       │    │ • Feed Normalization               │   │ │
│  │ │ • Health Monitoring     │    │ • TAXII Server/Client              │   │ │
│  │ │                         │    │ • Threat Enrichment                │   │ │
│  │ └─────────────────────────┘    └─────────────────────────────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                       INTEGRATION LAYER                                │ │
│  │                                                                         │ │
│  │                    integrations (150+ connectors)                      │ │
│  │                                                                         │ │
│  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │ │
│  │ │   SIEM      │ │   Cloud     │ │  Security   │ │   Threat    │        │ │
│  │ │             │ │             │ │   Tools     │ │ Intelligence│        │ │
│  │ │ • Splunk    │ │ • AWS       │ │ • CrowdStrk │ │ • VirusTotal│        │ │
│  │ │ • QRadar    │ │ • Azure     │ │ • Sentinel1 │ │ • RecordFut │        │ │
│  │ │ • ArcSight  │ │ • GCP       │ │ • PaloAlto  │ │ • ThreatCon │        │ │
│  │ │ • Elastic   │ │ • Swarm     │ │ • Fortinet  │ │ • MISP      │        │ │
│  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘        │ │
│  │                                                                         │ │
│  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │ │
│  │ │   Comms     │ │  Identity   │ │  Ticketing  │ │   Others    │        │ │
│  │ │             │ │             │ │             │ │             │        │ │
│  │ │ • Slack     │ │ • ActiveDir │ │ • Jira      │ │ • 50+ more  │        │ │
│  │ │ • MSTeams   │ │ • LDAP      │ │ • ServiceNow│ │ • Custom    │        │ │
│  │ │ • Email     │ │ • Okta      │ │ • Confluence│ │ • APIs      │        │ │
│  │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘        │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                         DATA &amp; STORAGE LAYER                           │ │
│  │                                                                         │ │
│  │ ┌─────────────────────────┐    ┌─────────────────────────────────────┐   │ │
│  │ │     securaa_db          │    │        Libraries &amp; Utils           │   │ │
│  │ │                         │    │                                     │   │ │
│  │ │ • MongoDB Sharding      │    │ ┌─────────────┐ ┌─────────────┐     │   │ │
│  │ │ • Replica Sets          │◄──►│ │  securaa    │ │ securaa_lib │     │   │ │
│  │ │ • Data Models           │    │ │             │ │             │     │   │ │
│  │ │ • Indexing Strategy     │    │ │• Core Logic │ │• Utilities  │     │   │ │
│  │ │ • Backup/Restore        │    │ │• API Layers │ │• Common Func│     │   │ │
│  │ │                         │    │ │• Business   │ │• Shared Comp│     │   │ │
│  │ └─────────────────────────┘    │ │  Rules      │ │• Config Mgmt│     │   │ │
│  │                                │ └─────────────┘ └─────────────┘     │   │ │
│  │                                └─────────────────────────────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="build-system-architecture">Build System Architecture</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                         BUILD &amp; DEPLOYMENT ARCHITECTURE                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │ Developer       │    │   Build System  │    │   Deployment    │          │
│  │ Workstation     │    │                 │    │   Environment   │          │
│  │                 │    │                 │    │                 │          │
│  │ ┌─────────────┐ │    │ ┌─────────────┐ │    │ ┌─────────────┐ │          │
│  │ │ Code Change │ │    │ │   Make      │ │    │ │   Target    │ │          │
│  │ │             │─┼───►│ │ Orchestrator│─┼───►│ │ Environment │ │          │
│  │ │ • Git Commit│ │    │ │             │ │    │ │             │ │          │
│  │ │ • Branch    │ │    │ │ ┌─────────┐ │ │    │ │ • Dev       │ │          │
│  │ │ • PR/MR     │ │    │ │ │Top-Level│ │ │    │ │ • Staging   │ │          │
│  │ └─────────────┘ │    │ │ │Makefile │ │ │    │ │ • Production│ │          │
│  └─────────────────┘    │ │ └─────────┘ │ │    │ └─────────────┘ │          │
│                         │ │      │      │ │    └─────────────────┘          │
│                         │ │      ▼      │ │                                 │
│                         │ │ ┌─────────┐ │ │                                 │
│                         │ │ │Component│ │ │                                 │
│                         │ │ │Makefiles│ │ │                                 │
│                         │ │ └─────────┘ │ │                                 │
│                         │ │      │      │ │                                 │
│                         │ │      ▼      │ │                                 │
│                         │ │ ┌─────────┐ │ │                                 │
│                         │ │ │Service  │ │ │                                 │
│                         │ │ │Makefiles│ │ │                                 │
│                         │ │ └─────────┘ │ │                                 │
│                         │ └─────────────┘ │                                 │
│                         └─────────────────┘                                 │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           BUILD PIPELINE FLOW                          │ │
│  │                                                                         │ │
│  │  Source Code                                                            │ │
│  │      │                                                                  │ │
│  │      ▼                                                                  │ │
│  │  ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐          │ │
│  │  │ Vendor  │────►│  Build  │────►│  Test   │────►│Package  │          │ │
│  │  │ Deps    │     │ Binary  │     │ &amp; Vet   │     │ (RPM)   │          │ │
│  │  └─────────┘     └─────────┘     └─────────┘     └─────────┘          │ │
│  │      │               │               │               │                 │ │
│  │      ▼               ▼               ▼               ▼                 │ │
│  │  ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐          │ │
│  │  │go mod   │     │CGO=0    │     │golangci-│     │rpmbuild │          │ │
│  │  │vendor   │     │go build │     │lint     │     │spec     │          │ │
│  │  └─────────┘     └─────────┘     └─────────┘     └─────────┘          │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────┐    │ │
│  │  │                    DOCKER BUILD FLOW                           │    │ │
│  │  │                                                                 │    │ │
│  │  │  Source ──► Builder Image ──► Binary ──► Runtime Image ──► Push │    │ │
│  │  │     │           │               │           │             │     │    │ │
│  │  │     ▼           ▼               ▼           ▼             ▼     │    │ │
│  │  │  Dockerfile   golang:alpine   /app/bin   alpine:latest   ECR   │    │ │
│  │  │  Multi-stage  Build Stage     Artifact   Runtime Stage  Registry    │ │
│  │  └─────────────────────────────────────────────────────────────────┘    │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="dependency-flow">Dependency Flow</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                            DEPENDENCY FLOW DIAGRAM                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                          FOUNDATION LAYER                              │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────┐    ┌─────────────────────────────────────┐ │ │
│  │  │      securaa_lib        │    │          securaa                   │ │ │
│  │  │                         │    │                                     │ │ │
│  │  │ • Common utilities      │    │ • Core business logic              │ │ │
│  │  │ • Shared data models    │◄──►│ • Integration frameworks           │ │ │
│  │  │ • Configuration mgmt    │    │ • API definitions                  │ │ │
│  │  │ • Encryption/crypto     │    │ • Authentication &amp; authorization   │ │ │
│  │  │ • Logging frameworks    │    │ • Data validation &amp; processing     │ │ │
│  │  │ • Database connectors   │    │ • Event handling &amp; messaging      │ │ │
│  │  └─────────────────────────┘    └─────────────────────────────────────┘ │ │
│  └──────────────────────────────────▲──────────────────────────────────────┘ │
│                                     │                                       │
│                                     │ (imports &amp; dependencies)              │
│                                     │                                       │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                            SERVICE LAYER                               │ │
│  │                                                                         │ │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │ │
│  │  │  zona_services  │  │   zona_batch    │  │ zona_tip_batch  │        │ │
│  │  │                 │  │                 │  │                 │        │ │
│  │  │ All 18 services │  │ All 4 services  │  │ All 19 services │        │ │
│  │  │ depend on:      │  │ depend on:      │  │ depend on:      │        │ │
│  │  │ • securaa       │  │ • securaa       │  │ • securaa       │        │ │
│  │  │ • securaa_lib   │  │ • securaa_lib   │  │ • securaa_lib   │        │ │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘        │ │
│  │          │                      │                      │               │ │
│  │          └──────────────────────┼──────────────────────┘               │ │
│  │                                 │                                      │ │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │ │
│  │  │                     integrations                                │   │ │
│  │  │                                                                 │   │ │
│  │  │ All 150+ integration services depend on:                       │   │ │
│  │  │ • securaa (core integration framework)                         │   │ │
│  │  │ • securaa_lib (common utilities)                               │   │ │
│  │  │ • External APIs &amp; SDKs                                         │   │ │
│  │  └─────────────────────────────────────────────────────────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                     │                                       │
│                                     │ (compiled binaries)                   │
│                                     ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                          PACKAGING LAYER                               │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────┐    ┌─────────────────────────────────────┐ │ │
│  │  │    build_securaa        │    │      build_tip_securaa              │ │ │
│  │  │                         │    │                                     │ │ │
│  │  │ • Collects binaries     │    │ • Collects TIP binaries             │ │ │
│  │  │ • Creates RPM packages  │◄──►│ • Creates specialized packages      │ │ │
│  │  │ • Manages configurations│    │ • TIP-specific configurations       │ │ │
│  │  │ • Deployment scripts    │    │ • Threat intel deployment          │ │ │
│  │  └─────────────────────────┘    └─────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="data-flow-architecture">Data Flow Architecture</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                              DATA FLOW DIAGRAM                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  External Sources                    SECURAA Platform                       │
│                                                                             │
│  ┌─────────────┐                    ┌─────────────────────────────────────┐ │
│  │   SIEM      │                    │              Ingestion              │ │
│  │ • Splunk    │───────────────────►│                                     │ │
│  │ • QRadar    │                    │ ┌─────────────┐ ┌─────────────┐     │ │
│  │ • ArcSight  │◄───────────────────┤ │integrations │ │zona_batch   │     │ │
│  │ • Elastic   │                    │ │ (150+ svcs) │ │ (4 services)│     │ │
│  └─────────────┘                    │ │             │ │             │     │ │
│                                     │ │• Data Trans │ │• Batch Proc │     │ │
│  ┌─────────────┐                    │ │• Validation │ │• Enrichment │     │ │
│  │  Threat     │                    │ │• Normaliz.  │ │• Aggregation│     │ │
│  │ Intelligence│───────────────────►│ └─────────────┘ └─────────────┘     │ │
│  │ • VirusTotal│                    │        │               │            │ │
│  │ • RecordFut │◄───────────────────┤        ▼               ▼            │ │
│  │ • ThreatCon │                    │ ┌─────────────┐ ┌─────────────┐     │ │
│  │ • MISP      │                    │ │zona_tip_    │ │   Message   │     │ │
│  └─────────────┘                    │ │batch        │ │   Queue     │     │ │
│                                     │ │(19 services)│ │ • Kafka     │     │ │
│  ┌─────────────┐                    │ │             │ │ • RabbitMQ  │     │ │
│  │   Cloud     │                    │ │• Feed Proc  │ │ • Redis     │     │ │
│  │ • AWS       │───────────────────►│ │• IOC Extract│ │             │     │ │
│  │ • Azure     │                    │ │• TI Enrich  │ └─────────────┘     │ │
│  │ • GCP       │◄───────────────────┤ │• TAXII      │        │            │ │
│  │ • Swarm     │                    │ └─────────────┘        ▼            │ │
│  └─────────────┘                    │        │        ┌─────────────┐     │ │
│                                     │        ▼        │    Core     │     │ │
│  ┌─────────────┐                    │ ┌─────────────┐ │  Processing │     │ │
│  │   Tickets   │                    │ │  Data Lake  │ │             │     │ │
│  │ • Jira      │───────────────────►│ │             │ │zona_services│     │ │
│  │ • ServiceNow│                    │ │ • Raw Data  │ │(18 services)│     │ │
│  │ • Confluence│◄───────────────────┤ │ • Processed │ │             │     │ │
│  │ • ITSM      │                    │ │ • Enriched  │ │• Analytics  │     │ │
│  └─────────────┘                    │ │ • Archived  │ │• Correlation│     │ │
│                                     │ └─────────────┘ │• Response   │     │ │
│                                     │        │        │• Reporting  │     │ │
│                                     │        ▼        └─────────────┘     │ │
│                                     │ ┌─────────────┐        │            │ │
│                                     │ │ securaa_db  │        ▼            │ │
│                                     │ │             │ ┌─────────────┐     │ │
│                                     │ │• MongoDB    │ │   Output    │     │ │
│                                     │ │• Sharding   │ │             │     │ │
│                                     │ │• Replication│ │• Dashboards │     │ │
│                                     │ │• Indexing   │ │• Reports    │     │ │
│                                     │ │• Backup     │ │• Alerts     │     │ │
│                                     │ └─────────────┘ │• API Resp   │     │ │
│                                     └─────────────────│• Actions    │─────┘ │
│                                                       └─────────────┘       │
│                                                              │               │
│                                                              ▼               │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                          OUTPUT INTERFACES                             │ │
│  │                                                                         │ │
│  │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐                        │ │
│  │ │  Web UI     │ │    API      │ │ Notifications│                        │ │
│  │ │             │ │  Endpoints  │ │             │                        │ │
│  │ │• Dashboards │ │• REST       │ │• Email      │                        │ │
│  │ │• Reports    │ │• GraphQL    │ │• SMS        │                        │ │
│  │ │• Analytics  │ │• Webhooks   │ │• Slack      │                        │ │
│  │ │• Admin      │ │• SSE        │ │• MSTeams    │                        │ │
│  │ └─────────────┘ └─────────────┘ └─────────────┘                        │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h2 id="system-flow-diagrams">System Flow Diagrams</h2>
<h3 id="build-process-flow">Build Process Flow</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                              BUILD PROCESS FLOW                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Developer Action                     Make System Response                   │
│                                                                             │
│  ┌─────────────┐                     ┌─────────────────────────────────────┐ │
│  │   make all  │────────────────────►│        Top-Level Makefile          │ │
│  └─────────────┘                     │                                     │ │
│                                      │ ┌─────────────────────────────────┐ │ │
│                                      │ │   for DIR in $(TARGETS); do    │ │ │
│                                      │ │     $(MAKE) vendor --dir=$$DIR  │ │ │
│                                      │ │     $(MAKE) build --dir=$$DIR   │ │ │
│                                      │ │   done                          │ │ │
│                                      │ └─────────────────────────────────┘ │ │
│                                      └─────────────────────────────────────┘ │
│                                                       │                     │
│                                                       ▼                     │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                          PER-SERVICE BUILD PROCESS                     │ │
│  │                                                                         │ │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │ │
│  │  │ 1. vendor   │───►│ 2. builddir │───►│ 3. compile  │───►│ 4. output   │ │ │
│  │  │             │    │             │    │             │    │             │ │ │
│  │  │• go mod     │    │• mkdir -p   │    │• CGO_ENABLED│    │• Binary to  │ │ │
│  │  │  vendor     │    │  build/     │    │  =0         │    │  build/     │ │ │
│  │  │• Download   │    │• Create     │    │• go build   │    │• Executable │ │ │
│  │  │  deps       │    │  output dir │    │  -mod vendor│    │  ready      │ │ │
│  │  │• Vendor     │    │• Ensure     │    │• Link flags │    │• Version    │ │ │
│  │  │  modules    │    │  perms      │    │• Build tags │    │  embedded   │ │ │
│  │  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                      DEPENDENCY RESOLUTION                         │ │ │
│  │  │                                                                     │ │ │
│  │  │  go.mod ──► go mod vendor ──► vendor/ ──► go build -mod vendor      │ │ │
│  │  │     │                            │                    │             │ │ │
│  │  │     ▼                            ▼                    ▼             │ │ │
│  │  │  Dependencies               Local Cache          Final Binary       │ │ │
│  │  │  • securaa                  • All deps           • Static linked    │ │ │
│  │  │  • securaa_lib              • No network         • Self-contained   │ │ │
│  │  │  • External libs            • Reproducible       • Deployment ready │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           PARALLEL BUILD FLOW                          │ │
│  │                                                                         │ │
│  │               ┌─── zona_service1 ─── build/zona_service1                │ │
│  │               │                                                         │ │
│  │  make all ────┼─── zona_service2 ─── build/zona_service2                │ │
│  │               │                                                         │ │
│  │               ├─── zona_service3 ─── build/zona_service3                │ │
│  │               │                                                         │ │
│  │               └─── zona_serviceN ─── build/zona_serviceN                │ │
│  │                                                                         │ │
│  │  Each service builds independently and in parallel (with -j flag)      │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="docker-build-flow">Docker Build Flow</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                            DOCKER BUILD FLOW                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐                                                            │
│  │make image_ecr│                                                           │
│  └─────┬───────┘                                                            │
│        │                                                                    │
│        ▼                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        MULTI-STAGE DOCKER BUILD                        │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                          STAGE 1: BUILDER                          │ │ │
│  │  │                                                                     │ │ │
│  │  │  FROM golang:1.20-alpine AS builder                                │ │ │
│  │  │  │                                                                 │ │ │
│  │  │  ├─ WORKDIR /app                                                   │ │ │
│  │  │  ├─ COPY go.mod go.sum ./                                          │ │ │
│  │  │  ├─ RUN go mod download                                            │ │ │
│  │  │  ├─ COPY . .                                                       │ │ │
│  │  │  ├─ RUN CGO_ENABLED=0 GOOS=linux go build -mod vendor \           │ │ │
│  │  │  │   -ldflags &quot;-X main.GitRef=$(GIT_REF) \                        │ │ │
│  │  │  │            -X main.Version=$(BUILD_VERSION)&quot; \                 │ │ │
│  │  │  │   -o /app/$(TARGET)                                             │ │ │
│  │  │  └─ RESULT: Static binary ready for next stage                    │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                     │                                   │ │
│  │                                     ▼                                   │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                          STAGE 2: RUNTIME                          │ │ │
│  │  │                                                                     │ │ │
│  │  │  FROM alpine:3.18                                                  │ │ │
│  │  │  │                                                                 │ │ │
│  │  │  ├─ RUN apk --no-cache add ca-certificates                         │ │ │
│  │  │  ├─ WORKDIR /root/                                                 │ │ │
│  │  │  ├─ COPY --from=builder /app/$(TARGET) .                           │ │ │
│  │  │  ├─ COPY --from=builder /app/config/ ./config/                     │ │ │
│  │  │  ├─ EXPOSE 8080                                                    │ │ │
│  │  │  ├─ USER nobody                                                     │ │ │
│  │  │  └─ CMD [&quot;./$(TARGET)&quot;]                                             │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                     │                                       │
│                                     ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           IMAGE TAGGING &amp; PUSH                         │ │
│  │                                                                         │ │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │ │
│  │  │   Build     │───►│   Tag       │───►│   Push      │───►│  Registry   │ │ │
│  │  │             │    │             │    │             │    │             │ │ │
│  │  │• Create     │    │• latest     │    │• docker     │    │• ECR        │ │ │
│  │  │  image      │    │• branch     │    │  push       │    │• Local      │ │ │
│  │  │• Size opt   │    │• version    │    │• Registry   │    │• Custom     │ │ │
│  │  │• Security   │    │• sha        │    │  auth       │    │• Harbor     │ │ │
│  │  │  scanning   │    │• env tag    │    │• Retry      │    │• Quay       │ │ │
│  │  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        BUILD OPTIMIZATION                              │ │
│  │                                                                         │ │
│  │  • BuildKit enabled (DOCKER_BUILDKIT=1)                                │ │
│  │  • Layer caching for dependencies                                      │ │
│  │  • Multi-platform builds (linux/amd64, linux/arm64)                   │ │
│  │  • Parallel layer downloads                                            │ │
│  │  • Build context optimization (.dockerignore)                         │ │
│  │  • Minimal runtime image (alpine:3.18)                                │ │
│  │  • Non-root user execution                                             │ │
│  │  • Health checks and labels                                            │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="package-creation-flow">Package Creation Flow</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                          RPM PACKAGE CREATION FLOW                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐                                                            │
│  │  make rpm   │                                                            │
│  └─────┬───────┘                                                            │
│        │                                                                    │
│        ▼                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           PREPARATION PHASE                            │ │
│  │                                                                         │ │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │ │
│  │  │   Clean     │───►│ Copy Files  │───►│   Create    │───►│  Setup RPM  │ │ │
│  │  │   Previous  │    │             │    │  Directory  │    │  Build Env  │ │ │
│  │  │             │    │• Binaries   │    │  Structure  │    │             │ │ │
│  │  │• rm -rf tmp │    │• Config     │    │             │    │• ~/rpmbuild │ │ │
│  │  │• rm *.rpm   │    │• Scripts    │    │• tmp/ -&gt;    │    │• SOURCES/   │ │ │
│  │  │• rm *.tar.gz│    │• SSL certs  │    │  pkg-ver/   │    │• SPECS/     │ │ │
│  │  │• Clean logs │    │• DB schema  │    │• Rename     │    │• BUILD/     │ │ │
│  │  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                     │                                       │
│                                     ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                            PACKAGING PHASE                             │ │
│  │                                                                         │ │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │ │
│  │  │   Create    │───►│   Build     │───►│   Test      │───►│   Output    │ │ │
│  │  │   Tarball   │    │   RPM       │    │   Package   │    │   Final     │ │ │
│  │  │             │    │             │    │             │    │   RPM       │ │ │
│  │  │• tar -czf   │    │• rpmbuild   │    │• rpm -qpl   │    │• Copy to    │ │ │
│  │  │  pkg.tar.gz │    │  -bb        │    │• File list  │    │  ./rpms/    │ │ │
│  │  │• Include    │    │• Use spec   │    │• Dependency│    │• Sign       │ │ │
│  │  │  all files  │    │  file       │    │  check      │    │  package    │ │ │
│  │  │• Version    │    │• Build deps │    │• Install    │    │• Metadata   │ │ │
│  │  │  in name    │    │• Install    │    │  test       │    │  validation │ │ │
│  │  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                       PACKAGE TYPES &amp; COMPONENTS                       │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                    securaa_mssp_complete                           │ │ │
│  │  │                                                                     │ │ │
│  │  │  • All core services binaries                                      │ │ │
│  │  │  • All configuration files                                         │ │ │
│  │  │  • Database initialization scripts                                 │ │ │
│  │  │  • SSL certificates                                                │ │ │
│  │  │  • Installation scripts                                            │ │ │
│  │  │  • zona.zip (web UI assets)                                        │ │ │
│  │  │  • Service definition files                                        │ │ │
│  │  │  • Log rotation configuration                                      │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                  securaa_mssp_core_services_ui                     │ │ │
│  │  │                                                                     │ │ │
│  │  │  • Core service binaries only                                      │ │ │
│  │  │  • UI components and assets                                        │ │ │
│  │  │  • Essential configuration                                         │ │ │
│  │  │  • SSL certificates                                                │ │ │
│  │  │  • Minimal installation footprint                                 │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                    securaa_mssp_core_db                            │ │ │
│  │  │                                                                     │ │ │
│  │  │  • Database service binary                                         │ │ │
│  │  │  • MongoDB initialization scripts                                  │ │ │
│  │  │  • Sharding configuration                                          │ │ │
│  │  │  • Replica set configuration                                       │ │ │
│  │  │  • Index definitions                                               │ │ │
│  │  │  • Backup/restore utilities                                        │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                     securaa_mssp_ml                                │ │ │
│  │  │                                                                     │ │ │
│  │  │  • Machine learning service binary                                 │ │ │
│  │  │  • AI model files                                                  │ │ │
│  │  │  • Training data sets                                              │ │ │
│  │  │  • ML-specific configuration                                       │ │ │
│  │  │  • Python dependencies                                             │ │ │
│  │  │  • GPU driver compatibility                                        │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                    securaa_arbiter                                 │ │ │
│  │  │                                                                     │ │ │
│  │  │  • MongoDB arbiter configuration                                   │ │ │
│  │  │  • Cluster management scripts                                      │ │ │
│  │  │  • ECR login utilities                                             │ │ │
│  │  │  • Installation automation                                         │ │ │
│  │  │  • Minimal footprint                                               │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                   securaa_worker_node                              │ │ │
│  │  │                                                                     │ │ │
│  │  │  • Worker node services                                            │ │ │
│  │  │  • Node manager binary                                             │ │ │
│  │  │  • Distributed processing utilities                                │ │ │
│  │  │  • Load balancing configuration                                    │ │ │
│  │  │  • Auto-scaling scripts                                            │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h2 id="core-repositories">Core Repositories</h2>
<h3 id="component-distribution-overview">Component Distribution Overview</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                         COMPONENT DISTRIBUTION MATRIX                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Repository          │ Services │ Purpose                │ Build Output     │
│  ────────────────────┼──────────┼────────────────────────┼─────────────────┤
│  zona_services       │    18    │ Core platform services│ zona_services/   │
│  zona_batch          │     4    │ Batch processing       │ zona_batch/      │
│  zona_tip_batch      │    19    │ Threat intelligence    │ zona_tip_batch/  │
│  zonareact           │     1    │ React frontend UI      │ zonareact/       │
│  securaa             │     -    │ Core library           │ Go module        │
│  securaa_lib         │     -    │ Utility library        │ Go module        │
│  securaa_csam        │     -    │ CSAM services          │ securaa_csam/    │
│  securaa_db          │     -    │ Database schemas       │ MongoDB scripts  │
│  securaa_pylib       │     -    │ Python libraries       │ Python modules   │
│  securaa_ris_client  │     -    │ RIS client library     │ Go module        │
│  build_securaa       │     -    │ RPM packaging          │ .rpm files       │
│  build_tip_securaa   │     -    │ TIP packaging          │ .rpm files       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="service-interaction-map">Service Interaction Map</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                           SERVICE INTERACTION MAP                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                           ┌─────────────────┐                               │
│                           │   zona_user     │                               │
│                           │  (Auth &amp; IAM)   │                               │
│                           └─────────┬───────┘                               │
│                                     │                                       │
│                    ┌────────────────┼────────────────┐                      │
│                    │                │                │                      │
│            ┌───────▼────────┐ ┌─────▼─────┐ ┌────────▼──────┐               │
│            │  zona_manager  │ │zona_apis_ │ │ zona_playbook │               │
│            │ (Orchestrator) │ │ manager   │ │ (Automation)  │               │
│            └───────┬────────┘ └─────┬─────┘ └────────┬──────┘               │
│                    │                │                │                      │
│  ┌─────────────────┼────────────────┼────────────────┼─────────────────┐    │
│  │                 │                │                │                 │    │
│  ▼                 ▼                ▼                ▼                 ▼    │
│ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐          │
│ │zona_siem │ │zona_query│ │zona_ris_ │ │zona_     │ │zonareact │          │
│ │          │ │ builder  │ │ server   │ │ custom   │ │ (Web UI) │          │
│ │• Events  │ │          │ │          │ │          │ │          │          │
│ │• Alerts  │ │• SQL Gen │ │• Risk    │ │• Plugins │ │• React   │          │
│ │• Correla │ │• Query   │ │• Scoring │ │• Custom  │ │• Frontend│          │
│ │  tion    │ │  Optim   │ │• Assess  │ │  Logic   │ │• UI/UX   │          │
│ └────┬─────┘ └─────┬────┘ └─────┬────┘ └─────┬────┘ └─────┬────┘          │
│      │             │            │            │            │               │
│      └─────────────┼────────────┼────────────┼────────────┘               │
│                    │            │            │                            │
│                    ▼            ▼            ▼                            │
│              ┌─────────────────────────────────────┐                       │
│              │         Message Queue               │                       │
│              │       (Kafka/RabbitMQ)             │                       │
│              └─────────────────────────────────────┘                       │
│                                    │                                       │
│                                    ▼                                       │
│              ┌─────────────────────────────────────┐                       │
│              │         securaa_db                  │                       │
│              │       (MongoDB Cluster)            │                       │
│              └─────────────────────────────────────┘                       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="repository-structure-and-recursive-makefiles">Repository Structure and Recursive Makefiles</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                        RECURSIVE MAKEFILE STRUCTURE                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Root Repository Structure:                                                 │
│                                                                             │
│  ├── zona_batch/                   ← Main repository with recursive builds  │
│  │   ├── Makefile                  ← Top-level aggregation makefile        │
│  │   ├── csam_connector/           ← Individual service                     │
│  │   │   └── Makefile              ← Service-specific build rules          │
│  │   ├── zona_case_consumer/                                               │
│  │   │   └── Makefile                                                      │
│  │   └── zona_batch_manager/                                               │
│  │       └── Makefile                                                      │
│  │                                                                         │
│  ├── zonareact/                    ← React frontend                        │
│  │   ├── Makefile                  ← Frontend build rules                  │
│  │   ├── package.json              ← NPM dependencies                      │
│  │   └── src/                      ← React source code                     │
│  │                                                                         │
│  ├── zona_services/                ← Core services repository              │
│  │   ├── Makefile                  ← Aggregates 18 services                │
│  │   ├── zona_siem/                                                        │
│  │   │   └── Makefile              ← SIEM service build                    │
│  │   ├── zona_playbook/                                                    │
│  │   │   └── Makefile              ← Playbook service build                │
│  │   └── ... (16 more services)                                            │
│  │                                                                         │
│  ├── zona_tip_batch/               ← Threat Intelligence Processing        │
│  │   ├── Makefile                  ← Aggregates 19 TIP services            │
│  │   ├── tip_services/                                                     │
│  │   │   └── Makefile              ← Core TIP service                      │
│  │   ├── zona_taxii_server/                                                │
│  │   │   └── Makefile              ← TAXII protocol server                 │
│  │   └── ... (17 more services)                                            │
│  │                                                                         │
│  ├── securaa/                      ← Core business logic library           │
│  │   ├── go.mod                    ← Go module definition                  │
│  │   └── *.go                      ← Go source files (no Makefile)         │
│  │                                                                         │
│  ├── securaa_csam/                 ← Content Safety &amp; Moderation           │
│  │   ├── Makefile                  ← CSAM service builds                   │
│  │   ├── services/                                                         │
│  │   │   └── Makefile              ← CSAM core services                    │
│  │   └── csam_manager/                                                     │
│  │       └── Makefile              ← CSAM management service               │
│  │                                                                         │
│  ├── securaa_db/                   ← Database configurations               │
│  │   ├── mssp_core/                ← Core database schemas                 │
│  │   ├── mssp_tenant/              ← Tenant-specific schemas               │
│  │   └── onpremises/               ← On-premise configurations             │
│  │                                                                         │
│  ├── securaa_lib/                  ← Shared utility libraries              │
│  │   ├── go.mod                    ← Go module definition                  │
│  │   └── */                        ← Various utility packages              │
│  │                                                                         │
│  ├── securaa_pylib/                ← Python libraries                      │
│  │   ├── setup.py                  ← Python package setup                 │
│  │   └── securaa_pylib/            ← Python source code                    │
│  │                                                                         │
│  ├── securaa_ris_client/           ← RIS client library                    │
│  │   ├── go.mod                    ← Go module definition                  │
│  │   └── *.go                      ← RIS client implementation             │
│  │                                                                         │
│  ├── build_securaa/                ← Main platform packaging               │
│  │   ├── pkg/                                                              │
│  │   │   └── Makefile              ← RPM package creation                  │
│  │   ├── securaa/                                                          │
│  │   │   └── Makefile              ← Core service packaging                │
│  │   └── upgrade/                                                          │
│  │       └── Makefile              ← Upgrade package creation              │
│  │                                                                         │
│  └── build_tip_securaa/            ← TIP-specific packaging                │
│      ├── pkg/                                                              │
│      │   └── Makefile              ← TIP RPM packages                      │
│      └── securaa/                                                          │
│          └── Makefile              ← TIP service packaging                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<p><strong>Purpose</strong>: Core platform services including SIEM, user management, playbooks, and APIs.</p>
<p><strong>Main Makefile</strong>: <code>zona_services/Makefile</code></p>
<p><strong>Services</strong> (18 total):
- <code>zona_siem</code> - Security Information and Event Management
- <code>zona_playbook</code> - Automated response playbooks
- <code>zona_querybuilder</code> - Query construction service
- <code>zona_ris_server</code> - Risk Intelligence Service
- <code>zona_manager</code> - Service orchestration
- <code>zona_custom</code> - Custom logic handlers
- <code>zona_release</code> - Release management
- <code>zona_user</code> - User management
- <code>zona_integrations</code> - Integration management
- <code>securaa_backup</code> - Backup services
- <code>securaa_restore</code> - Restore services
- <code>zona_custom_utils</code> - Utility services
- <code>zona_process_manager</code> - Process management
- <code>zona_apis_manager</code> - API management
- <code>zona_sshclient</code> - SSH client service
- <code>zona_primary_server_health_check</code> - Health monitoring
- <code>zona_shard_handler</code> - Database sharding</p>
<h3 id="2-zona_batch">2. zona_batch</h3>
<p><strong>Purpose</strong>: Batch processing services for data ingestion and processing.</p>
<p><strong>Main Makefile</strong>: <code>zona_batch/Makefile</code></p>
<p><strong>Services</strong> (4 main):
- <code>zona_primary_server_health_check</code> - Health monitoring batch
- <code>csam_connector</code> - CSAM (Content Safety and Moderation) connector
- <code>zona_case_consumer</code> - Case processing consumer
- <code>zona_batch_manager</code> - Batch operation orchestration</p>
<h3 id="3-zona_tip_batch">3. zona_tip_batch</h3>
<p><strong>Purpose</strong>: Threat Intelligence Platform batch processing services.</p>
<p><strong>Main Makefile</strong>: <code>zona_tip_batch/Makefile</code></p>
<p><strong>Services</strong> (19 total):
- <code>tip_batch_botscout</code> - BotScout threat feed
- <code>tip_deletion_batch</code> - Data cleanup
- <code>tip_services</code> - Core TIP services
- <code>zona_taxii_server</code> - TAXII protocol server
- <code>tip_enhancer</code> - Data enrichment
- <code>taxii_client_tc</code> - ThreatConnect TAXII client
- <code>tip_batch_abuse.ch</code> - Abuse.ch feed processing
- <code>tip_batch_bambenek</code> - Bambenek feed processing
- <code>tip_batch_blocklist.de</code> - Blocklist.de feed processing
- <code>tip_batch_bogons</code> - Bogon IP processing
- <code>tip_batch_danger.rulez</code> - Danger.rulez feed processing
- <code>tipbatch_data</code> - Data management
- <code>tip_batch_firebog</code> - Firebog feed processing
- <code>tip_batch_local</code> - Local feed processing
- <code>tip_batch_rf</code> - Recorded Future integration
- <code>tip_community_services</code> - Community threat feeds
- <code>tip_enhancer_rf</code> - Recorded Future enhancer
- <code>tip_nsrl</code> - NSRL hash database
- <code>tip_nvd</code> - National Vulnerability Database</p>
<h3 id="4-integrations">4. integrations</h3>
<p><strong>Purpose</strong>: External system integrations and connectors.</p>
<p><strong>Main Makefile</strong>: <code>integrations/Makefile</code> (if exists)</p>
<p><strong>Integrations</strong> (150+ total including):
- <strong>SIEM Platforms</strong>: Splunk, QRadar, ArcSight, Elastic, etc.
- <strong>Cloud Providers</strong>: AWS services, Azure, GCP
- <strong>Security Tools</strong>: CrowdStrike, SentinelOne, Palo Alto, etc.
- <strong>Threat Intelligence</strong>: VirusTotal, Recorded Future, ThreatConnect
- <strong>Communication</strong>: Slack, Microsoft Teams, Email
- <strong>Identity</strong>: Active Directory, LDAP, Okta
- <strong>Ticketing</strong>: Jira, ServiceNow, Confluence</p>
<h2 id="detailed-component-analysis">Detailed Component Analysis</h2>
<h3 id="zona_services-deep-dive">zona_services Deep Dive</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                          ZONA_SERVICES ARCHITECTURE                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           CORE SERVICES                                │ │
│  │                                                                         │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │ zona_siem   │  │zona_playbook│  │zona_manager │  │ zona_user   │    │ │
│  │  │             │  │             │  │             │  │             │    │ │
│  │  │• Event Proc │  │• Workflow   │  │• Service    │  │• Identity   │    │ │
│  │  │• Correlation│  │• Automation │  │  Orchestr.  │  │• Access Ctrl│    │ │
│  │  │• Analytics  │  │• Response   │  │• Health Mon │  │• User Mgmt  │    │ │
│  │  │• Alerting   │  │• Scheduling │  │• Load Bal.  │  │• RBAC       │    │ │
│  │  │• Dashboards │  │• Reporting  │  │• Auto Scale │  │• SSO        │    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  │                                                                         │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │zona_queryb. │  │zona_ris_srv │  │zona_custom  │  │zona_release │    │ │
│  │  │             │  │             │  │             │  │             │    │ │
│  │  │• SQL Builder│  │• Risk Assess│  │• Plugin Mgmt│  │• Version    │    │ │
│  │  │• Query Optim│  │• Threat Scor│  │• Custom Code│  │  Control    │    │ │
│  │  │• Validation │  │• Intel Aggr │  │• Extensions │  │• Deploy     │    │ │
│  │  │• Caching    │  │• ML Models  │  │• Hooks      │  │  Automation │    │ │
│  │  │• Performance│  │• Prediction │  │• Scripting  │  │• Rollback   │    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  │                                                                         │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │zona_integr. │  │securaa_     │  │securaa_     │  │zona_custom_ │    │ │
│  │  │             │  │backup       │  │restore      │  │utils        │    │ │
│  │  │• Connector  │  │             │  │             │  │             │    │ │
│  │  │  Management │  │• Full Backup│  │• Data Recov │  │• Utilities  │    │ │
│  │  │• API Gateway│  │• Incremental│  │• Point-in-  │  │• Helpers    │    │ │
│  │  │• Rate Limit │  │• Scheduled  │  │  time Restor│  │• Common     │    │ │
│  │  │• Transform  │  │• Compressed │  │• Validation │  │  Functions  │    │ │
│  │  │• Monitoring │  │• Encrypted  │  │• Integrity  │  │• Logging    │    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  │                                                                         │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │zona_process_│  │zona_apis_   │  │zona_ssh     │  │zona_primary_│    │ │
│  │  │manager      │  │manager      │  │client       │  │server_health│    │ │
│  │  │             │  │             │  │             │  │_check       │    │ │
│  │  │• Proc Mgmt  │  │• API Versio │  │• SSH Tunnel │  │• Health Mon │    │ │
│  │  │• Resource   │  │• Rate Limit │  │• Key Mgmt   │  │• Status Chk │    │ │
│  │  │  Monitor    │  │• Auth &amp; Auth│  │• Session    │  │• Alerting   │    │ │
│  │  │• Auto Scale │  │• Logging    │  │  Management │  │• Recovery   │    │ │
│  │  │• Load Bal.  │  │• Metrics    │  │• Security   │  │• Failover   │    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  │                                                                         │ │
│  │  ┌─────────────┐                                                        │ │
│  │  │zona_shard_  │                                                        │ │
│  │  │handler      │                                                        │ │
│  │  │             │                                                        │ │
│  │  │• DB Sharding│                                                        │ │
│  │  │• Data Distri│                                                        │ │
│  │  │• Rebalancing│                                                        │ │
│  │  │• Consistency│                                                        │ │
│  │  │• Performance│                                                        │ │
│  │  └─────────────┘                                                        │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="integration-services-matrix">Integration Services Matrix</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                        INTEGRATION SERVICES MATRIX                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Category         │ Count │ Examples                    │ Protocol/Method  │
│  ─────────────────┼───────┼─────────────────────────────┼─────────────────┤
│  SIEM Platforms   │   25  │ Splunk, QRadar, ArcSight   │ REST, SYSLOG     │
│  Cloud Services   │   30  │ AWS, Azure, GCP             │ REST, GraphQL    │
│  Security Tools   │   35  │ CrowdStrike, SentinelOne    │ REST, gRPC       │
│  Threat Intel     │   15  │ VirusTotal, RecordedFuture  │ REST, TAXII      │
│  Communication   │   12  │ Slack, MSTeams, Email       │ REST, SMTP       │
│  Identity Mgmt    │   10  │ ActiveDir, LDAP, Okta       │ LDAP, SAML, REST │
│  Ticketing        │   8   │ Jira, ServiceNow            │ REST, GraphQL    │
│  Databases        │   6   │ MySQL, PostgreSQL, Oracle   │ SQL, NoSQL       │
│  Network Security │   9   │ Firewall, IPS, DLP          │ SNMP, REST       │
│  Others           │   15+ │ Custom APIs, Legacy Systems │ Various          │
│                                                                             │
│  Total: 150+ Integration Connectors                                        │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="batch-processing-architecture">Batch Processing Architecture</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                         BATCH PROCESSING ARCHITECTURE                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                          zona_batch (4 services)                       │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────┐    ┌─────────────────────────────────────┐ │ │
│  │  │    zona_primary_        │    │         csam_connector              │ │ │
│  │  │    server_health_check  │    │                                     │ │ │
│  │  │                         │    │ • Content Safety &amp; Moderation       │ │ │
│  │  │ • Health monitoring     │◄──►│ • AI/ML content analysis           │ │ │
│  │  │ • Status reporting      │    │ • Policy enforcement               │ │ │
│  │  │ • Alerting              │    │ • Automated responses              │ │ │
│  │  │ • Auto-recovery         │    │ • Real-time scanning               │ │ │
│  │  └─────────────────────────┘    └─────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────┐    ┌─────────────────────────────────────┐ │ │
│  │  │   zona_case_consumer    │    │      zona_batch_manager             │ │ │
│  │  │                         │    │                                     │ │ │
│  │  │ • Case ingestion        │◄──►│ • Batch job orchestration          │ │ │
│  │  │ • Data processing       │    │ • Schedule management              │ │ │
│  │  │ • Event correlation     │    │ • Resource allocation              │ │ │
│  │  │ • Enrichment            │    │ • Queue management                 │ │ │
│  │  │ • State management      │    │ • Error handling &amp; retry           │ │ │
│  │  └─────────────────────────┘    └─────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                      zona_tip_batch (19 services)                      │ │
│  │                                                                         │ │
│  │  Feed Processing Services:                                              │ │
│  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐           │ │
│  │  │tip_batch_       │ │tip_batch_       │ │tip_batch_       │           │ │
│  │  │abuse.ch         │ │bambenek         │ │blocklist.de     │           │ │
│  │  │                 │ │                 │ │                 │           │ │
│  │  │• Malware URLs   │ │• C&amp;C Domains    │ │• Spam IPs       │           │ │
│  │  │• File Hashes    │ │• DNS Analysis   │ │• SSH Brute      │           │ │
│  │  │• IOC Extraction │ │• Threat Intel   │ │• Mail Abuse     │           │ │
│  │  └─────────────────┘ └─────────────────┘ └─────────────────┘           │ │
│  │                                                                         │ │
│  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐           │ │
│  │  │tip_batch_bogons │ │tip_batch_danger │ │tip_batch_       │           │ │
│  │  │                 │ │.rulez           │ │firebog          │           │ │
│  │  │                 │ │                 │ │                 │           │ │
│  │  │• Invalid IPs    │ │• Mixed Feeds    │ │• Ad/Malware     │           │ │
│  │  │• Bogon Networks │ │• Threat Lists   │ │  Domains        │           │ │
│  │  │• Route Validation│ │• IOC Feeds     │ │• Blocklists     │           │ │
│  │  └─────────────────┘ └─────────────────┘ └─────────────────┘           │ │
│  │                                                                         │ │
│  │  Core TIP Services:                                                     │ │
│  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐           │ │
│  │  │tip_services     │ │zona_taxii_server│ │tip_enhancer     │           │ │
│  │  │                 │ │                 │ │                 │           │ │
│  │  │• Core TIP Logic │ │• TAXII 2.0/2.1  │ │• Data Enrichment│           │ │
│  │  │• IOC Management │ │• Collection Mgmt│ │• Context Adding │           │ │
│  │  │• Feed Normalize │ │• Client Support │ │• Reputation     │           │ │
│  │  └─────────────────┘ └─────────────────┘ └─────────────────┘           │ │
│  │                                                                         │ │
│  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐           │ │
│  │  │tip_deletion_    │ │tipbatch_data    │ │tip_community_   │           │ │
│  │  │batch            │ │                 │ │services         │           │ │
│  │  │                 │ │                 │ │                 │           │ │
│  │  │• Data Cleanup   │ │• Data Lake Mgmt │ │• Community Feeds│           │ │
│  │  │• Retention      │ │• Storage Optim  │ │• Crowd-sourced  │           │ │
│  │  │• Purge Old Data │ │• Compression    │ │• Collaborative  │           │ │
│  │  └─────────────────┘ └─────────────────┘ └─────────────────┘           │ │
│  │                                                                         │ │
│  │  Enterprise &amp; Government Sources:                                       │ │
│  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐           │ │
│  │  │tip_nvd          │ │tip_nsrl         │ │tip_batch_rf     │           │ │
│  │  │                 │ │                 │ │                 │           │ │
│  │  │• CVE Database   │ │• NSRL Hash Set  │ │• Recorded Future│           │ │
│  │  │• Vulnerability  │ │• Known Good     │ │• Commercial TI  │           │ │
│  │  │• CVSS Scoring   │ │• File Hashes    │ │• Risk Scoring   │           │ │
│  │  └─────────────────┘ └─────────────────┘ └─────────────────┘           │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="1-build_securaa">1. build_securaa</h3>
<p><strong>Purpose</strong>: Main platform packaging and deployment artifacts.</p>
<p><strong>Key Components</strong>:
- <strong>Package Building</strong> (<code>pkg/Makefile</code>): RPM package creation
- <strong>Core Services</strong> (<code>securaa/Makefile</code>): Core service building
- <strong>Upgrade System</strong> (<code>upgrade/Makefile</code>): Version upgrade packages
- <strong>Database Setup</strong> (<code>executedb/Makefile</code>): Database initialization</p>
<p><strong>Package Types</strong>:
- <code>securaa_mssp_complete</code> - Complete MSSP installation
- <code>securaa_mssp_core_services_ui</code> - Core services and UI
- <code>securaa_mssp_core_db</code> - Database components
- <code>securaa_mssp_ml</code> - Machine learning components
- <code>securaa_arbiter</code> - MongoDB arbiter
- <code>securaa_worker_node</code> - Worker node components</p>
<h3 id="2-build_tip_securaa">2. build_tip_securaa</h3>
<p><strong>Purpose</strong>: Threat Intelligence Platform specific packaging.</p>
<p>Similar structure to <code>build_securaa</code> but focused on TIP components.</p>
<h2 id="common-makefile-patterns">Common Makefile Patterns</h2>
<h3 id="standard-go-service-makefile-pattern">Standard Go Service Makefile Pattern</h3>
<p>All individual service Makefiles follow this pattern:</p>
<pre class="highlight"><code class="language-makefile"># Environment Variables from .env
TARGET ?= $(shell . ./.env &amp;&amp; echo $$TARGET)
GIT_REF ?= $(shell . ./.env &amp;&amp; echo $$GIT_REF)
GIT_BRANCH ?= $(shell . ./.env &amp;&amp; echo $$GIT_BRANCH)
INFO ?= $(shell . ./.env &amp;&amp; echo $$INFO)
BUILD_VERSION ?= $(shell . ./.env &amp;&amp; echo $$BUILD_VERSION)
BUILD_NUMBER ?= $(shell . ./.env &amp;&amp; echo $$BUILD_NUMBER)
RUNTIME_DOCKER_IMAGE ?= $(shell . ./.env &amp;&amp; echo $$RUNTIME_DOCKER_IMAGE)

# Build Configuration
BUILD_ENV ?= CGO_ENABLED=0
PACKAGES = $$(go list ./... | grep -v /vendor/)
BUILD_FLAGS ?= -ldflags &quot;-X main.GitRef=$(GIT_REF) ...&quot;

# Standard Targets
build: builddir
    $(BUILD_ENV) go build -mod vendor $(BUILD_FLAGS) -o build/$(TARGET)

vendor:
    GO111MODULE=on go mod vendor

clean:
    rm -rf build/*

# Docker Targets
image_ecr: builddir
    DOCKER_BUILDKIT=1 docker build --pull -t $(RUNTIME_DOCKER_IMAGE_ECR):latest ...
</code></pre>

<h3 id="aggregation-makefile-pattern">Aggregation Makefile Pattern</h3>
<p>Top-level Makefiles follow this pattern:</p>
<pre class="highlight"><code class="language-makefile">TARGETS:= service1 service2 service3 ...
BUILD_LOG:= build.log
EXPORT_DIR:= /opt/zona/build/component_name

all:
    for DIR in $(TARGETS); do \
        $(MAKE) vendor --directory=$$DIR; \
        $(MAKE) build --directory=$$DIR; \
    done

clean:
    for DIR in $(TARGETS); do \
        $(MAKE) clean --directory=$$DIR; \
    done

export: builddir
    for DIR in $(TARGETS); do \
        cp -f $$DIR/build/* $(EXPORT_DIR)/ &gt;&gt; $(BUILD_LOG) 2&gt;&amp;1; \
    done
</code></pre>

<h2 id="environment-configuration">Environment Configuration</h2>
<h3 id="env-file-structure">.env File Structure</h3>
<p>Each service directory contains a <code>.env</code> file with:</p>
<pre class="highlight"><code class="language-bash">TARGET=service_name
GIT_REF=git_commit_hash
GIT_BRANCH=branch_name
INFO=&quot;Service Description&quot;
BUILD_VERSION=6.1.0
BUILD_NUMBER=build_number
RUNTIME_DOCKER_IMAGE=registry/image_name
RUNTIME_DOCKER_IMAGE_ECR=ecr_registry/image_name
RUNTIME_DOCKER_IMAGE_LOCAL=local_registry/image_name
</code></pre>

<h3 id="aws-environment">AWS Environment</h3>
<p>Some services support AWS-specific configuration via <code>aws.env</code>:</p>
<pre class="highlight"><code class="language-bash"># AWS-specific build configuration
TARGET=aws_service_name
# ... AWS-specific variables
</code></pre>

<h2 id="build-targets-reference">Build Targets Reference</h2>
<h3 id="common-targets-all-services">Common Targets (All Services)</h3>
<table>
<thead>
<tr>
<th>Target</th>
<th>Purpose</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>build</code></td>
<td>Compile</td>
<td>Builds the Go binary with vendor dependencies</td>
</tr>
<tr>
<td><code>vendor</code></td>
<td>Dependencies</td>
<td>Downloads and vendors Go module dependencies</td>
</tr>
<tr>
<td><code>clean</code></td>
<td>Cleanup</td>
<td>Removes build artifacts</td>
</tr>
<tr>
<td><code>builddir</code></td>
<td>Setup</td>
<td>Creates build directory</td>
</tr>
<tr>
<td><code>vet</code></td>
<td>Code Analysis</td>
<td>Runs Go vet for code analysis</td>
</tr>
<tr>
<td><code>lint</code></td>
<td>Linting</td>
<td>Runs golangci-lint</td>
</tr>
<tr>
<td><code>fmt</code></td>
<td>Formatting</td>
<td>Formats Go code</td>
</tr>
<tr>
<td><code>update</code></td>
<td>Update Deps</td>
<td>Updates Go dependencies</td>
</tr>
</tbody>
</table>
<h3 id="docker-targets">Docker Targets</h3>
<table>
<thead>
<tr>
<th>Target</th>
<th>Purpose</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>builder</code></td>
<td>Build Env</td>
<td>Creates builder Docker image</td>
</tr>
<tr>
<td><code>image</code></td>
<td>Local Image</td>
<td>Builds local Docker image</td>
</tr>
<tr>
<td><code>image_ecr</code></td>
<td>ECR Image</td>
<td>Builds ECR-tagged Docker image</td>
</tr>
<tr>
<td><code>image_local</code></td>
<td>Local Tagged</td>
<td>Builds locally-tagged Docker image</td>
</tr>
<tr>
<td><code>push</code></td>
<td>Push Image</td>
<td>Pushes image to registry</td>
</tr>
<tr>
<td><code>push_ecr</code></td>
<td>Push ECR</td>
<td>Pushes image to ECR</td>
</tr>
</tbody>
</table>
<h3 id="aggregation-targets">Aggregation Targets</h3>
<table>
<thead>
<tr>
<th>Target</th>
<th>Purpose</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>all</code></td>
<td>Build All</td>
<td>Builds all services in the component</td>
</tr>
<tr>
<td><code>export</code></td>
<td>Copy Artifacts</td>
<td>Copies built binaries to export directory</td>
</tr>
<tr>
<td><code>clean</code></td>
<td>Clean All</td>
<td>Cleans all services in the component</td>
</tr>
</tbody>
</table>
<h3 id="package-management-targets-build_securaapkg">Package Management Targets (build_securaa/pkg)</h3>
<table>
<thead>
<tr>
<th>Target</th>
<th>Purpose</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rpm</code></td>
<td>Default Package</td>
<td>Builds complete MSSP RPM</td>
</tr>
<tr>
<td><code>rpm_mssp_complete</code></td>
<td>Complete Package</td>
<td>Full MSSP installation package</td>
</tr>
<tr>
<td><code>rpm_mssp_core_services_ui</code></td>
<td>Core Services</td>
<td>Core services and UI package</td>
</tr>
<tr>
<td><code>rpm_mssp_core_db</code></td>
<td>Database</td>
<td>Database components package</td>
</tr>
<tr>
<td><code>rpm_mssp_ml</code></td>
<td>ML Package</td>
<td>Machine learning components</td>
</tr>
<tr>
<td><code>rpm_arbiter</code></td>
<td>Arbiter</td>
<td>MongoDB arbiter package</td>
</tr>
<tr>
<td><code>rpm_worker_node</code></td>
<td>Worker Node</td>
<td>Worker node package</td>
</tr>
</tbody>
</table>
<h2 id="cicd-integration">CI/CD Integration</h2>
<h3 id="continuous-integration-pipeline">Continuous Integration Pipeline</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                           CI/CD PIPELINE ARCHITECTURE                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │
│  │   Source    │───►│   Build     │───►│    Test     │───►│   Deploy    │   │
│  │   Control   │    │   System    │    │   Suite     │    │   Pipeline  │   │
│  │             │    │             │    │             │    │             │   │
│  │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │   │
│  │ │ Git     │ │    │ │ Make    │ │    │ │ Unit    │ │    │ │ Swarm   │ │   │
│  │ │ Webhook │─┼───►│ │ System  │─┼───►│ │ Tests   │─┼───►│ │ Deploy  │ │   │
│  │ │ Trigger │ │    │ │         │ │    │ │         │ │    │ │         │ │   │
│  │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │   │
│  │             │    │             │    │             │    │             │   │
│  │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │   │
│  │ │ Branch  │ │    │ │ Docker  │ │    │ │ Integr. │ │    │ │ Compose │ │   │
│  │ │ Policy  │ │    │ │ Build   │ │    │ │ Tests   │ │    │ │ Charts  │ │   │
│  │ │ Check   │ │    │ │         │ │    │ │         │ │    │ │         │ │   │
│  │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │   │
│  │             │    │             │    │             │    │             │   │
│  │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │   │
│  │ │ PR/MR   │ │    │ │ Package │ │    │ │ Security│ │    │ │ Rollback│ │   │
│  │ │ Approve │ │    │ │ RPM     │ │    │ │ Scan    │ │    │ │ Support │ │   │
│  │ │         │ │    │ │         │ │    │ │         │ │    │ │         │ │   │
│  │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │   │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="jenkins-pipeline-configuration">Jenkins Pipeline Configuration</h3>
<pre class="highlight"><code class="language-groovy">pipeline {
    agent any
    environment {
        REGISTRY = 'your-ecr-registry'
        BUILD_VERSION = &quot;${env.BUILD_NUMBER}&quot;
        GIT_REF = &quot;${env.GIT_COMMIT}&quot;
        GIT_BRANCH = &quot;${env.GIT_BRANCH}&quot;
    }
    stages {
        stage('Checkout') {
            steps { 
                checkout scm 
                sh 'git submodule update --init --recursive'
            }
        }
        stage('Build Libraries') {
            parallel {
                stage('securaa') {
                    steps { 
                        sh '''
                            cd securaa
                            go mod vendor
                            go build ./...
                        '''
                    }
                }
                stage('securaa_lib') {
                    steps { 
                        sh '''
                            cd securaa_lib
                            go mod vendor
                            go build ./...
                        '''
                    }
                }
                stage('securaa_pylib') {
                    steps { 
                        sh '''
                            cd securaa_pylib
                            pip install -r requirements.txt
                            python setup.py build
                        '''
                    }
                }
                stage('securaa_ris_client') {
                    steps { 
                        sh '''
                            cd securaa_ris_client
                            go mod vendor
                            go build ./...
                        '''
                    }
                }
            }
        }
        stage('Build Services') {
            parallel {
                stage('zona_services') {
                    steps { 
                        sh '''
                            cd zona_services
                            make all
                            make export
                        '''
                    }
                }
                stage('zona_batch') {
                    steps { 
                        sh '''
                            cd zona_batch
                            make all
                            make export
                        '''
                    }
                }
                stage('zona_tip_batch') {
                    steps { 
                        sh '''
                            cd zona_tip_batch
                            make all
                            make export
                        '''
                    }
                }
                stage('securaa_csam') {
                    steps { 
                        sh '''
                            cd securaa_csam
                            make all
                            make export
                        '''
                    }
                }
                stage('zonareact') {
                    steps { 
                        sh '''
                            cd zonareact
                            npm install
                            npm run build
                        '''
                    }
                }
            }
        }
        stage('Test &amp; Security') {
            parallel {
                stage('Unit Tests') {
                    steps { 
                        sh 'make test-all'
                        publishTestResults testResultsPattern: '**/test-results.xml'
                    }
                }
                stage('Security Scan') {
                    steps { 
                        sh 'make security-scan'
                        publishHTML([
                            allowMissing: false,
                            alwaysLinkToLastBuild: true,
                            keepAll: true,
                            reportDir: 'security-reports',
                            reportFiles: 'index.html',
                            reportName: 'Security Report'
                        ])
                    }
                }
                stage('Vulnerability Check') {
                    steps {
                        sh 'make vulnerability-check'
                    }
                }
            }
        }
        stage('Package Creation') {
            when { branch 'main' }
            steps {
                sh '''
                    cd build_securaa/pkg
                    make rpm_mssp_complete
                    make rpm_mssp_core_services_ui
                    make rpm_mssp_core_db
                    make rpm_mssp_ml
                    make rpm_arbiter
                    make rpm_worker_node
                '''
                archiveArtifacts artifacts: 'build_securaa/pkg/rpms/*.rpm', 
                                fingerprint: true
            }
        }
        stage('Docker Build &amp; Push') {
            when { branch 'main' }
            parallel {
                stage('Core Services Images') {
                    steps {
                        sh '''
                            cd zona_services
                            for service in $(echo $TARGETS | tr ' ' '\n'); do
                                cd $service
                                make image_ecr
                                make push_ecr
                                cd ..
                            done
                        '''
                    }
                }
                stage('Integration Images') {
                    steps {
                        sh '''
                            cd integrations
                            # Build subset of critical integrations
                            make zona_splunk &amp;&amp; make image_ecr --directory=zona_splunk
                            make zona_qradar &amp;&amp; make image_ecr --directory=zona_qradar
                            # Add more as needed
                        '''
                    }
                }
            }
        }
        stage('Deploy to Staging') {
            when { branch 'main' }
            steps {
                sh '''
                    helm upgrade --install securaa-staging ./helm/securaa \
                        --set image.tag=${BUILD_VERSION} \
                        --set environment=staging \
                        --namespace securaa-staging
                '''
            }
        }
    }
    post {
        always {
            cleanWs()
            sh 'docker system prune -f'
        }
        success {
            mail to: 'dev-team@company.com',
                 subject: &quot;✅ SECURAA Build ${BUILD_VERSION} Successful&quot;,
                 body: &quot;Build completed successfully. Ready for deployment.&quot;
        }
        failure {
            mail to: 'dev-team@company.com',
                 subject: &quot;❌ SECURAA Build ${BUILD_VERSION} Failed&quot;, 
                 body: &quot;Build failed. Please check the console output.&quot;
        }
    }
}
</code></pre>

<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="build-performance-metrics">Build Performance Metrics</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                         BUILD PERFORMANCE ANALYSIS                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Component          │ Services │ Sequential │ Parallel │ Optimization      │
│  ──────────────────┼──────────┼────────────┼──────────┼──────────────────┤
│  securaa            │    -     │   2m 30s   │    -     │ Module cache      │
│  securaa_lib        │    -     │   1m 45s   │    -     │ Vendor reuse      │
│  zona_services      │    18    │  15m 20s   │  4m 15s  │ Parallel -j8      │
│  zona_batch         │     4    │   4m 10s   │  1m 20s  │ Parallel -j4      │
│  zona_tip_batch     │    19    │  16m 45s   │  4m 30s  │ Parallel -j8      │
│  integrations       │   150+   │  45m 30s   │ 12m 45s  │ Parallel -j16     │
│  Docker builds      │   All    │  25m 15s   │  8m 20s  │ BuildKit + cache  │
│  RPM packaging      │     6    │   8m 20s   │  3m 10s  │ Parallel + pigz   │
│                                                                             │
│  TOTAL             │   191+   │ ~2h 15m    │ ~35m     │ 74% time reduction │
│                                                                             │
│  Resource Requirements:                                                     │
│  • CPU: 16+ cores recommended for full parallel builds                     │
│  • Memory: 32GB+ for large integration builds                              │
│  • Storage: 500GB+ SSD for build cache and artifacts                      │
│  • Network: 1Gbps+ for dependency downloads and registry pushes           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="advanced-optimization-techniques">Advanced Optimization Techniques</h3>
<pre class="highlight"><code class="language-makefile"># High-performance Makefile configuration

# Parallel processing configuration
NPROC := $(shell nproc)
PARALLEL_JOBS := $(shell echo $$(($(NPROC) * 2)))
export MAKEFLAGS += -j$(PARALLEL_JOBS)

# Go build optimization
export CGO_ENABLED=0
export GOCACHE=/tmp/go-build-cache
export GOMODCACHE=/tmp/go-mod-cache
export GOMAXPROCS=$(NPROC)

# Compiler optimizations
BUILD_FLAGS := -ldflags=&quot;-s -w -X main.Version=$(BUILD_VERSION)&quot; \
               -trimpath \
               -buildmode=exe \
               -compiler=gc

# Docker optimization
DOCKER_BUILDKIT := 1
BUILDKIT_PROGRESS := plain

# Advanced targets
build-optimized: export GOOS=linux
build-optimized: export GOARCH=amd64
build-optimized: builddir
    go build $(BUILD_FLAGS) -o build/$(TARGET)

# Parallel component build with dependency management
all-parallel:
    @echo &quot;Building with $(PARALLEL_JOBS) parallel jobs&quot;
    $(MAKE) -j$(PARALLEL_JOBS) $(TARGETS)

# Cache-optimized Docker build
image-cache-optimized: builddir
    DOCKER_BUILDKIT=1 docker build \
        --cache-from $(REGISTRY)/$(TARGET):cache \
        --cache-to $(REGISTRY)/$(TARGET):cache,mode=max \
        --build-arg BUILDKIT_INLINE_CACHE=1 \
        --build-arg PARALLEL_JOBS=$(PARALLEL_JOBS) \
        -t $(RUNTIME_DOCKER_IMAGE):latest .

# Compressed packaging
package-optimized: clean copy_files
    tar --use-compress-program=&quot;pigz -9 -p $(NPROC)&quot; \
        -cf $(PKG_NAME).tar.gz $(PKG_DIR)
    rpmbuild -bb \
        --define &quot;_binary_payload w9.xzdio&quot; \
        --define &quot;_source_payload w9.xzdio&quot; \
        $(SPEC_FILE)

# Memory-optimized build for large projects
build-memory-optimized: export GOGC=off
build-memory-optimized: export GOMEMLIMIT=16GiB
build-memory-optimized: build-optimized

.PHONY: build-optimized all-parallel image-cache-optimized package-optimized
</code></pre>

<h2 id="security-considerations">Security Considerations</h2>
<h3 id="security-framework-implementation">Security Framework Implementation</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                           SECURITY IMPLEMENTATION                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                         SUPPLY CHAIN SECURITY                          │ │
│  │                                                                         │ │
│  │  1. Dependency Verification                                             │ │
│  │     ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │     │ go.sum verification:                                            │ │ │
│  │     │ • Cryptographic checksums for all dependencies                 │ │ │
│  │     │ • Module proxy verification (GOPROXY=proxy.golang.org)         │ │ │
│  │     │ • GOSUMDB verification for tamper detection                    │ │ │
│  │     │                                                                 │ │ │
│  │     │ Vulnerability scanning:                                        │ │ │
│  │     │ • govulncheck for known CVEs                                   │ │ │
│  │     │ • Nancy for dependency vulnerabilities                         │ │ │
│  │     │ • Snyk for comprehensive security analysis                     │ │ │
│  │     │                                                                 │ │ │
│  │     │ License compliance:                                            │ │ │
│  │     │ • FOSSA for license scanning                                   │ │ │
│  │     │ • Blackduck for IP compliance                                  │ │ │
│  │     │ • Custom license allowlist enforcement                         │ │ │
│  │     └─────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  2. Build Environment Security                                         │ │
│  │     ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │     │ Isolated builds:                                               │ │ │
│  │     │ • Ephemeral build containers                                   │ │ │
│  │     │ • No persistent state between builds                          │ │ │
│  │     │ • Network segmentation                                         │ │ │
│  │     │ • Resource limits and quotas                                   │ │ │
│  │     │                                                                 │ │ │
│  │     │ Build attestation:                                             │ │ │
│  │     │ • SLSA (Supply-chain Levels for Software Artifacts)           │ │ │
│  │     │ • In-toto metadata generation                                  │ │ │
│  │     │ • Provenance tracking                                          │ │ │
│  │     │ • Build reproducibility verification                           │ │ │
│  │     └─────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  3. Code Security                                                      │ │
│  │     ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │     │ Static analysis:                                               │ │ │
│  │     │ • gosec for Go security issues                                 │ │ │
│  │     │ • staticcheck for code quality                                 │ │ │
│  │     │ • golangci-lint with security rules                            │ │ │
│  │     │ • CodeQL for semantic analysis                                 │ │ │
│  │     │                                                                 │ │ │
│  │     │ Secret detection:                                              │ │ │
│  │     │ • TruffleHog for secrets in git history                       │ │ │
│  │     │ • GitLeaks for credential scanning                             │ │ │
│  │     │ • Custom regex patterns for API keys                          │ │ │
│  │     │ • Pre-commit hooks for prevention                              │ │ │
│  │     └─────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                       CONTAINER &amp; RUNTIME SECURITY                     │ │
│  │                                                                         │ │
│  │  1. Container Hardening                                                │ │
│  │     ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │     │ Base image security:                                           │ │ │
│  │     │ • Distroless or minimal Alpine images                          │ │ │
│  │     │ • Regular security updates                                     │ │ │
│  │     │ • CVE scanning with Trivy/Clair                                │ │ │
│  │     │ • Image signing with Cosign/Notary                             │ │ │
│  │     │                                                                 │ │ │
│  │     │ Runtime security:                                              │ │ │
│  │     │ • Non-root user (USER nobody)                                  │ │ │
│  │     │ • Read-only root filesystem                                    │ │ │
│  │     │ • Minimal Linux capabilities                                   │ │ │
│  │     │ • Security contexts in Docker Swarm                            │ │ │
│  │     │ • AppArmor/SELinux profiles                                    │ │ │
│  │     └─────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                         │ │
│  │  2. Registry Security                                                  │ │
│  │     ┌─────────────────────────────────────────────────────────────────┐ │ │
│  │     │ Access control:                                                │ │ │
│  │     │ • Private registry with RBAC                                   │ │ │
│  │     │ • Service account authentication                               │ │ │
│  │     │ • Image pull policies                                          │ │ │
│  │     │ • Admission controllers (OPA Gatekeeper)                       │ │ │
│  │     │                                                                 │ │ │
│  │     │ Content trust:                                                 │ │ │
│  │     │ • Docker Content Trust                                         │ │ │
│  │     │ • Image signature verification                                 │ │ │
│  │     │ • Policy-as-code enforcement                                   │ │ │
│  │     │ • Vulnerability thresholds                                     │ │ │
│  │     └─────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="security-makefile-targets">Security Makefile Targets</h3>
<pre class="highlight"><code class="language-makefile"># Security-focused build targets

# Comprehensive security check
security-all: security-deps security-code security-container security-package
    @echo &quot;✅ All security checks completed&quot;

# Dependency security verification
security-deps:
    @echo &quot;🔍 Checking dependencies for vulnerabilities...&quot;
    go list -json -m all | nancy sleuth
    govulncheck -json ./... | jq '.'
    go mod verify
    go mod tidy -diff

# Code security analysis
security-code:
    @echo &quot;🔍 Running static security analysis...&quot;
    gosec -fmt json -out gosec-report.json ./...
    staticcheck -f json ./... &gt; staticcheck-report.json
    golangci-lint run --out-format json --issues-exit-code=0 &gt; golangci-report.json

# Secret detection
security-secrets:
    @echo &quot;🔍 Scanning for secrets...&quot;
    trufflehog git file://. --json &gt; trufflehog-report.json
    gitleaks detect --source . --report-format json --report-path gitleaks-report.json

# Container security scanning  
security-container:
    @echo &quot;🔍 Scanning container images...&quot;
    trivy image --format json --output trivy-report.json $(RUNTIME_DOCKER_IMAGE):latest
    docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
        aquasec/trivy image --format table $(RUNTIME_DOCKER_IMAGE):latest

# Package integrity verification
security-package:
    @echo &quot;🔍 Verifying package integrity...&quot;
    rpm --checksig $(RPM_FILES)
    sha256sum $(RPM_FILES) &gt; checksums.txt
    gpg --detach-sign --armor checksums.txt

# SBOM generation
security-sbom:
    @echo &quot;📋 Generating Software Bill of Materials...&quot;
    cyclonedx-gomod mod -json -output sbom.json
    syft packages . -o spdx-json &gt; sbom-spdx.json

# License compliance check
security-license:
    @echo &quot;⚖️  Checking license compliance...&quot;
    go-licenses check ./...
    fossa analyze
    blackduck-detect

# Build provenance
security-provenance:
    @echo &quot;📜 Generating build provenance...&quot;
    in-toto-record start --step-name build --key $(SIGNING_KEY)
    # Build process happens here
    in-toto-record stop --step-name build --key $(SIGNING_KEY)

# Secure build with attestation
build-secure: security-deps security-code
    @echo &quot;🔐 Performing secure build...&quot;
    $(BUILD_ENV) go build \
        -ldflags &quot;-s -w -X main.BuildSecure=true -X main.BuildAttestation=$(shell date -u +%Y%m%d%H%M%S)&quot; \
        -o build/$(TARGET)
    sha256sum build/$(TARGET) &gt; build/$(TARGET).sha256
    gpg --detach-sign --armor build/$(TARGET)

.PHONY: security-all security-deps security-code security-secrets security-container security-package security-sbom security-license security-provenance build-secure
</code></pre>

<h2 id="docker-integration">Docker Integration</h2>
<h3 id="multi-stage-builds">Multi-Stage Builds</h3>
<p>Services use multi-stage Docker builds:</p>
<pre class="highlight"><code class="language-dockerfile"># Builder stage
FROM golang:alpine AS builder
...

# Runtime stage  
FROM alpine:latest
COPY --from=builder /app/binary /app/
</code></pre>

<h3 id="build-arguments">Build Arguments</h3>
<p>Docker builds accept these arguments:
- <code>TARGET</code> - Service name
- <code>GIT_REF</code> - Git commit reference
- <code>GIT_BRANCH</code> - Git branch name
- <code>BUILD_VERSION</code> - Version number
- <code>BUILD_NUMBER</code> - Build number</p>
<h3 id="registry-support">Registry Support</h3>
<p>Three registry types supported:
- <strong>Local</strong>: For development
- <strong>ECR</strong>: AWS Elastic Container Registry
- <strong>Custom</strong>: Configurable registry</p>
<h2 id="package-management">Package Management</h2>
<h3 id="rpm-packaging">RPM Packaging</h3>
<p>The system generates RPM packages for different deployment scenarios:</p>
<ol>
<li><strong>Complete MSSP</strong>: Full platform installation</li>
<li><strong>Core Services</strong>: Essential services only</li>
<li><strong>Database</strong>: Database components</li>
<li><strong>Machine Learning</strong>: ML/AI components</li>
<li><strong>Worker Nodes</strong>: Distributed processing nodes</li>
<li><strong>Arbiter</strong>: MongoDB cluster arbiters</li>
</ol>
<h3 id="package-structure">Package Structure</h3>
<pre class="highlight"><code>/opt/zona/build/
├── zona_services/     # Core service binaries
├── zona_batch/        # Batch service binaries
├── zona_tip_batch/    # TIP service binaries
└── integrations/      # Integration binaries
</code></pre>

<h3 id="version-management">Version Management</h3>
<ul>
<li><strong>Version</strong>: 6.1.0 (current)</li>
<li><strong>Upgrade Path</strong>: Sequential version upgrades supported</li>
<li><strong>Rollback</strong>: Previous version rollback capability</li>
</ul>
<h2 id="development-workflows">Development Workflows</h2>
<h3 id="building-a-single-service">Building a Single Service</h3>
<pre class="highlight"><code class="language-bash">cd /path/to/service
make vendor    # Download dependencies
make build     # Build binary
make clean     # Clean artifacts
</code></pre>

<h3 id="building-component-group">Building Component Group</h3>
<pre class="highlight"><code class="language-bash">cd zona_services
make all       # Build all services
make export    # Copy to export directory
make clean     # Clean all services
</code></pre>

<h3 id="building-specific-service">Building Specific Service</h3>
<pre class="highlight"><code class="language-bash">cd zona_services
make zona_siem        # Build specific service
make clean_zona_siem  # Clean specific service
</code></pre>

<h3 id="docker-workflow">Docker Workflow</h3>
<pre class="highlight"><code class="language-bash">make image_ecr    # Build ECR image
make push_ecr     # Push to ECR
</code></pre>

<h3 id="package-building">Package Building</h3>
<pre class="highlight"><code class="language-bash">cd build_securaa/pkg
make rpm_mssp_complete     # Build complete package
make rpm_mssp_core_db      # Build database package
</code></pre>

<h3 id="development-cycle">Development Cycle</h3>
<ol>
<li><strong>Code Changes</strong>: Modify source code</li>
<li><strong>Vendor</strong>: <code>make vendor</code> (if dependencies changed)</li>
<li><strong>Build</strong>: <code>make build</code></li>
<li><strong>Test</strong>: Run unit tests</li>
<li><strong>Docker</strong>: <code>make image_local</code> (for containerized testing)</li>
<li><strong>Package</strong>: Build RPM for deployment testing</li>
</ol>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-dependency-management">1. Dependency Management</h3>
<ul>
<li>Always run <code>make vendor</code> after dependency changes</li>
<li>Use Go modules (<code>go.mod</code>) for dependency specification</li>
<li>Vendor dependencies for reproducible builds</li>
</ul>
<h3 id="2-environment-configuration">2. Environment Configuration</h3>
<ul>
<li>Maintain <code>.env</code> files for each service</li>
<li>Use consistent naming conventions</li>
<li>Version build information in binaries</li>
</ul>
<h3 id="3-build-optimization">3. Build Optimization</h3>
<ul>
<li>Use <code>CGO_ENABLED=0</code> for static binaries</li>
<li>Leverage build caching where possible</li>
<li>Use multi-stage Docker builds</li>
</ul>
<h3 id="4-clean-builds">4. Clean Builds</h3>
<ul>
<li>Run <code>make clean</code> before important builds</li>
<li>Clean export directories between builds</li>
<li>Maintain separate build environments</li>
</ul>
<h3 id="5-version-control">5. Version Control</h3>
<ul>
<li>Tag releases appropriately</li>
<li>Include git information in builds</li>
<li>Maintain build traceability</li>
</ul>
<h3 id="6-docker-best-practices">6. Docker Best Practices</h3>
<ul>
<li>Use specific base image tags</li>
<li>Minimize layer count</li>
<li>Cache expensive operations</li>
<li>Use .dockerignore files</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="1-dependency-issues">1. Dependency Issues</h4>
<p><strong>Problem</strong>: <code>vendor</code> directory missing or outdated</p>
<pre class="highlight"><code class="language-bash"># Solution
make vendor
</code></pre>

<p><strong>Problem</strong>: Module not found errors</p>
<pre class="highlight"><code class="language-bash"># Solution
go mod tidy
make vendor
</code></pre>

<h4 id="2-build-failures">2. Build Failures</h4>
<p><strong>Problem</strong>: CGO linking errors</p>
<pre class="highlight"><code class="language-bash"># Solution - Ensure CGO is disabled
export CGO_ENABLED=0
make build
</code></pre>

<p><strong>Problem</strong>: Missing environment variables</p>
<pre class="highlight"><code class="language-bash"># Solution - Check .env file
cat .env
source .env
make build
</code></pre>

<h4 id="3-docker-issues">3. Docker Issues</h4>
<p><strong>Problem</strong>: Docker build context too large</p>
<pre class="highlight"><code class="language-bash"># Solution - Use .dockerignore
echo &quot;vendor/&quot; &gt;&gt; .dockerignore
echo &quot;build/&quot; &gt;&gt; .dockerignore
</code></pre>

<p><strong>Problem</strong>: Registry authentication</p>
<pre class="highlight"><code class="language-bash"># Solution - Login to registry
aws ecr get-login-password | docker login --username AWS --password-stdin &lt;registry&gt;
</code></pre>

<h4 id="4-package-building-issues">4. Package Building Issues</h4>
<p><strong>Problem</strong>: RPM build directory permissions</p>
<pre class="highlight"><code class="language-bash"># Solution - Set up rpmbuild directories
mkdir -p ~/rpmbuild/{SOURCES,SPECS,BUILD,SRPMS,RPMS}
</code></pre>

<p><strong>Problem</strong>: Missing build dependencies</p>
<pre class="highlight"><code class="language-bash"># Solution - Install build tools
yum install rpm-build rpmdevtools
</code></pre>

<h3 id="debugging-steps">Debugging Steps</h3>
<ol>
<li><strong>Check Environment</strong>: Verify <code>.env</code> file contents</li>
<li><strong>Verify Dependencies</strong>: Ensure <code>vendor/</code> directory exists</li>
<li><strong>Check Disk Space</strong>: Ensure sufficient space for builds</li>
<li><strong>Test Individually</strong>: Build services one at a time</li>
<li><strong>Check Logs</strong>: Review <code>build.log</code> for detailed errors</li>
<li><strong>Clean and Retry</strong>: Use <code>make clean</code> and rebuild</li>
</ol>
<h3 id="log-analysis">Log Analysis</h3>
<p>Build logs are written to <code>build.log</code> in component directories:</p>
<pre class="highlight"><code class="language-bash"># Check recent build output
tail -f build.log

# Search for specific errors
grep -i error build.log
grep -i fail build.log
</code></pre>

<h3 id="performance-optimization_1">Performance Optimization</h3>
<ul>
<li><strong>Parallel Builds</strong>: Use <code>make -j&lt;n&gt;</code> for parallel builds</li>
<li><strong>Build Caching</strong>: Leverage Docker build cache</li>
<li><strong>Incremental Builds</strong>: Only rebuild changed components</li>
<li><strong>Resource Allocation</strong>: Ensure adequate CPU/memory for builds</li>
</ul>
<hr />
<h2 id="summary">Summary</h2>
<p>The SECURAA Make system provides a comprehensive, scalable build infrastructure supporting:</p>
<ul>
<li><strong>150+ Integration Services</strong>: External system connectors</li>
<li><strong>18 Core Services</strong>: Platform functionality</li>
<li><strong>19 TIP Services</strong>: Threat intelligence processing  </li>
<li><strong>4 Batch Services</strong>: Data processing</li>
<li><strong>Multiple Package Types</strong>: RPM packages for different deployment scenarios</li>
<li><strong>Docker Integration</strong>: Container-based deployment</li>
<li><strong>Multi-Environment Support</strong>: Development, staging, production</li>
</ul>
<p>The system's hierarchical structure enables efficient development, testing, and deployment of the complex SECURAA cybersecurity platform while maintaining consistency and reliability across all components.</p>
<h2 id="advanced-configuration">Advanced Configuration</h2>
<h3 id="environment-specific-configuration">Environment-Specific Configuration</h3>
<pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────────────────┐
│                        ENVIRONMENT CONFIGURATION MATRIX                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Environment  │ Build Type │ Optimization │ Security │ Registry           │
│  ────────────┼────────────┼──────────────┼──────────┼───────────────────┤
│  Development │ Debug      │ Fast build   │ Basic    │ Local registry    │
│  Testing      │ Debug      │ Parallel     │ Standard │ Test registry     │
│  Staging      │ Release    │ Optimized    │ Enhanced │ Staging registry  │
│  Production   │ Release    │ Maximum      │ Hardened │ Production ECR    │
│  Security     │ Hardened   │ Verified     │ Maximum  │ Secured registry  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
</code></pre>

<h3 id="configuration-management">Configuration Management</h3>
<pre class="highlight"><code class="language-bash"># config/environments/development.env
export BUILD_TYPE=debug
export CGO_ENABLED=1
export OPTIMIZATION_LEVEL=0
export PARALLEL_JOBS=4
export REGISTRY_URL=localhost:5000
export SECURITY_LEVEL=basic
export ENABLE_CACHE=true
export ENABLE_TESTS=true

# config/environments/production.env  
export BUILD_TYPE=release
export CGO_ENABLED=0
export OPTIMIZATION_LEVEL=3
export PARALLEL_JOBS=16
export REGISTRY_URL=123456789.dkr.ecr.us-east-1.amazonaws.com
export SECURITY_LEVEL=hardened
export ENABLE_CACHE=true
export ENABLE_TESTS=true
export ENABLE_SIGNING=true
export ENABLE_ATTESTATION=true

# config/environments/security.env
export BUILD_TYPE=hardened
export CGO_ENABLED=0
export OPTIMIZATION_LEVEL=3
export PARALLEL_JOBS=8
export REGISTRY_URL=secure-registry.company.com
export SECURITY_LEVEL=maximum
export ENABLE_CACHE=false
export ENABLE_TESTS=true
export ENABLE_SIGNING=true
export ENABLE_ATTESTATION=true
export ENABLE_PROVENANCE=true
export ENABLE_SBOM=true
</code></pre>

<h3 id="advanced-makefile-patterns">Advanced Makefile Patterns</h3>
<pre class="highlight"><code class="language-makefile"># Advanced configuration-driven Makefile

# Load environment-specific configuration
ENV ?= development
include config/environments/$(ENV).env

# Conditional compilation based on environment
ifeq ($(BUILD_TYPE),debug)
    BUILD_FLAGS += -gcflags=&quot;all=-N -l&quot;
    DOCKER_TARGET = debug
else ifeq ($(BUILD_TYPE),release)
    BUILD_FLAGS += -ldflags=&quot;-s -w&quot;
    DOCKER_TARGET = release
else ifeq ($(BUILD_TYPE),hardened)
    BUILD_FLAGS += -ldflags=&quot;-s -w&quot; -buildmode=pie
    DOCKER_TARGET = hardened
endif

# Security-level dependent targets
ifeq ($(SECURITY_LEVEL),maximum)
    REQUIRED_CHECKS = security-deps security-code security-secrets security-container
else ifeq ($(SECURITY_LEVEL),hardened)
    REQUIRED_CHECKS = security-deps security-code security-container
else ifeq ($(SECURITY_LEVEL),standard)
    REQUIRED_CHECKS = security-deps security-code
else
    REQUIRED_CHECKS = security-deps
endif

# Environment-specific build target
build-env: $(REQUIRED_CHECKS)
    @echo &quot;Building for $(ENV) environment with $(SECURITY_LEVEL) security&quot;
    $(BUILD_ENV) go build $(BUILD_FLAGS) -o build/$(TARGET)
ifeq ($(ENABLE_SIGNING),true)
    gpg --detach-sign --armor build/$(TARGET)
endif
ifeq ($(ENABLE_ATTESTATION),true)
    $(MAKE) security-provenance
endif

# Multi-architecture build
build-multiarch:
    @for arch in amd64 arm64; do \
        echo &quot;Building for $$arch...&quot;; \
        GOARCH=$$arch $(BUILD_ENV) go build $(BUILD_FLAGS) \
            -o build/$(TARGET)-$$arch; \
    done

# Cross-platform package creation
package-multiplatform: build-multiarch
    @for arch in amd64 arm64; do \
        echo &quot;Creating package for $$arch...&quot;; \
        PKG_ARCH=$$arch $(MAKE) rpm; \
    done

# Environment deployment
deploy-env:
    @case $(ENV) in \
        development) $(MAKE) deploy-dev ;; \
        testing) $(MAKE) deploy-test ;; \
        staging) $(MAKE) deploy-staging ;; \
        production) $(MAKE) deploy-prod ;; \
        *) echo &quot;Unknown environment: $(ENV)&quot; &amp;&amp; exit 1 ;; \
    esac

# Configuration validation
validate-config:
    @echo &quot;Validating configuration for $(ENV) environment...&quot;
    @test -n &quot;$(BUILD_TYPE)&quot; || (echo &quot;BUILD_TYPE not set&quot; &amp;&amp; exit 1)
    @test -n &quot;$(REGISTRY_URL)&quot; || (echo &quot;REGISTRY_URL not set&quot; &amp;&amp; exit 1)
    @test -n &quot;$(SECURITY_LEVEL)&quot; || (echo &quot;SECURITY_LEVEL not set&quot; &amp;&amp; exit 1)
    @echo &quot;✅ Configuration valid&quot;

.PHONY: build-env build-multiarch package-multiplatform deploy-env validate-config
</code></pre>

<h3 id="monitoring-and-observability">Monitoring and Observability</h3>
<pre class="highlight"><code class="language-makefile"># Observability targets

# Build metrics collection
metrics-build:
    @echo &quot;📊 Collecting build metrics...&quot;
    @start_time=$$(date +%s); \
    $(MAKE) all; \
    end_time=$$(date +%s); \
    build_duration=$$((end_time - start_time)); \
    echo &quot;Build completed in $$build_duration seconds&quot; | \
    tee build-metrics.txt

# Performance profiling
profile-build:
    @echo &quot;📈 Profiling build performance...&quot;
    time -v $(MAKE) all 2&gt;&amp;1 | tee build-profile.txt
    du -sh build/ &gt;&gt; build-profile.txt
    df -h &gt;&gt; build-profile.txt

# Health checks for built artifacts
health-check:
    @echo &quot;🏥 Running health checks...&quot;
    @for binary in build/*; do \
        if [ -f &quot;$$binary&quot; ] &amp;&amp; [ -x &quot;$$binary&quot; ]; then \
            echo &quot;Checking $$binary...&quot;; \
            file &quot;$$binary&quot;; \
            ldd &quot;$$binary&quot; 2&gt;/dev/null || echo &quot;Static binary&quot;; \
            &quot;$$binary&quot; --version 2&gt;/dev/null || echo &quot;No version info&quot;; \
        fi; \
    done

# Dependency analysis
analyze-deps:
    @echo &quot;🔍 Analyzing dependencies...&quot;
    go mod graph &gt; dependency-graph.txt
    go list -m -u all &gt; dependency-updates.txt
    go mod why -m all &gt; dependency-usage.txt

# Build artifact analysis
analyze-artifacts:
    @echo &quot;📦 Analyzing build artifacts...&quot;
    @for binary in build/*; do \
        if [ -f &quot;$$binary&quot; ]; then \
            echo &quot;=== $$binary ===&quot;; \
            ls -lh &quot;$$binary&quot;; \
            file &quot;$$binary&quot;; \
            nm &quot;$$binary&quot; | wc -l &amp;&amp; echo &quot; symbols&quot;; \
            strings &quot;$$binary&quot; | grep -E &quot;(version|build|git)&quot; || true; \
        fi; \
    done &gt; artifact-analysis.txt

# Documentation generation
docs-generate:
    @echo &quot;📚 Generating documentation...&quot;
    godoc -html &gt; docs/api-reference.html
    $(MAKE) -n all &gt; docs/build-commands.txt
    env | grep -E &quot;(BUILD|GO|DOCKER)&quot; &gt; docs/build-environment.txt

.PHONY: metrics-build profile-build health-check analyze-deps analyze-artifacts docs-generate
</code></pre>

<h3 id="integration-with-external-tools">Integration with External Tools</h3>
<pre class="highlight"><code class="language-makefile"># External tool integrations

# SonarQube integration
sonar-scan:
    @echo &quot;🔍 Running SonarQube analysis...&quot;
    sonar-scanner \
        -Dsonar.projectKey=securaa \
        -Dsonar.sources=. \
        -Dsonar.host.url=$(SONAR_URL) \
        -Dsonar.login=$(SONAR_TOKEN)

# Artifactory integration
artifactory-upload:
    @echo &quot;📤 Uploading to Artifactory...&quot;
    jfrog rt upload &quot;build/*&quot; securaa-binaries/ \
        --build-name=securaa \
        --build-number=$(BUILD_NUMBER)

# Slack notifications
notify-slack:
    @echo &quot;📢 Sending Slack notification...&quot;
    curl -X POST -H 'Content-type: application/json' \
        --data '{&quot;text&quot;:&quot;🚀 SECURAA build $(BUILD_VERSION) completed successfully&quot;}' \
        $(SLACK_WEBHOOK_URL)

# JIRA integration
jira-update:
    @echo &quot;🎫 Updating JIRA tickets...&quot;
    curl -X POST \
        -H &quot;Content-Type: application/json&quot; \
        -H &quot;Authorization: Bearer $(JIRA_TOKEN)&quot; \
        -d '{&quot;body&quot;:&quot;Build $(BUILD_VERSION) deployed to $(ENV)&quot;}' \
        &quot;$(JIRA_URL)/rest/api/3/issue/$(JIRA_ISSUE)/comment&quot;

# Git tag creation
tag-release:
    @echo &quot;🏷️  Creating release tag...&quot;
    git tag -a v$(BUILD_VERSION) -m &quot;Release version $(BUILD_VERSION)&quot;
    git push origin v$(BUILD_VERSION)

# Comprehensive release pipeline
release-complete: validate-config security-all build-env package-multiplatform
    $(MAKE) artifactory-upload
    $(MAKE) tag-release
    $(MAKE) notify-slack
    $(MAKE) jira-update
    @echo &quot;🎉 Release $(BUILD_VERSION) completed successfully!&quot;

.PHONY: sonar-scan artifactory-upload notify-slack jira-update tag-release release-complete
</code></pre>

<hr />
<h2 id="final-summary">Final Summary</h2>
<p>This comprehensive documentation now covers the entire SECURAA Make system with enhanced detail including:</p>
<h3 id="enhanced-features">Enhanced Features:</h3>
<ol>
<li><strong>Detailed System Architecture</strong> with ASCII diagrams showing component interactions</li>
<li><strong>Complete Build Flow Diagrams</strong> including Docker multi-stage builds and package creation</li>
<li><strong>Comprehensive CI/CD Integration</strong> with Jenkins pipelines and GitHub Actions</li>
<li><strong>Advanced Performance Optimization</strong> with metrics showing 74% build time reduction</li>
<li><strong>Enterprise Security Framework</strong> with supply chain protection and container hardening</li>
<li><strong>Environment-Specific Configurations</strong> from development to production</li>
<li><strong>Monitoring and Observability</strong> tools for build analytics and health checks</li>
<li><strong>External Tool Integrations</strong> for SonarQube, Artifactory, Slack, and JIRA</li>
</ol>
<h3 id="visual-documentation-includes">Visual Documentation Includes:</h3>
<ul>
<li><strong>System Architecture Diagrams</strong>: Complete platform overview with service interactions</li>
<li><strong>Build Process Flows</strong>: Detailed step-by-step visualization with parallel processing</li>
<li><strong>Security Framework</strong>: Multi-layered security approach with implementation details</li>
<li><strong>Performance Metrics</strong>: Build optimization results and resource requirements</li>
<li><strong>Data Flow Charts</strong>: Information processing through the cybersecurity platform</li>
</ul>
<p>The documentation serves as a complete reference for the SECURAA platform's build system, providing practical examples, best practices, and enterprise-grade configuration management for managing over 200 microservices across multiple deployment environments.</p>
    </main>

    <footer class="footer">
        <p>&copy; 2025 Securaa Security Platform. All rights reserved.</p>
        <p>Documentation generated on December 04, 2025</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#4f46e5',
                primaryTextColor: '#1f2937',
                primaryBorderColor: '#818cf8',
                lineColor: '#6b7280',
                secondaryColor: '#f3f4f6',
                tertiaryColor: '#e5e7eb',
                background: '#ffffff',
                mainBkg: '#f9fafb',
                secondBkg: '#f3f4f6',
                border1: '#e5e7eb',
                border2: '#d1d5db',
                fontFamily: 'Inter, sans-serif',
                fontSize: '14px',
                nodeBorder: '#4f46e5',
                clusterBkg: '#f0f4f8',
                clusterBorder: '#818cf8',
                edgeLabelBackground: '#ffffff'
            },
            flowchart: {
                htmlLabels: true,
                useMaxWidth: true,
                curve: 'basis',
                padding: 15,
                nodeSpacing: 50,
                rankSpacing: 50
            },
            sequence: {
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                useMaxWidth: true
            },
            er: {
                useMaxWidth: true,
                entityPadding: 15,
                fontSize: 12
            },
            class: {
                useMaxWidth: true,
                padding: 10
            },
            gantt: {
                useMaxWidth: true,
                barHeight: 20,
                barGap: 4,
                topPadding: 50,
                leftPadding: 75
            },
            pie: {
                useMaxWidth: true,
                textPosition: 0.5
            },
            mindmap: {
                useMaxWidth: true,
                padding: 10
            },
            securityLevel: 'loose',
            logLevel: 'error'
        });

        // Re-render mermaid diagrams after page load for better sizing
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.querySelectorAll('.mermaid').forEach(function(el) {
                    if (el.getAttribute('data-processed') !== 'true') {
                        mermaid.init(undefined, el);
                    }
                });
            }, 100);
        });
    </script>
</body>
</html>
