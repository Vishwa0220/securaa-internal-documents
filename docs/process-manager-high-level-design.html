<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Securaa Platform Documentation - Process Manager - High Level Design">
    <title>Process Manager - High Level Design - Securaa Documentation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>

:root {
    --primary-color: #4f46e5;
    --primary-dark: #3730a3;
    --primary-light: #818cf8;
    --secondary-color: #06b6d4;
    --accent-color: #f59e0b;
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
    --text-muted: #9ca3af;
    --bg-primary: #ffffff;
    --bg-secondary: #f9fafb;
    --bg-tertiary: #f3f4f6;
    --border-color: #e5e7eb;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    scroll-behavior: smooth;
    font-size: 16px;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.7;
    color: var(--text-primary);
    background-color: var(--bg-secondary);
}

/* Header */
.main-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 1rem 2rem;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: var(--shadow-lg);
}

.header-content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-logo {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -0.025em;
}

.header-logo span {
    color: var(--secondary-color);
}

/* Navigation */
.documentation-nav {
    background: var(--bg-primary);
    border-bottom: 1px solid var(--border-color);
    padding: 0.75rem 2rem;
    position: sticky;
    top: 60px;
    z-index: 999;
    box-shadow: var(--shadow-sm);
}

.nav-links {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    justify-content: center;
}

.nav-links a {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    transition: all 0.2s ease;
}

.nav-links a:hover {
    color: var(--primary-color);
    background: var(--bg-tertiary);
}

/* Main Content */
.main-content {
    max-width: 1000px;
    margin: 2rem auto;
    padding: 2.5rem;
    background: var(--bg-primary);
    border-radius: 1rem;
    box-shadow: var(--shadow-md);
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary);
    font-weight: 700;
    line-height: 1.3;
    margin-top: 2rem;
    margin-bottom: 1rem;
}

h1 {
    font-size: 2.5rem;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    padding-bottom: 0.75rem;
    border-bottom: 3px solid var(--primary-color);
    margin-top: 0;
}

h2 {
    font-size: 1.875rem;
    color: var(--primary-dark);
    border-bottom: 2px solid var(--border-color);
    padding-bottom: 0.5rem;
}

h3 {
    font-size: 1.5rem;
    color: var(--text-primary);
}

h4 {
    font-size: 1.25rem;
    color: var(--text-secondary);
}

h5 {
    font-size: 1.125rem;
}

h6 {
    font-size: 1rem;
    color: var(--text-muted);
}

p {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

/* Links */
a {
    color: var(--primary-color);
    text-decoration: none;
    transition: color 0.2s ease;
}

a:hover {
    color: var(--primary-dark);
    text-decoration: underline;
}

/* Lists */
ul, ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
}

li {
    margin-bottom: 0.5rem;
}

li > ul, li > ol {
    margin-top: 0.5rem;
    margin-bottom: 0;
}

/* Code Blocks */
pre {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 1.25rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    line-height: 1.6;
    box-shadow: var(--shadow-md);
}

code {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    font-size: 0.875em;
}

:not(pre) > code {
    background: var(--bg-tertiary);
    color: var(--primary-dark);
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
}

/* Tables */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.9rem;
    box-shadow: var(--shadow-sm);
    border-radius: 0.5rem;
    overflow: hidden;
}

thead {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
}

th {
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
}

td {
    padding: 0.875rem 1rem;
    border-bottom: 1px solid var(--border-color);
}

tr:nth-child(even) {
    background: var(--bg-secondary);
}

tr:hover {
    background: var(--bg-tertiary);
}

/* Blockquotes */
blockquote {
    border-left: 4px solid var(--primary-color);
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    background: var(--bg-secondary);
    border-radius: 0 0.5rem 0.5rem 0;
    font-style: italic;
    color: var(--text-secondary);
}

blockquote p:last-child {
    margin-bottom: 0;
}

/* Mermaid Diagrams - Enhanced Styling */
.mermaid {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 2rem 0;
    padding: 1.5rem;
    background: linear-gradient(135deg, #fafbfc 0%, #f0f4f8 100%);
    border-radius: 0.75rem;
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-sm);
    overflow-x: auto;
    overflow-y: visible;
    min-height: 200px;
}

.mermaid svg {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 0 auto;
}

/* Ensure diagrams scale properly */
.mermaid[data-processed="true"] {
    min-height: auto;
}

/* Diagram container for better control */
.diagram-container {
    width: 100%;
    overflow-x: auto;
    padding: 1rem 0;
}

/* HR Styling */
hr {
    border: none;
    border-top: 2px solid var(--border-color);
    margin: 2.5rem 0;
}

/* Table of Contents */
.toc {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: 0.5rem;
    margin-bottom: 2rem;
    border: 1px solid var(--border-color);
}

.toc-title {
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 1rem;
    font-size: 1.125rem;
}

.toc ul {
    list-style: none;
    padding-left: 0;
}

.toc li {
    margin-bottom: 0.5rem;
}

.toc a {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.toc a:hover {
    color: var(--primary-color);
}

/* Document Info Box */
.doc-info {
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    font-size: 0.875rem;
}

.doc-info strong {
    color: var(--primary-color);
}

/* Footer */
.footer {
    text-align: center;
    padding: 2rem;
    background: var(--bg-tertiary);
    color: var(--text-muted);
    font-size: 0.875rem;
    margin-top: 2rem;
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-tertiary);
}

::-webkit-scrollbar-thumb {
    background: var(--text-muted);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* Print Styles */
@media print {
    .main-header, .documentation-nav, .footer {
        display: none !important;
    }

    .main-content {
        max-width: none;
        margin: 0;
        padding: 20px;
        box-shadow: none;
        border-radius: 0;
    }

    body {
        background: white;
        font-size: 11pt;
    }

    h1 {
        font-size: 24pt;
        -webkit-text-fill-color: var(--primary-dark);
        page-break-after: avoid;
    }

    h2, h3, h4 {
        page-break-after: avoid;
    }

    pre {
        background: #f5f5f5 !important;
        color: #333 !important;
        border: 1px solid #ddd;
        page-break-inside: avoid;
        font-size: 9pt;
    }

    table {
        page-break-inside: avoid;
    }

    .mermaid {
        page-break-inside: avoid;
        background: white !important;
        border: 1px solid #ddd;
        max-width: 100% !important;
    }

    .mermaid svg {
        max-width: 100% !important;
        max-height: 700px !important;
    }

    a {
        color: var(--primary-dark) !important;
        text-decoration: none !important;
    }
}

/* Responsive Design */
@media (max-width: 768px) {
    .main-content {
        margin: 1rem;
        padding: 1.5rem;
        border-radius: 0.5rem;
    }

    h1 {
        font-size: 1.75rem;
    }

    h2 {
        font-size: 1.5rem;
    }

    .nav-links {
        gap: 0.75rem;
    }

    .nav-links a {
        font-size: 0.75rem;
        padding: 0.375rem 0.5rem;
    }

    pre {
        font-size: 0.8rem;
        padding: 1rem;
    }

    table {
        font-size: 0.8rem;
    }

    th, td {
        padding: 0.5rem;
    }
}

/* Animation for smooth transitions */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.main-content {
    animation: fadeIn 0.3s ease-out;
}

/* Index-specific styles */
.hero {
    text-align: center;
    padding: 3rem 0;
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border-radius: 1rem;
    margin-bottom: 3rem;
}

.hero h1 {
    font-size: 3rem;
    margin-bottom: 1rem;
    border: none;
    padding: 0;
}

.hero p {
    font-size: 1.25rem;
    color: var(--text-secondary);
    max-width: 600px;
    margin: 0 auto;
}

.doc-sections {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
}

.doc-card {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 0.75rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-sm);
}

.doc-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary-light);
}

.doc-card h3 {
    color: var(--primary-color);
    font-size: 1.25rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
}

.doc-card p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.doc-card .links {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.doc-card .links a {
    font-size: 0.875rem;
    padding: 0.5rem 1rem;
    background: var(--bg-secondary);
    border-radius: 0.375rem;
    transition: all 0.2s ease;
}

.doc-card .links a:hover {
    background: var(--primary-color);
    color: white;
    text-decoration: none;
}

.section-title {
    font-size: 1.75rem;
    color: var(--primary-dark);
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--border-color);
}

    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="header-logo">Securaa<span>Docs</span></div>
            <div class="header-meta">
                <span>Generated: December 04, 2025</span>
            </div>
        </div>
    </header>

    <nav class="documentation-nav">
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="securaa-platform-high-level-design.html">Platform</a>
            <a href="securaa-playbook-high-level-design.html">Playbook</a>
            <a href="securaa-siem-high-level-design.html">SIEM</a>
            <a href="securaa-user-high-level-design.html">User Service</a>
            <a href="securaa-custom-services-high-level-design.html">Custom Services</a>
            <a href="sia-service-high-level-design.html">SIA Service</a>
            <a href="securaa-ris-high-level-design.html">RIS</a>
        </div>
    </nav>

    <main class="main-content">
        <h1 id="high-level-design-high-level-design-zona_process_manager">High-Level Design (High Level Design) â€“ zona_process_manager</h1>
<hr />
<h2 id="1-system-architecture-overview">1. System Architecture Overview</h2>
<h3 id="purpose-objectives">Purpose &amp; Objectives</h3>
<ul>
<li><strong>zona_process_manager</strong> orchestrates and manages the lifecycle of microservices and integrations in the Securaa platform.</li>
<li>Automates deployment, scaling, and health management of services using Docker and MongoDB.</li>
<li>Dynamically configures integrations for multi-tenant environments.</li>
</ul>
<h3 id="architecture-pattern">Architecture Pattern</h3>
<ul>
<li><strong>Layered Modular Architecture</strong></li>
<li>Separation of concerns: main orchestration, configuration/state, service management, integration logic.</li>
<li>Microservices managed as Docker containers.</li>
</ul>
<h3 id="technology-stack">Technology Stack</h3>
<ul>
<li><strong>Language:</strong> Go</li>
<li><strong>Containerization:</strong> Docker</li>
<li><strong>Database:</strong> MongoDB</li>
<li><strong>Logging/Config:</strong> securaa_lib (shared library)</li>
<li><strong>Other:</strong> Makefile for build/run automation</li>
</ul>
<hr />
<h2 id="2-architecture-diagrams-mermaid">2. Architecture Diagrams (Mermaid)</h2>
<h3 id="system-architecture-diagram">System Architecture Diagram</h3>
<div class="mermaid">
flowchart TD
  A[main.go\nOrchestrator] --> B[common/\nGlobal State]
  A --> C[models/\nBusiness Logic & Integrations]
  A --> D[docker/\nService Management]
  C --> E[integrations.go]
  C --> F[models.go]
  D --> G[docker_functions.go]
  B --> H[globals.go]
  A --> I[securaa_lib\nExternal Libs]
  A --> J[MongoDB]
  D --> K[Docker Engine]
</div>

<h3 id="component-interaction-diagram">Component Interaction Diagram</h3>
<div class="mermaid">
sequenceDiagram
    participant User
    participant Main
    participant Common
    participant Docker
    participant Models
    participant MongoDB
    User->>Main: CLI command (start/stop/restart)
    Main->>Common: Load config, set global state
    Main->>Docker: Create/cleanup services
    Main->>Models: Fetch integrations, resolve ports
    Models->>MongoDB: Query tenant/integration data
    Docker-->>Main: Service status
    Models-->>Main: Integration data
    Main->>User: Status/result
</div>

<h3 id="data-flow-diagram">Data Flow Diagram</h3>
<div class="mermaid">
flowchart LR
    UserRequest[User Request]
    MainApp[main.go]
    Config[common/globals.go]
    DockerMgmt[docker/docker_functions.go]
    ModelsLogic[models/models.go & integrations.go]
    MongoDB[(MongoDB)]
    DockerEngine[(Docker Engine)]
    Response[Response]

    UserRequest --> MainApp
    MainApp --> Config
    MainApp --> DockerMgmt
    MainApp --> ModelsLogic
    ModelsLogic --> MongoDB
    DockerMgmt --> DockerEngine
    DockerMgmt --> ModelsLogic
    MainApp --> Response
</div>

<hr />
<h2 id="3-component-analysis">3. Component Analysis</h2>
<h3 id="major-modulescomponents">Major Modules/Components</h3>
<h4 id="1-maingo-orchestrator">1. main.go (Orchestrator)</h4>
<ul>
<li><strong>Purpose:</strong> Entry point, parses commands, coordinates deployment, restart, and cleanup.</li>
<li><strong>Responsibilities:</strong></li>
<li>Loads configuration</li>
<li>Initializes global state</li>
<li>Orchestrates Docker and integration logic</li>
<li>Handles patch-based restarts</li>
</ul>
<h4 id="2-common-global-state-utilities">2. common/ (Global State &amp; Utilities)</h4>
<ul>
<li><strong>Purpose:</strong> Shared state, configuration, and utility functions.</li>
<li><strong>Responsibilities:</strong></li>
<li>Holds service maps (system, core, batch, app)</li>
<li>Manages DB sessions and integration lists</li>
<li>Provides server role detection and feature toggles</li>
</ul>
<h4 id="3-docker-service-management">3. docker/ (Service Management)</h4>
<ul>
<li><strong>Purpose:</strong> Docker orchestration and lifecycle management.</li>
<li><strong>Responsibilities:</strong></li>
<li>Initializes service contexts</li>
<li>Verifies/creates Docker volumes</li>
<li>Creates/updates Docker services and replicas</li>
<li>Manages Zookeeper/Kafka for event streaming</li>
</ul>
<h4 id="4-models-business-logic-integrations">4. models/ (Business Logic &amp; Integrations)</h4>
<ul>
<li><strong>Purpose:</strong> Data models and integration logic.</li>
<li><strong>Responsibilities:</strong></li>
<li>Defines tenant, integration, and session structures</li>
<li>Fetches active integrations per tenant</li>
<li>Resolves ports and parameters for services</li>
</ul>
<h4 id="inter-component-relationships">Inter-Component Relationships</h4>
<ul>
<li><code>main.go</code> coordinates all modules</li>
<li><code>common/</code> provides shared state to all</li>
<li><code>docker/</code> and <code>models/</code> interact via service contexts and integration data</li>
<li>All modules use shared config and session objects</li>
</ul>
<hr />
<h2 id="4-external-integrations">4. External Integrations</h2>
<h3 id="third-party-services-apis">Third-Party Services &amp; APIs</h3>
<ul>
<li><strong>Docker Engine:</strong> Container orchestration</li>
<li><strong>MongoDB:</strong> Tenant/integration data storage</li>
<li><strong>securaa_lib:</strong> Logging, config, Docker, MongoDB, utilities</li>
</ul>
<h3 id="database-systems">Database Systems</h3>
<ul>
<li><strong>MongoDB:</strong> Used for storing tenant, integration, and system data</li>
</ul>
<h3 id="external-dependencies">External Dependencies</h3>
<ul>
<li><strong>Go Modules:</strong> Dependency management</li>
<li><strong>Makefile:</strong> Build/run automation</li>
</ul>
<hr />
<h2 id="5-high-level-data-flow">5. High-Level Data Flow</h2>
<h3 id="user-request-processing-flow">User Request Processing Flow</h3>
<ol>
<li>User issues a CLI command (<code>start</code>, <code>stop</code>, <code>restart</code>).</li>
<li><code>main.go</code> parses the command and loads configuration.</li>
<li>Global state is initialized in <code>common/</code>.</li>
<li>Docker services are created/cleaned up via <code>docker/</code>.</li>
<li>Integrations are fetched and configured via <code>models/</code>.</li>
<li>MongoDB is queried for tenant/integration data.</li>
<li>Services are deployed as Docker containers.</li>
<li>Status/result is returned to the user.</li>
</ol>
<h3 id="business-logic-execution-flow">Business Logic Execution Flow</h3>
<ul>
<li>Integrations are dynamically resolved per tenant.</li>
<li>Service contexts are updated based on integration and config data.</li>
<li>Docker services are orchestrated for each required component.</li>
</ul>
<h3 id="response-generation-flow">Response Generation Flow</h3>
<ul>
<li>Service status and integration results are aggregated in <code>main.go</code>.</li>
<li>Final status/result is output to the user (CLI or API).</li>
</ul>
<hr />
<h2 id="mermaid-diagrams">Mermaid Diagrams</h2>
<ul>
<li>See above for architecture, component interaction, and data flow diagrams.</li>
</ul>
<hr />
<h2 id="summary">Summary</h2>
<p>This HLD provides a comprehensive overview of the zona_process_manager system, its architecture, major components, external integrations, and high-level data flows. The modular, layered design enables extensibility and robust orchestration of microservices and integrations in a multi-tenant environment.</p>
    </main>

    <footer class="footer">
        <p>&copy; 2025 Securaa Security Platform. All rights reserved.</p>
        <p>Documentation generated on December 04, 2025</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#4f46e5',
                primaryTextColor: '#1f2937',
                primaryBorderColor: '#818cf8',
                lineColor: '#6b7280',
                secondaryColor: '#f3f4f6',
                tertiaryColor: '#e5e7eb',
                background: '#ffffff',
                mainBkg: '#f9fafb',
                secondBkg: '#f3f4f6',
                border1: '#e5e7eb',
                border2: '#d1d5db',
                fontFamily: 'Inter, sans-serif',
                fontSize: '14px',
                nodeBorder: '#4f46e5',
                clusterBkg: '#f0f4f8',
                clusterBorder: '#818cf8',
                edgeLabelBackground: '#ffffff'
            },
            flowchart: {
                htmlLabels: true,
                useMaxWidth: true,
                curve: 'basis',
                padding: 15,
                nodeSpacing: 50,
                rankSpacing: 50
            },
            sequence: {
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                useMaxWidth: true
            },
            er: {
                useMaxWidth: true,
                entityPadding: 15,
                fontSize: 12
            },
            class: {
                useMaxWidth: true,
                padding: 10
            },
            gantt: {
                useMaxWidth: true,
                barHeight: 20,
                barGap: 4,
                topPadding: 50,
                leftPadding: 75
            },
            pie: {
                useMaxWidth: true,
                textPosition: 0.5
            },
            mindmap: {
                useMaxWidth: true,
                padding: 10
            },
            securityLevel: 'loose',
            logLevel: 'error'
        });

        // Re-render mermaid diagrams after page load for better sizing
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.querySelectorAll('.mermaid').forEach(function(el) {
                    if (el.getAttribute('data-processed') !== 'true') {
                        mermaid.init(undefined, el);
                    }
                });
            }, 100);
        });
    </script>
</body>
</html>
