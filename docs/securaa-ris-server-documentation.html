<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Securaa Platform Documentation - Securaa RIS Server Documentation">
    <title>Securaa RIS Server Documentation - Securaa Documentation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>

:root {
    --primary-color: #4f46e5;
    --primary-dark: #3730a3;
    --primary-light: #818cf8;
    --secondary-color: #06b6d4;
    --accent-color: #f59e0b;
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
    --text-muted: #9ca3af;
    --bg-primary: #ffffff;
    --bg-secondary: #f9fafb;
    --bg-tertiary: #f3f4f6;
    --border-color: #e5e7eb;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    scroll-behavior: smooth;
    font-size: 16px;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.7;
    color: var(--text-primary);
    background-color: var(--bg-secondary);
}

/* Header */
.main-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 1rem 2rem;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: var(--shadow-lg);
}

.header-content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-logo {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -0.025em;
}

.header-logo span {
    color: var(--secondary-color);
}

/* Navigation */
.documentation-nav {
    background: var(--bg-primary);
    border-bottom: 1px solid var(--border-color);
    padding: 0.75rem 2rem;
    position: sticky;
    top: 60px;
    z-index: 999;
    box-shadow: var(--shadow-sm);
}

.nav-links {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    justify-content: center;
}

.nav-links a {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    transition: all 0.2s ease;
}

.nav-links a:hover {
    color: var(--primary-color);
    background: var(--bg-tertiary);
}

/* Main Content */
.main-content {
    max-width: 1000px;
    margin: 2rem auto;
    padding: 2.5rem;
    background: var(--bg-primary);
    border-radius: 1rem;
    box-shadow: var(--shadow-md);
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary);
    font-weight: 700;
    line-height: 1.3;
    margin-top: 2rem;
    margin-bottom: 1rem;
}

h1 {
    font-size: 2.5rem;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    padding-bottom: 0.75rem;
    border-bottom: 3px solid var(--primary-color);
    margin-top: 0;
}

h2 {
    font-size: 1.875rem;
    color: var(--primary-dark);
    border-bottom: 2px solid var(--border-color);
    padding-bottom: 0.5rem;
}

h3 {
    font-size: 1.5rem;
    color: var(--text-primary);
}

h4 {
    font-size: 1.25rem;
    color: var(--text-secondary);
}

h5 {
    font-size: 1.125rem;
}

h6 {
    font-size: 1rem;
    color: var(--text-muted);
}

p {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

/* Links */
a {
    color: var(--primary-color);
    text-decoration: none;
    transition: color 0.2s ease;
}

a:hover {
    color: var(--primary-dark);
    text-decoration: underline;
}

/* Lists */
ul, ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
}

li {
    margin-bottom: 0.5rem;
}

li > ul, li > ol {
    margin-top: 0.5rem;
    margin-bottom: 0;
}

/* Code Blocks */
pre {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 1.25rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    line-height: 1.6;
    box-shadow: var(--shadow-md);
}

code {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    font-size: 0.875em;
}

:not(pre) > code {
    background: var(--bg-tertiary);
    color: var(--primary-dark);
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
}

/* Tables */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.9rem;
    box-shadow: var(--shadow-sm);
    border-radius: 0.5rem;
    overflow: hidden;
}

thead {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
}

th {
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
}

td {
    padding: 0.875rem 1rem;
    border-bottom: 1px solid var(--border-color);
}

tr:nth-child(even) {
    background: var(--bg-secondary);
}

tr:hover {
    background: var(--bg-tertiary);
}

/* Blockquotes */
blockquote {
    border-left: 4px solid var(--primary-color);
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    background: var(--bg-secondary);
    border-radius: 0 0.5rem 0.5rem 0;
    font-style: italic;
    color: var(--text-secondary);
}

blockquote p:last-child {
    margin-bottom: 0;
}

/* Mermaid Diagrams - Enhanced Styling */
.mermaid {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 2rem 0;
    padding: 1.5rem;
    background: linear-gradient(135deg, #fafbfc 0%, #f0f4f8 100%);
    border-radius: 0.75rem;
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-sm);
    overflow-x: auto;
    overflow-y: visible;
    min-height: 200px;
}

.mermaid svg {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 0 auto;
}

/* Ensure diagrams scale properly */
.mermaid[data-processed="true"] {
    min-height: auto;
}

/* Diagram container for better control */
.diagram-container {
    width: 100%;
    overflow-x: auto;
    padding: 1rem 0;
}

/* HR Styling */
hr {
    border: none;
    border-top: 2px solid var(--border-color);
    margin: 2.5rem 0;
}

/* Table of Contents */
.toc {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: 0.5rem;
    margin-bottom: 2rem;
    border: 1px solid var(--border-color);
}

.toc-title {
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 1rem;
    font-size: 1.125rem;
}

.toc ul {
    list-style: none;
    padding-left: 0;
}

.toc li {
    margin-bottom: 0.5rem;
}

.toc a {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.toc a:hover {
    color: var(--primary-color);
}

/* Document Info Box */
.doc-info {
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    font-size: 0.875rem;
}

.doc-info strong {
    color: var(--primary-color);
}

/* Footer */
.footer {
    text-align: center;
    padding: 2rem;
    background: var(--bg-tertiary);
    color: var(--text-muted);
    font-size: 0.875rem;
    margin-top: 2rem;
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-tertiary);
}

::-webkit-scrollbar-thumb {
    background: var(--text-muted);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* Print Styles */
@media print {
    .main-header, .documentation-nav, .footer {
        display: none !important;
    }

    .main-content {
        max-width: none;
        margin: 0;
        padding: 20px;
        box-shadow: none;
        border-radius: 0;
    }

    body {
        background: white;
        font-size: 11pt;
    }

    h1 {
        font-size: 24pt;
        -webkit-text-fill-color: var(--primary-dark);
        page-break-after: avoid;
    }

    h2, h3, h4 {
        page-break-after: avoid;
    }

    pre {
        background: #f5f5f5 !important;
        color: #333 !important;
        border: 1px solid #ddd;
        page-break-inside: avoid;
        font-size: 9pt;
    }

    table {
        page-break-inside: avoid;
    }

    .mermaid {
        page-break-inside: avoid;
        background: white !important;
        border: 1px solid #ddd;
        max-width: 100% !important;
    }

    .mermaid svg {
        max-width: 100% !important;
        max-height: 700px !important;
    }

    a {
        color: var(--primary-dark) !important;
        text-decoration: none !important;
    }
}

/* Responsive Design */
@media (max-width: 768px) {
    .main-content {
        margin: 1rem;
        padding: 1.5rem;
        border-radius: 0.5rem;
    }

    h1 {
        font-size: 1.75rem;
    }

    h2 {
        font-size: 1.5rem;
    }

    .nav-links {
        gap: 0.75rem;
    }

    .nav-links a {
        font-size: 0.75rem;
        padding: 0.375rem 0.5rem;
    }

    pre {
        font-size: 0.8rem;
        padding: 1rem;
    }

    table {
        font-size: 0.8rem;
    }

    th, td {
        padding: 0.5rem;
    }
}

/* Animation for smooth transitions */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.main-content {
    animation: fadeIn 0.3s ease-out;
}

/* Index-specific styles */
.hero {
    text-align: center;
    padding: 3rem 0;
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border-radius: 1rem;
    margin-bottom: 3rem;
}

.hero h1 {
    font-size: 3rem;
    margin-bottom: 1rem;
    border: none;
    padding: 0;
}

.hero p {
    font-size: 1.25rem;
    color: var(--text-secondary);
    max-width: 600px;
    margin: 0 auto;
}

.doc-sections {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
}

.doc-card {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 0.75rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-sm);
}

.doc-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary-light);
}

.doc-card h3 {
    color: var(--primary-color);
    font-size: 1.25rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
}

.doc-card p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.doc-card .links {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.doc-card .links a {
    font-size: 0.875rem;
    padding: 0.5rem 1rem;
    background: var(--bg-secondary);
    border-radius: 0.375rem;
    transition: all 0.2s ease;
}

.doc-card .links a:hover {
    background: var(--primary-color);
    color: white;
    text-decoration: none;
}

.section-title {
    font-size: 1.75rem;
    color: var(--primary-dark);
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--border-color);
}

    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="header-logo">Securaa<span>Docs</span></div>
            <div class="header-meta">
                <span>Generated: December 04, 2025</span>
            </div>
        </div>
    </header>

    <nav class="documentation-nav">
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="securaa-platform-high-level-design.html">Platform</a>
            <a href="securaa-playbook-high-level-design.html">Playbook</a>
            <a href="securaa-siem-high-level-design.html">SIEM</a>
            <a href="securaa-user-high-level-design.html">User Service</a>
            <a href="securaa-custom-services-high-level-design.html">Custom Services</a>
            <a href="sia-service-high-level-design.html">SIA Service</a>
            <a href="securaa-ris-high-level-design.html">RIS</a>
        </div>
    </nav>

    <main class="main-content">
        <h1 id="ris-server-documentation">RIS Server Documentation<a class="headerlink" href="#ris-server-documentation" title="Permanent link">&para;</a></h1>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#installation--setup">Installation &amp; Setup</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#api-reference">API Reference</a></li>
<li><a href="#client-management">Client Management</a></li>
<li><a href="#task-orchestration">Task Orchestration</a></li>
<li><a href="#multi-tenant-architecture">Multi-Tenant Architecture</a></li>
<li><a href="#security-framework">Security Framework</a></li>
<li><a href="#database-management">Database Management</a></li>
<li><a href="#monitoring--observability">Monitoring &amp; Observability</a></li>
<li><a href="#deployment-strategies">Deployment Strategies</a></li>
<li><a href="#performance--scaling">Performance &amp; Scaling</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#administration-guide">Administration Guide</a></li>
</ol>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The RIS (Remote Integrated Services) Server is the central command and control hub for the distributed RIS ecosystem. It provides unified management, orchestration, and monitoring capabilities for multiple remote RIS clients across different environments. The server implements a sophisticated hub-and-spoke architecture with enterprise-grade security, scalability, and reliability features.</p>
<h3 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Centralized Management</strong>: Unified control plane for all remote RIS clients</li>
<li><strong>Real-time Communication</strong>: WebSocket-based persistent connections with clients</li>
<li><strong>Multi-Tenant Support</strong>: Complete tenant isolation with secure data separation</li>
<li><strong>Task Orchestration</strong>: Intelligent task routing and execution across clients</li>
<li><strong>High Availability</strong>: Clustered deployment with automatic failover</li>
<li><strong>Security</strong>: End-to-end encryption, authentication, and comprehensive audit logging</li>
<li><strong>Scalability</strong>: Horizontal scaling supporting 1000+ concurrent client connections</li>
<li><strong>Monitoring</strong>: Real-time monitoring, metrics collection, and alerting</li>
</ul>
<h3 id="system-requirements">System Requirements<a class="headerlink" href="#system-requirements" title="Permanent link">&para;</a></h3>
<h4 id="minimum-requirements">Minimum Requirements<a class="headerlink" href="#minimum-requirements" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Operating System</strong>: Linux (Ubuntu 20.04+, CentOS 8+, RHEL 8+)</li>
<li><strong>CPU</strong>: 2 vCores</li>
<li><strong>Memory</strong>: 4 GB RAM</li>
<li><strong>Storage</strong>: 20 GB SSD</li>
<li><strong>Network</strong>: High-speed internet with static IP</li>
</ul>
<h4 id="recommended-requirements">Recommended Requirements<a class="headerlink" href="#recommended-requirements" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Operating System</strong>: Linux (Ubuntu 22.04+, CentOS 9+, RHEL 9+)</li>
<li><strong>CPU</strong>: 8 vCores</li>
<li><strong>Memory</strong>: 16 GB RAM</li>
<li><strong>Storage</strong>: 100 GB SSD NVMe</li>
<li><strong>Network</strong>: Dedicated network with load balancer</li>
</ul>
<h4 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>MongoDB</strong>: Version 6.0+ (Primary database)</li>
<li><strong>Redis</strong>: Version 7.0+ (Caching and session management)</li>
<li><strong>Docker</strong>: Version 20.10+ (Containerization)</li>
<li><strong>Go Runtime</strong>: Version 1.19+ (for development)</li>
<li><strong>TLS Certificates</strong>: Valid certificates for HTTPS/WSS</li>
</ul>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h2>
<h3 id="high-level-architecture">High-Level Architecture<a class="headerlink" href="#high-level-architecture" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Load Balancer Tier"
        LB[Load Balancer<br/>NGINX/HAProxy]
        WAF[Web Application Firewall]
    end

    subgraph "RIS Server Cluster"
        RS1[RIS Server 1<br/>Primary]
        RS2[RIS Server 2<br/>Secondary]
        RS3[RIS Server 3<br/>Backup]
    end

    subgraph "Data Layer"
        subgraph "MongoDB Cluster"
            MDB1[(MongoDB Primary)]
            MDB2[(MongoDB Secondary)]
            MDB3[(MongoDB Arbiter)]
        end

        subgraph "Cache Layer"
            REDIS1[Redis Master]
            REDIS2[Redis Replica]
        end
    end

    subgraph "Monitoring Stack"
        PROM[Prometheus]
        GRAF[Grafana]
        ALERT[AlertManager]
        ELK[ELK Stack]
    end

    subgraph "RIS Clients"
        RC1[RIS Client 1]
        RC2[RIS Client 2]
        RCN[RIS Client N]
    end

    subgraph "External Systems"
        EXT[External APIs]
        LDAP[LDAP/AD]
        SMTP[SMTP Server]
    end

    %% Traffic flow
    WAF --> LB
    LB --> RS1
    LB --> RS2
    LB --> RS3

    %% Database connections
    RS1 --> MDB1
    RS2 --> MDB1
    RS3 --> MDB1
    MDB1 -.-> MDB2
    MDB2 -.-> MDB3

    %% Cache connections
    RS1 --> REDIS1
    RS2 --> REDIS1
    RS3 --> REDIS1
    REDIS1 -.-> REDIS2

    %% WebSocket connections
    RS1 -.->|WSS| RC1
    RS2 -.->|WSS| RC2
    RS3 -.->|WSS| RCN

    %% Monitoring
    RS1 --> PROM
    RS2 --> PROM
    RS3 --> PROM
    PROM --> GRAF
    PROM --> ALERT

    %% External integrations
    RS1 -.-> EXT
    RS1 -.-> LDAP
    RS1 -.-> SMTP

    style LB fill:#e1bee7
    style RS1 fill:#e8f5e8
    style MDB1 fill:#fff9c4
    style REDIS1 fill:#ffcdd2
    style RC1 fill:#e3f2fd
</div>

<h3 id="component-architecture">Component Architecture<a class="headerlink" href="#component-architecture" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "RIS Server Core"
        subgraph "API Layer"
            REST[REST API Gateway]
            WS[WebSocket Gateway]
            MW[Middleware Stack]
        end

        subgraph "Business Logic"
            RC[RIS Controller]
            TC[Tenant Controller]
            ORCH[Task Orchestrator]
            CM[Client Manager]
        end

        subgraph "Data Access"
            MDA[MongoDB Adapter]
            RDA[Redis Adapter]
            CACHE[Cache Manager]
        end

        subgraph "Infrastructure"
            AUTH[Auth Service]
            LOG[Logging Service]
            METRICS[Metrics Service]
            CONFIG[Config Manager]
        end
    end

    REST --> MW
    WS --> MW
    MW --> RC
    MW --> TC
    RC --> ORCH
    RC --> CM

    ORCH --> MDA
    CM --> MDA
    ORCH --> RDA
    CM --> CACHE

    MW --> AUTH
    RC --> LOG
    ORCH --> METRICS

    style REST fill:#e8f5e8
    style WS fill:#fff3e0
    style ORCH fill:#e1bee7
    style AUTH fill:#ffcdd2
</div>

<h3 id="detailed-component-design">Detailed Component Design<a class="headerlink" href="#detailed-component-design" title="Permanent link">&para;</a></h3>
<h4 id="1-api-gateway-layer">1. API Gateway Layer<a class="headerlink" href="#1-api-gateway-layer" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>REST API Gateway</strong>: HTTP/HTTPS endpoint management</li>
<li><strong>WebSocket Gateway</strong>: Real-time client communication</li>
<li><strong>Middleware Stack</strong>: Authentication, authorization, logging, rate limiting</li>
<li><strong>Request Router</strong>: Intelligent request routing and load balancing</li>
</ul>
<h4 id="2-business-logic-layer">2. Business Logic Layer<a class="headerlink" href="#2-business-logic-layer" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>RIS Controller</strong>: Client lifecycle and status management</li>
<li><strong>Tenant Controller</strong>: Multi-tenant data and operation isolation</li>
<li><strong>Task Orchestrator</strong>: Task routing, execution, and monitoring</li>
<li><strong>Client Manager</strong>: Connection management and health monitoring</li>
</ul>
<h4 id="3-data-management-layer">3. Data Management Layer<a class="headerlink" href="#3-data-management-layer" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>MongoDB Integration</strong>: Primary data persistence</li>
<li><strong>Redis Integration</strong>: Caching and session management</li>
<li><strong>Cache Manager</strong>: Intelligent caching strategies</li>
<li><strong>Data Access Objects</strong>: Abstracted data access patterns</li>
</ul>
<h2 id="installation-setup">Installation &amp; Setup<a class="headerlink" href="#installation-setup" title="Permanent link">&para;</a></h2>
<h3 id="docker-deployment-recommended">Docker Deployment (Recommended)<a class="headerlink" href="#docker-deployment-recommended" title="Permanent link">&para;</a></h3>
<h4 id="docker-compose-configuration">Docker Compose Configuration<a class="headerlink" href="#docker-compose-configuration" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-yaml">version: '3.8'

services:
  ris-server:
    image: securaa/ris-server:latest
    container_name: ris-server
    restart: unless-stopped
    ports:
      - &quot;8057:8057&quot;
      - &quot;9090:9090&quot;  # Metrics
    environment:
      - RIS_ENV=production
      - MONGODB_URI=mongodb://mongo1:27017,mongo2:27017,mongo3:27017/ris?replicaSet=rs0
      - REDIS_URI=redis://redis-master:6379
      - TLS_CERT_FILE=/app/certs/server.crt
      - TLS_KEY_FILE=/app/certs/server.key
    volumes:
      - ./config:/app/config
      - ./certs:/app/certs
      - ./logs:/app/logs
    networks:
      - ris-network
    depends_on:
      - mongodb
      - redis
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;https://localhost:8057/health&quot;]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

  mongodb:
    image: mongo:6.0
    container_name: ris-mongo
    restart: unless-stopped
    ports:
      - &quot;27017:27017&quot;
    environment:
      - MONGO_INITDB_ROOT_USERNAME=admin
      - MONGO_INITDB_ROOT_PASSWORD=secure-password
      - MONGO_INITDB_DATABASE=ris
    volumes:
      - mongodb_data:/data/db
      - ./mongo-init:/docker-entrypoint-initdb.d
    networks:
      - ris-network
    command: mongod --replSet rs0 --bind_ip_all

  redis:
    image: redis:7.0-alpine
    container_name: ris-redis
    restart: unless-stopped
    ports:
      - &quot;6379:6379&quot;
    environment:
      - REDIS_PASSWORD=secure-redis-password
    volumes:
      - redis_data:/data
      - ./redis.conf:/usr/local/etc/redis/redis.conf
    networks:
      - ris-network
    command: redis-server /usr/local/etc/redis/redis.conf

  nginx:
    image: nginx:alpine
    container_name: ris-nginx
    restart: unless-stopped
    ports:
      - &quot;80:80&quot;
      - &quot;443:443&quot;
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./certs:/etc/nginx/certs
    networks:
      - ris-network
    depends_on:
      - ris-server

networks:
  ris-network:
    driver: bridge

volumes:
  mongodb_data:
  redis_data:
</code></pre>

<h4 id="production-environment-setup">Production Environment Setup<a class="headerlink" href="#production-environment-setup" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-bash"># Create directory structure
mkdir -p ris-server/{config,certs,logs,data}
cd ris-server

# Download configuration templates
curl -O https://raw.githubusercontent.com/securaa/ris-server/main/deployments/docker/docker-compose.yml
curl -O https://raw.githubusercontent.com/securaa/ris-server/main/deployments/docker/nginx.conf

# Generate TLS certificates
openssl req -x509 -newkey rsa:4096 -keyout certs/server.key -out certs/server.crt -days 365 -nodes

# Initialize MongoDB replica set
docker-compose exec mongodb mongo --eval &quot;rs.initiate()&quot;

# Start services
docker-compose up -d

# Verify installation
curl -k https://localhost:8057/health
</code></pre>

<h3 id="kubernetes-deployment">Kubernetes Deployment<a class="headerlink" href="#kubernetes-deployment" title="Permanent link">&para;</a></h3>
<h4 id="namespace-and-configmap">Namespace and ConfigMap<a class="headerlink" href="#namespace-and-configmap" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-yaml"># namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: ris-system
  labels:
    name: ris-system

---
# configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: ris-server-config
  namespace: ris-system
data:
  config.json: |
    {
      &quot;server&quot;: {
        &quot;host&quot;: &quot;0.0.0.0&quot;,
        &quot;port&quot;: 8057,
        &quot;tls_enabled&quot;: true,
        &quot;cert_file&quot;: &quot;/app/certs/tls.crt&quot;,
        &quot;key_file&quot;: &quot;/app/certs/tls.key&quot;
      },
      &quot;database&quot;: {
        &quot;mongodb_uri&quot;: &quot;mongodb://ris-mongodb:27017/ris&quot;,
        &quot;redis_uri&quot;: &quot;redis://ris-redis:6379&quot;
      },
      &quot;logging&quot;: {
        &quot;level&quot;: &quot;info&quot;,
        &quot;format&quot;: &quot;json&quot;
      }
    }
</code></pre>

<h4 id="deployment-and-service">Deployment and Service<a class="headerlink" href="#deployment-and-service" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-yaml"># deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ris-server
  namespace: ris-system
  labels:
    app: ris-server
spec:
  replicas: 3
  selector:
    matchLabels:
      app: ris-server
  template:
    metadata:
      labels:
        app: ris-server
    spec:
      containers:
      - name: ris-server
        image: securaa/ris-server:latest
        ports:
        - containerPort: 8057
          name: https
        - containerPort: 9090
          name: metrics
        env:
        - name: CONFIG_PATH
          value: &quot;/app/config/config.json&quot;
        volumeMounts:
        - name: config
          mountPath: /app/config
        - name: certs
          mountPath: /app/certs
        livenessProbe:
          httpGet:
            path: /health
            port: 8057
            scheme: HTTPS
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8057
            scheme: HTTPS
          initialDelaySeconds: 5
          periodSeconds: 5
        resources:
          requests:
            memory: &quot;512Mi&quot;
            cpu: &quot;250m&quot;
          limits:
            memory: &quot;2Gi&quot;
            cpu: &quot;1000m&quot;
      volumes:
      - name: config
        configMap:
          name: ris-server-config
      - name: certs
        secret:
          secretName: ris-server-tls

---
# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: ris-server-service
  namespace: ris-system
  labels:
    app: ris-server
spec:
  selector:
    app: ris-server
  ports:
  - name: https
    port: 8057
    targetPort: 8057
  - name: metrics
    port: 9090
    targetPort: 9090
  type: ClusterIP

---
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ris-server-ingress
  namespace: ris-system
  annotations:
    nginx.ingress.kubernetes.io/ssl-passthrough: &quot;true&quot;
    nginx.ingress.kubernetes.io/backend-protocol: &quot;HTTPS&quot;
spec:
  tls:
  - hosts:
    - ris-server.example.com
    secretName: ris-server-tls
  rules:
  - host: ris-server.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: ris-server-service
            port:
              number: 8057
</code></pre>

<h3 id="binary-installation">Binary Installation<a class="headerlink" href="#binary-installation" title="Permanent link">&para;</a></h3>
<h4 id="system-setup">System Setup<a class="headerlink" href="#system-setup" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-bash"># Create system user
sudo useradd -r -s /bin/false ris-server
sudo mkdir -p /opt/ris-server/{bin,config,logs,data}
sudo mkdir -p /etc/ris-server
sudo chown -R ris-server:ris-server /opt/ris-server /etc/ris-server

# Download and install binary
wget https://github.com/securaa/ris-server/releases/latest/download/ris-server-linux-amd64.tar.gz
tar -xzf ris-server-linux-amd64.tar.gz
sudo mv ris-server /opt/ris-server/bin/
sudo chmod +x /opt/ris-server/bin/ris-server
</code></pre>

<h4 id="systemd-service">Systemd Service<a class="headerlink" href="#systemd-service" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-bash">sudo tee /etc/systemd/system/ris-server.service &lt;&lt; EOF
[Unit]
Description=RIS Server
After=network.target mongodb.service redis.service
Wants=network.target
Requires=mongodb.service redis.service

[Service]
Type=simple
User=ris-server
Group=ris-server
ExecStart=/opt/ris-server/bin/ris-server
Restart=always
RestartSec=10
Environment=CONFIG_PATH=/etc/ris-server/config.json
WorkingDirectory=/opt/ris-server
StandardOutput=journal
StandardError=journal
SyslogIdentifier=ris-server

# Security settings
NoNewPrivileges=yes
ProtectSystem=strict
ProtectHome=yes
ReadWritePaths=/opt/ris-server/logs /opt/ris-server/data

[Install]
WantedBy=multi-user.target
EOF

# Enable and start service
sudo systemctl daemon-reload
sudo systemctl enable ris-server
sudo systemctl start ris-server
sudo systemctl status ris-server
</code></pre>

<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<h3 id="master-configuration-file">Master Configuration File<a class="headerlink" href="#master-configuration-file" title="Permanent link">&para;</a></h3>
<pre class="highlight"><code class="language-json">{
  &quot;server&quot;: {
    &quot;host&quot;: &quot;0.0.0.0&quot;,
    &quot;port&quot;: 8057,
    &quot;tls&quot;: {
      &quot;enabled&quot;: true,
      &quot;cert_file&quot;: &quot;/app/certs/server.crt&quot;,
      &quot;key_file&quot;: &quot;/app/certs/server.key&quot;,
      &quot;ca_file&quot;: &quot;/app/certs/ca.crt&quot;,
      &quot;min_version&quot;: &quot;1.2&quot;,
      &quot;max_version&quot;: &quot;1.3&quot;,
      &quot;cipher_suites&quot;: [
        &quot;TLS_AES_256_GCM_SHA384&quot;,
        &quot;TLS_CHACHA20_POLY1305_SHA256&quot;,
        &quot;TLS_AES_128_GCM_SHA256&quot;
      ],
      &quot;client_auth&quot;: &quot;require&quot;
    },
    &quot;timeouts&quot;: {
      &quot;read&quot;: &quot;30s&quot;,
      &quot;write&quot;: &quot;30s&quot;,
      &quot;idle&quot;: &quot;120s&quot;
    },
    &quot;cors&quot;: {
      &quot;enabled&quot;: true,
      &quot;allowed_origins&quot;: [&quot;https://admin.example.com&quot;],
      &quot;allowed_methods&quot;: [&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;],
      &quot;allowed_headers&quot;: [&quot;Authorization&quot;, &quot;Content-Type&quot;]
    }
  },
  &quot;database&quot;: {
    &quot;mongodb&quot;: {
      &quot;uri&quot;: &quot;mongodb://username:password@localhost:27017/ris?replicaSet=rs0&quot;,
      &quot;database&quot;: &quot;ris&quot;,
      &quot;max_pool_size&quot;: 100,
      &quot;min_pool_size&quot;: 10,
      &quot;max_idle_time&quot;: &quot;10m&quot;,
      &quot;connection_timeout&quot;: &quot;10s&quot;,
      &quot;socket_timeout&quot;: &quot;30s&quot;,
      &quot;server_selection_timeout&quot;: &quot;5s&quot;
    },
    &quot;redis&quot;: {
      &quot;uri&quot;: &quot;redis://localhost:6379&quot;,
      &quot;password&quot;: &quot;secure-password&quot;,
      &quot;database&quot;: 0,
      &quot;max_retries&quot;: 3,
      &quot;pool_size&quot;: 50,
      &quot;min_idle_conns&quot;: 10,
      &quot;idle_timeout&quot;: &quot;5m&quot;,
      &quot;dial_timeout&quot;: &quot;5s&quot;,
      &quot;read_timeout&quot;: &quot;3s&quot;,
      &quot;write_timeout&quot;: &quot;3s&quot;
    }
  },
  &quot;authentication&quot;: {
    &quot;jwt&quot;: {
      &quot;secret&quot;: &quot;your-jwt-secret-key&quot;,
      &quot;expiry&quot;: &quot;24h&quot;,
      &quot;refresh_expiry&quot;: &quot;168h&quot;,
      &quot;issuer&quot;: &quot;ris-server&quot;,
      &quot;algorithm&quot;: &quot;HS256&quot;
    },
    &quot;session&quot;: {
      &quot;duration&quot;: &quot;8h&quot;,
      &quot;renewal_threshold&quot;: &quot;1h&quot;,
      &quot;max_concurrent&quot;: 5
    },
    &quot;ldap&quot;: {
      &quot;enabled&quot;: false,
      &quot;url&quot;: &quot;ldap://ldap.example.com:389&quot;,
      &quot;base_dn&quot;: &quot;ou=users,dc=example,dc=com&quot;,
      &quot;bind_dn&quot;: &quot;cn=admin,dc=example,dc=com&quot;,
      &quot;bind_password&quot;: &quot;admin-password&quot;,
      &quot;user_filter&quot;: &quot;(uid=%s)&quot;,
      &quot;group_filter&quot;: &quot;(member=%s)&quot;
    }
  },
  &quot;authorization&quot;: {
    &quot;rbac&quot;: {
      &quot;enabled&quot;: true,
      &quot;default_role&quot;: &quot;readonly&quot;,
      &quot;admin_users&quot;: [&quot;admin@example.com&quot;],
      &quot;super_admin_users&quot;: [&quot;superadmin@example.com&quot;]
    }
  },
  &quot;multi_tenant&quot;: {
    &quot;enabled&quot;: true,
    &quot;default_tenant&quot;: &quot;default&quot;,
    &quot;tenant_isolation&quot;: &quot;database&quot;,
    &quot;auto_provision&quot;: false
  },
  &quot;task_orchestration&quot;: {
    &quot;max_concurrent_tasks&quot;: 1000,
    &quot;task_timeout&quot;: &quot;300s&quot;,
    &quot;retry_policy&quot;: {
      &quot;max_attempts&quot;: 3,
      &quot;backoff_strategy&quot;: &quot;exponential&quot;,
      &quot;initial_delay&quot;: &quot;1s&quot;,
      &quot;max_delay&quot;: &quot;60s&quot;
    },
    &quot;queue&quot;: {
      &quot;size&quot;: 10000,
      &quot;priority_levels&quot;: 5,
      &quot;dead_letter_enabled&quot;: true
    }
  },
  &quot;client_management&quot;: {
    &quot;max_clients&quot;: 1000,
    &quot;heartbeat_interval&quot;: &quot;30s&quot;,
    &quot;connection_timeout&quot;: &quot;60s&quot;,
    &quot;reconnection_policy&quot;: {
      &quot;max_attempts&quot;: 5,
      &quot;backoff_strategy&quot;: &quot;exponential&quot;,
      &quot;initial_delay&quot;: &quot;5s&quot;,
      &quot;max_delay&quot;: &quot;300s&quot;
    }
  },
  &quot;security&quot;: {
    &quot;rate_limiting&quot;: {
      &quot;enabled&quot;: true,
      &quot;requests_per_minute&quot;: 100,
      &quot;burst_size&quot;: 20,
      &quot;ip_whitelist&quot;: [&quot;10.0.0.0/8&quot;, &quot;172.16.0.0/12&quot;, &quot;192.168.0.0/16&quot;]
    },
    &quot;audit&quot;: {
      &quot;enabled&quot;: true,
      &quot;events&quot;: [&quot;authentication&quot;, &quot;authorization&quot;, &quot;task_execution&quot;, &quot;client_management&quot;],
      &quot;retention_days&quot;: 90,
      &quot;format&quot;: &quot;json&quot;
    },
    &quot;encryption&quot;: {
      &quot;data_at_rest&quot;: {
        &quot;enabled&quot;: true,
        &quot;algorithm&quot;: &quot;AES-256-GCM&quot;,
        &quot;key_rotation_days&quot;: 90
      },
      &quot;data_in_transit&quot;: {
        &quot;enabled&quot;: true,
        &quot;min_tls_version&quot;: &quot;1.2&quot;
      }
    }
  },
  &quot;monitoring&quot;: {
    &quot;metrics&quot;: {
      &quot;enabled&quot;: true,
      &quot;port&quot;: 9090,
      &quot;path&quot;: &quot;/metrics&quot;,
      &quot;interval&quot;: &quot;15s&quot;
    },
    &quot;health_check&quot;: {
      &quot;enabled&quot;: true,
      &quot;endpoint&quot;: &quot;/health&quot;,
      &quot;detailed&quot;: true
    },
    &quot;alerting&quot;: {
      &quot;enabled&quot;: true,
      &quot;webhook_url&quot;: &quot;https://alerts.example.com/webhook&quot;,
      &quot;thresholds&quot;: {
        &quot;cpu_usage&quot;: 80,
        &quot;memory_usage&quot;: 85,
        &quot;error_rate&quot;: 5,
        &quot;response_time&quot;: 5000
      }
    }
  },
  &quot;logging&quot;: {
    &quot;level&quot;: &quot;info&quot;,
    &quot;format&quot;: &quot;json&quot;,
    &quot;output&quot;: &quot;stdout&quot;,
    &quot;file&quot;: {
      &quot;enabled&quot;: true,
      &quot;path&quot;: &quot;/app/logs/ris-server.log&quot;,
      &quot;max_size&quot;: &quot;100MB&quot;,
      &quot;max_backups&quot;: 10,
      &quot;max_age&quot;: 30,
      &quot;compress&quot;: true
    },
    &quot;audit_log&quot;: {
      &quot;enabled&quot;: true,
      &quot;path&quot;: &quot;/app/logs/audit.log&quot;,
      &quot;max_size&quot;: &quot;100MB&quot;,
      &quot;max_backups&quot;: 30,
      &quot;max_age&quot;: 365
    }
  },
  &quot;performance&quot;: {
    &quot;cache&quot;: {
      &quot;ttl&quot;: &quot;1h&quot;,
      &quot;max_size&quot;: &quot;500MB&quot;,
      &quot;eviction_policy&quot;: &quot;lru&quot;
    },
    &quot;connection_pooling&quot;: {
      &quot;max_connections&quot;: 200,
      &quot;idle_timeout&quot;: &quot;300s&quot;,
      &quot;keep_alive&quot;: true
    },
    &quot;graceful_shutdown&quot;: {
      &quot;timeout&quot;: &quot;30s&quot;,
      &quot;drain_timeout&quot;: &quot;60s&quot;
    }
  },
  &quot;features&quot;: {
    &quot;websocket_compression&quot;: true,
    &quot;http2_enabled&quot;: true,
    &quot;debug_mode&quot;: false,
    &quot;development_mode&quot;: false,
    &quot;auto_backup&quot;: true,
    &quot;telemetry&quot;: false
  }
}
</code></pre>

<h3 id="environment-specific-configurations">Environment-Specific Configurations<a class="headerlink" href="#environment-specific-configurations" title="Permanent link">&para;</a></h3>
<h4 id="development-configuration">Development Configuration<a class="headerlink" href="#development-configuration" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-json">{
  &quot;server&quot;: {
    &quot;host&quot;: &quot;localhost&quot;,
    &quot;port&quot;: 8057,
    &quot;tls&quot;: {
      &quot;enabled&quot;: false
    }
  },
  &quot;database&quot;: {
    &quot;mongodb&quot;: {
      &quot;uri&quot;: &quot;mongodb://localhost:27017/ris_dev&quot;
    },
    &quot;redis&quot;: {
      &quot;uri&quot;: &quot;redis://localhost:6379&quot;,
      &quot;database&quot;: 1
    }
  },
  &quot;logging&quot;: {
    &quot;level&quot;: &quot;debug&quot;,
    &quot;output&quot;: &quot;stdout&quot;
  },
  &quot;features&quot;: {
    &quot;debug_mode&quot;: true,
    &quot;development_mode&quot;: true
  }
}
</code></pre>

<h4 id="production-configuration">Production Configuration<a class="headerlink" href="#production-configuration" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-json">{
  &quot;server&quot;: {
    &quot;host&quot;: &quot;0.0.0.0&quot;,
    &quot;port&quot;: 8057,
    &quot;tls&quot;: {
      &quot;enabled&quot;: true,
      &quot;cert_file&quot;: &quot;/app/certs/server.crt&quot;,
      &quot;key_file&quot;: &quot;/app/certs/server.key&quot;,
      &quot;client_auth&quot;: &quot;require&quot;
    }
  },
  &quot;database&quot;: {
    &quot;mongodb&quot;: {
      &quot;uri&quot;: &quot;mongodb://username:password@mongo1:27017,mongo2:27017,mongo3:27017/ris?replicaSet=rs0&amp;ssl=true&quot;
    },
    &quot;redis&quot;: {
      &quot;uri&quot;: &quot;redis://redis-cluster:6379&quot;,
      &quot;password&quot;: &quot;secure-redis-password&quot;,
      &quot;pool_size&quot;: 100
    }
  },
  &quot;logging&quot;: {
    &quot;level&quot;: &quot;info&quot;,
    &quot;format&quot;: &quot;json&quot;,
    &quot;output&quot;: &quot;file&quot;
  },
  &quot;security&quot;: {
    &quot;rate_limiting&quot;: {
      &quot;enabled&quot;: true,
      &quot;requests_per_minute&quot;: 60
    },
    &quot;audit&quot;: {
      &quot;enabled&quot;: true,
      &quot;retention_days&quot;: 365
    }
  },
  &quot;features&quot;: {
    &quot;debug_mode&quot;: false,
    &quot;development_mode&quot;: false,
    &quot;telemetry&quot;: true
  }
}
</code></pre>

<h3 id="environment-variables">Environment Variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RIS_ENV</code></td>
<td>Environment (dev/staging/prod)</td>
<td><code>development</code></td>
</tr>
<tr>
<td><code>CONFIG_PATH</code></td>
<td>Configuration file path</td>
<td><code>/app/config/config.json</code></td>
</tr>
<tr>
<td><code>MONGODB_URI</code></td>
<td>MongoDB connection string</td>
<td><code>mongodb://localhost:27017/ris</code></td>
</tr>
<tr>
<td><code>REDIS_URI</code></td>
<td>Redis connection string</td>
<td><code>redis://localhost:6379</code></td>
</tr>
<tr>
<td><code>TLS_CERT_FILE</code></td>
<td>TLS certificate file path</td>
<td><code>/app/certs/server.crt</code></td>
</tr>
<tr>
<td><code>TLS_KEY_FILE</code></td>
<td>TLS private key file path</td>
<td><code>/app/certs/server.key</code></td>
</tr>
<tr>
<td><code>JWT_SECRET</code></td>
<td>JWT signing secret</td>
<td>Generated</td>
</tr>
<tr>
<td><code>LOG_LEVEL</code></td>
<td>Logging level</td>
<td><code>info</code></td>
</tr>
<tr>
<td><code>METRICS_PORT</code></td>
<td>Metrics server port</td>
<td><code>9090</code></td>
</tr>
</tbody>
</table>
<h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h2>
<h3 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h3>
<h4 id="jwt-token-authentication">JWT Token Authentication<a class="headerlink" href="#jwt-token-authentication" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">POST /auth/login
Content-Type: application/json

{
  &quot;username&quot;: &quot;admin@example.com&quot;,
  &quot;password&quot;: &quot;secure-password&quot;,
  &quot;tenant_code&quot;: &quot;default&quot;
}
</code></pre>

<p><strong>Response:</strong></p>
<pre class="highlight"><code class="language-json">{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;access_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;,
    &quot;refresh_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;,
    &quot;expires_in&quot;: 86400,
    &quot;token_type&quot;: &quot;Bearer&quot;,
    &quot;user&quot;: {
      &quot;id&quot;: &quot;user-123&quot;,
      &quot;email&quot;: &quot;admin@example.com&quot;,
      &quot;role&quot;: &quot;admin&quot;,
      &quot;tenant_code&quot;: &quot;default&quot;
    }
  }
}
</code></pre>

<h4 id="token-refresh">Token Refresh<a class="headerlink" href="#token-refresh" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">POST /auth/refresh
Content-Type: application/json
Authorization: Bearer &lt;refresh_token&gt;

{
  &quot;refresh_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;
}
</code></pre>

<h3 id="ris-client-management">RIS Client Management<a class="headerlink" href="#ris-client-management" title="Permanent link">&para;</a></h3>
<h4 id="get-all-ris-clients">Get All RIS Clients<a class="headerlink" href="#get-all-ris-clients" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /platform/v1/ris
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<p><strong>Response:</strong></p>
<pre class="highlight"><code class="language-json">{
  &quot;success&quot;: true,
  &quot;data&quot;: [
    {
      &quot;id&quot;: 1,
      &quot;name&quot;: &quot;client-001&quot;,
      &quot;description&quot;: &quot;Production client&quot;,
      &quot;host&quot;: &quot;192.168.1.100&quot;,
      &quot;status&quot;: &quot;active&quot;,
      &quot;connection_status&quot;: &quot;connected&quot;,
      &quot;version&quot;: &quot;1.0.0&quot;,
      &quot;unique_client_id&quot;: &quot;uuid-string&quot;,
      &quot;tenant_code&quot;: &quot;default&quot;,
      &quot;created_date&quot;: 1696752000000,
      &quot;updated_date&quot;: 1696752000000,
      &quot;last_seen&quot;: &quot;2025-10-07T10:30:00Z&quot;,
      &quot;capabilities&quot;: [&quot;task_execution&quot;, &quot;service_management&quot;]
    }
  ],
  &quot;total&quot;: 1,
  &quot;page&quot;: 1,
  &quot;per_page&quot;: 10
}
</code></pre>

<h4 id="add-new-ris-client">Add New RIS Client<a class="headerlink" href="#add-new-ris-client" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">POST /platform/v1/ris
Content-Type: application/json
Authorization: Bearer &lt;access_token&gt;

{
  &quot;name&quot;: &quot;client-002&quot;,
  &quot;description&quot;: &quot;Development client&quot;,
  &quot;host&quot;: &quot;192.168.1.101&quot;,
  &quot;tenant_code&quot;: &quot;dev&quot;
}
</code></pre>

<h4 id="update-ris-client">Update RIS Client<a class="headerlink" href="#update-ris-client" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">PUT /platform/v1/ris
Content-Type: application/json
Authorization: Bearer &lt;access_token&gt;

{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;client-001-updated&quot;,
  &quot;description&quot;: &quot;Updated production client&quot;,
  &quot;status&quot;: &quot;active&quot;
}
</code></pre>

<h4 id="delete-ris-client">Delete RIS Client<a class="headerlink" href="#delete-ris-client" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">DELETE /platform/v1/ris
Content-Type: application/json
Authorization: Bearer &lt;access_token&gt;

{
  &quot;id&quot;: 1
}
</code></pre>

<h4 id="get-client-configuration">Get Client Configuration<a class="headerlink" href="#get-client-configuration" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /platform/v1/risclient/{client-id}/{hostname}
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<p><strong>Response:</strong></p>
<pre class="highlight"><code class="language-json">{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;client_config&quot;: {
      &quot;server_host&quot;: &quot;https://ris-server.example.com:8057&quot;,
      &quot;websocket_path&quot;: &quot;/pingpong&quot;,
      &quot;heartbeat_interval&quot;: 30,
      &quot;reconnect_policy&quot;: {
        &quot;max_attempts&quot;: 5,
        &quot;backoff_strategy&quot;: &quot;exponential&quot;
      }
    },
    &quot;certificates&quot;: {
      &quot;client_cert&quot;: &quot;-----BEGIN CERTIFICATE-----\n...&quot;,
      &quot;client_key&quot;: &quot;-----BEGIN PRIVATE KEY-----\n...&quot;,
      &quot;ca_cert&quot;: &quot;-----BEGIN CERTIFICATE-----\n...&quot;
    },
    &quot;tenant_info&quot;: {
      &quot;tenant_code&quot;: &quot;default&quot;,
      &quot;tenant_name&quot;: &quot;Default Tenant&quot;,
      &quot;database_config&quot;: {
        &quot;host&quot;: &quot;tenant-db.example.com&quot;,
        &quot;database&quot;: &quot;tenant_default&quot;
      }
    }
  }
}
</code></pre>

<h3 id="task-management">Task Management<a class="headerlink" href="#task-management" title="Permanent link">&para;</a></h3>
<h4 id="execute-task-on-client">Execute Task on Client<a class="headerlink" href="#execute-task-on-client" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">POST /platform/v1/task/execute
Content-Type: application/json
Authorization: Bearer &lt;access_token&gt;

{
  &quot;client_id&quot;: &quot;uuid-string&quot;,
  &quot;task&quot;: {
    &quot;type&quot;: &quot;http_request&quot;,
    &quot;method&quot;: &quot;GET&quot;,
    &quot;url&quot;: &quot;https://api.example.com/status&quot;,
    &quot;headers&quot;: {
      &quot;Authorization&quot;: &quot;Bearer token&quot;
    },
    &quot;timeout&quot;: 30
  },
  &quot;priority&quot;: &quot;normal&quot;,
  &quot;async&quot;: false
}
</code></pre>

<p><strong>Response:</strong></p>
<pre class="highlight"><code class="language-json">{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;task_id&quot;: &quot;task-123&quot;,
    &quot;status&quot;: &quot;completed&quot;,
    &quot;result&quot;: {
      &quot;status_code&quot;: 200,
      &quot;headers&quot;: {},
      &quot;body&quot;: &quot;OK&quot;,
      &quot;execution_time&quot;: 1250
    },
    &quot;started_at&quot;: &quot;2025-10-07T10:30:00Z&quot;,
    &quot;completed_at&quot;: &quot;2025-10-07T10:30:01Z&quot;
  }
}
</code></pre>

<h4 id="get-task-status">Get Task Status<a class="headerlink" href="#get-task-status" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /platform/v1/task/{task-id}
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<h4 id="list-tasks">List Tasks<a class="headerlink" href="#list-tasks" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /platform/v1/tasks?status=running&amp;client_id=uuid-string&amp;limit=50
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<h3 id="service-management">Service Management<a class="headerlink" href="#service-management" title="Permanent link">&para;</a></h3>
<h4 id="deploy-service-to-client">Deploy Service to Client<a class="headerlink" href="#deploy-service-to-client" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">POST /platform/v1/service/deploy
Content-Type: application/json
Authorization: Bearer &lt;access_token&gt;

{
  &quot;client_id&quot;: &quot;uuid-string&quot;,
  &quot;service&quot;: {
    &quot;name&quot;: &quot;web-app&quot;,
    &quot;image&quot;: &quot;nginx:latest&quot;,
    &quot;replicas&quot;: 3,
    &quot;ports&quot;: [
      {
        &quot;container_port&quot;: 80,
        &quot;host_port&quot;: 8080
      }
    ],
    &quot;environment&quot;: {
      &quot;ENV&quot;: &quot;production&quot;
    },
    &quot;resources&quot;: {
      &quot;limits&quot;: {
        &quot;memory&quot;: &quot;512m&quot;,
        &quot;cpu&quot;: &quot;0.5&quot;
      }
    }
  }
}
</code></pre>

<h4 id="scale-service">Scale Service<a class="headerlink" href="#scale-service" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">POST /platform/v1/service/scale
Content-Type: application/json
Authorization: Bearer &lt;access_token&gt;

{
  &quot;client_id&quot;: &quot;uuid-string&quot;,
  &quot;service_name&quot;: &quot;web-app&quot;,
  &quot;replicas&quot;: 5
}
</code></pre>

<h4 id="get-service-status">Get Service Status<a class="headerlink" href="#get-service-status" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /platform/v1/service/{client-id}/{service-name}
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<h3 id="tenant-management">Tenant Management<a class="headerlink" href="#tenant-management" title="Permanent link">&para;</a></h3>
<h4 id="get-tenant-information">Get Tenant Information<a class="headerlink" href="#get-tenant-information" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /internal/v1/remotetenantclient/{tenant-uuid}
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<h4 id="get-tenant-configuration">Get Tenant Configuration<a class="headerlink" href="#get-tenant-configuration" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /platform/v1/remotetenantconfigdata/{tenant-id}/{hostname}
Authorization: Bearer &lt;access_token&gt;
</code></pre>

<h3 id="monitoring-and-health">Monitoring and Health<a class="headerlink" href="#monitoring-and-health" title="Permanent link">&para;</a></h3>
<h4 id="server-health-check">Server Health Check<a class="headerlink" href="#server-health-check" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /health
</code></pre>

<p><strong>Response:</strong></p>
<pre class="highlight"><code class="language-json">{
  &quot;status&quot;: &quot;healthy&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;uptime&quot;: &quot;2h30m15s&quot;,
  &quot;timestamp&quot;: &quot;2025-10-07T10:30:00Z&quot;,
  &quot;components&quot;: {
    &quot;database&quot;: {
      &quot;status&quot;: &quot;connected&quot;,
      &quot;response_time&quot;: 12,
      &quot;connections&quot;: {
        &quot;active&quot;: 15,
        &quot;idle&quot;: 5,
        &quot;max&quot;: 100
      }
    },
    &quot;cache&quot;: {
      &quot;status&quot;: &quot;connected&quot;,
      &quot;response_time&quot;: 2,
      &quot;memory_usage&quot;: &quot;45.2%&quot;,
      &quot;hit_ratio&quot;: &quot;89.5%&quot;
    },
    &quot;clients&quot;: {
      &quot;total&quot;: 25,
      &quot;connected&quot;: 23,
      &quot;disconnected&quot;: 2,
      &quot;last_heartbeat&quot;: &quot;2025-10-07T10:29:45Z&quot;
    },
    &quot;tasks&quot;: {
      &quot;running&quot;: 12,
      &quot;queued&quot;: 3,
      &quot;completed_today&quot;: 1547,
      &quot;failed_today&quot;: 8
    }
  },
  &quot;system&quot;: {
    &quot;cpu_usage&quot;: 25.5,
    &quot;memory_usage&quot;: 65.2,
    &quot;disk_usage&quot;: 42.1,
    &quot;network_io&quot;: {
      &quot;bytes_in&quot;: 1048576,
      &quot;bytes_out&quot;: 2097152
    }
  }
}
</code></pre>

<h4 id="readiness-check">Readiness Check<a class="headerlink" href="#readiness-check" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /ready
</code></pre>

<h4 id="metrics-endpoint">Metrics Endpoint<a class="headerlink" href="#metrics-endpoint" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-http">GET /metrics
</code></pre>

<h2 id="client-management">Client Management<a class="headerlink" href="#client-management" title="Permanent link">&para;</a></h2>
<h3 id="client-registration-process">Client Registration Process<a class="headerlink" href="#client-registration-process" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant Client as RIS Client
    participant LB as Load Balancer
    participant Server as RIS Server
    participant DB as Database
    participant Auth as Auth Service

    Client->>LB: WebSocket Connection Request
    LB->>Server: Route to Available Server
    Server->>Auth: Validate Client Certificate
    Auth-->>Server: Certificate Valid

    Server->>Server: Upgrade to WebSocket
    Server-->>Client: Connection Established

    Client->>Server: Registration Data
    Note right of Client: {clienthost, unique_id,<br/>version, capabilities}

    Server->>Server: Validate Registration
    Server->>DB: Store/Update Client Info
    DB-->>Server: Success

    Server->>Server: Generate Configuration
    Server-->>Client: Registration Acknowledgment

    loop Heartbeat
        Client->>Server: Heartbeat
        Server-->>Client: Heartbeat ACK
    end
</div>

<h3 id="client-lifecycle-management">Client Lifecycle Management<a class="headerlink" href="#client-lifecycle-management" title="Permanent link">&para;</a></h3>
<h4 id="registration">Registration<a class="headerlink" href="#registration" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type ClientRegistration struct {
    ClientHost       string   `json:&quot;clienthost&quot;`
    UniqueClientID   string   `json:&quot;unique_client_id&quot;`
    Version          string   `json:&quot;version&quot;`
    Capabilities     []string `json:&quot;capabilities&quot;`
    TenantCode       string   `json:&quot;tenantcode&quot;`
    HostType         string   `json:&quot;host_type&quot;`
    IsFirstPing      string   `json:&quot;isfirstping&quot;`
    IsNetworkChanged string   `json:&quot;isnetworkchanged&quot;`
    RISNatIP         string   `json:&quot;ris_nat_ip&quot;`
}
</code></pre>

<h4 id="status-monitoring">Status Monitoring<a class="headerlink" href="#status-monitoring" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type ClientStatus struct {
    ID               int       `json:&quot;id&quot;`
    UniqueClientID   string    `json:&quot;unique_client_id&quot;`
    Status           string    `json:&quot;status&quot;`
    ConnectionStatus string    `json:&quot;connection_status&quot;`
    LastSeen         time.Time `json:&quot;last_seen&quot;`
    IPAddress        string    `json:&quot;ip_address&quot;`
    Version          string    `json:&quot;version&quot;`
    Capabilities     []string  `json:&quot;capabilities&quot;`
    ResourceUsage    struct {
        CPU    float64 `json:&quot;cpu&quot;`
        Memory float64 `json:&quot;memory&quot;`
        Disk   float64 `json:&quot;disk&quot;`
    } `json:&quot;resource_usage&quot;`
}
</code></pre>

<h4 id="connection-management">Connection Management<a class="headerlink" href="#connection-management" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type ConnectionManager struct {
    clients           map[string]*ClientConnection
    disconnectedCount map[string]int
    mutex             sync.RWMutex
    heartbeatInterval time.Duration
    timeoutDuration   time.Duration
}

func (cm *ConnectionManager) AddClient(clientID string, conn *websocket.Conn) error
func (cm *ConnectionManager) RemoveClient(clientID string) error
func (cm *ConnectionManager) GetClient(clientID string) (*ClientConnection, error)
func (cm *ConnectionManager) BroadcastToClients(message []byte) error
func (cm *ConnectionManager) GetConnectedClients() []string
</code></pre>

<h3 id="client-authentication-and-authorization">Client Authentication and Authorization<a class="headerlink" href="#client-authentication-and-authorization" title="Permanent link">&para;</a></h3>
<h4 id="certificate-based-authentication">Certificate-Based Authentication<a class="headerlink" href="#certificate-based-authentication" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type ClientAuth struct {
    CertificateAuth bool   `json:&quot;certificate_auth&quot;`
    ClientCert      string `json:&quot;client_cert&quot;`
    ClientKey       string `json:&quot;client_key&quot;`
    CACert          string `json:&quot;ca_cert&quot;`
}

func ValidateClientCertificate(cert *x509.Certificate, caCert *x509.Certificate) error {
    // Certificate validation logic
    roots := x509.NewCertPool()
    roots.AddCert(caCert)

    opts := x509.VerifyOptions{Roots: roots}
    _, err := cert.Verify(opts)
    return err
}
</code></pre>

<h4 id="token-based-authentication">Token-Based Authentication<a class="headerlink" href="#token-based-authentication" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type ClientTokenAuth struct {
    TokenType    string    `json:&quot;token_type&quot;`
    AccessToken  string    `json:&quot;access_token&quot;`
    RefreshToken string    `json:&quot;refresh_token&quot;`
    ExpiresAt    time.Time `json:&quot;expires_at&quot;`
}

func ValidateClientToken(token string) (*ClientClaims, error) {
    // JWT token validation
    claims := &amp;ClientClaims{}
    _, err := jwt.ParseWithClaims(token, claims, func(token *jwt.Token) (interface{}, error) {
        return jwtSecret, nil
    })
    return claims, err
}
</code></pre>

<h2 id="task-orchestration">Task Orchestration<a class="headerlink" href="#task-orchestration" title="Permanent link">&para;</a></h2>
<h3 id="task-routing-engine">Task Routing Engine<a class="headerlink" href="#task-routing-engine" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Task Submission"
        API[API Request]
        VALIDATE[Validate Task]
        AUTH[Authorize User]
    end

    subgraph "Task Orchestration"
        QUEUE[Task Queue]
        ROUTER[Task Router]
        LB[Load Balancer]
        SELECTOR[Client Selector]
    end

    subgraph "Task Execution"
        CLIENT1[RIS Client 1]
        CLIENT2[RIS Client 2]
        CLIENTN[RIS Client N]
    end

    subgraph "Task Monitoring"
        TRACKER[Task Tracker]
        STATUS[Status Monitor]
        LOGGER[Audit Logger]
    end

    API --> VALIDATE
    VALIDATE --> AUTH
    AUTH --> QUEUE

    QUEUE --> ROUTER
    ROUTER --> LB
    LB --> SELECTOR

    SELECTOR --> CLIENT1
    SELECTOR --> CLIENT2
    SELECTOR --> CLIENTN

    CLIENT1 --> TRACKER
    CLIENT2 --> TRACKER
    CLIENTN --> TRACKER

    TRACKER --> STATUS
    TRACKER --> LOGGER

    style QUEUE fill:#fff3e0
    style ROUTER fill:#e8f5e8
    style TRACKER fill:#e3f2fd
</div>

<h3 id="task-types-and-schemas">Task Types and Schemas<a class="headerlink" href="#task-types-and-schemas" title="Permanent link">&para;</a></h3>
<h4 id="http-request-task">HTTP Request Task<a class="headerlink" href="#http-request-task" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type HTTPTask struct {
    TaskID      string            `json:&quot;task_id&quot;`
    Type        string            `json:&quot;type&quot;`
    Method      string            `json:&quot;method&quot;`
    URL         string            `json:&quot;url&quot;`
    Headers     map[string]string `json:&quot;headers&quot;`
    Body        string            `json:&quot;body&quot;`
    Timeout     int               `json:&quot;timeout&quot;`
    Retries     int               `json:&quot;retries&quot;`
    Auth        AuthConfig        `json:&quot;auth&quot;`
    Validation  ValidationConfig  `json:&quot;validation&quot;`
}

type AuthConfig struct {
    Type         string `json:&quot;type&quot;`
    Username     string `json:&quot;username&quot;`
    Password     string `json:&quot;password&quot;`
    BearerToken  string `json:&quot;bearer_token&quot;`
    APIKey       string `json:&quot;api_key&quot;`
    CustomHeader string `json:&quot;custom_header&quot;`
}
</code></pre>

<h4 id="docker-service-task">Docker Service Task<a class="headerlink" href="#docker-service-task" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type DockerTask struct {
    TaskID       string                 `json:&quot;task_id&quot;`
    Type         string                 `json:&quot;type&quot;`
    Action       string                 `json:&quot;action&quot;`
    ServiceName  string                 `json:&quot;service_name&quot;`
    Image        string                 `json:&quot;image&quot;`
    Replicas     int                    `json:&quot;replicas&quot;`
    Ports        []PortMapping          `json:&quot;ports&quot;`
    Environment  map[string]string      `json:&quot;environment&quot;`
    Volumes      []VolumeMapping        `json:&quot;volumes&quot;`
    Networks     []string               `json:&quot;networks&quot;`
    Resources    ResourceConstraints    `json:&quot;resources&quot;`
    HealthCheck  HealthCheckConfig      `json:&quot;health_check&quot;`
}

type PortMapping struct {
    ContainerPort int    `json:&quot;container_port&quot;`
    HostPort      int    `json:&quot;host_port&quot;`
    Protocol      string `json:&quot;protocol&quot;`
}
</code></pre>

<h4 id="system-command-task">System Command Task<a class="headerlink" href="#system-command-task" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type CommandTask struct {
    TaskID      string            `json:&quot;task_id&quot;`
    Type        string            `json:&quot;type&quot;`
    Command     string            `json:&quot;command&quot;`
    Args        []string          `json:&quot;args&quot;`
    WorkingDir  string            `json:&quot;working_dir&quot;`
    Environment map[string]string `json:&quot;environment&quot;`
    Timeout     int               `json:&quot;timeout&quot;`
    RunAsUser   string            `json:&quot;run_as_user&quot;`
    Privileged  bool              `json:&quot;privileged&quot;`
}
</code></pre>

<h3 id="task-execution-flow">Task Execution Flow<a class="headerlink" href="#task-execution-flow" title="Permanent link">&para;</a></h3>
<h4 id="task-lifecycle">Task Lifecycle<a class="headerlink" href="#task-lifecycle" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type TaskStatus string

const (
    TaskStatusPending   TaskStatus = &quot;pending&quot;
    TaskStatusQueued    TaskStatus = &quot;queued&quot;
    TaskStatusRunning   TaskStatus = &quot;running&quot;
    TaskStatusCompleted TaskStatus = &quot;completed&quot;
    TaskStatusFailed    TaskStatus = &quot;failed&quot;
    TaskStatusCancelled TaskStatus = &quot;cancelled&quot;
    TaskStatusTimeout   TaskStatus = &quot;timeout&quot;
)

type Task struct {
    ID          string                 `json:&quot;id&quot; bson:&quot;_id&quot;`
    Type        string                 `json:&quot;type&quot; bson:&quot;type&quot;`
    Status      TaskStatus             `json:&quot;status&quot; bson:&quot;status&quot;`
    Priority    int                    `json:&quot;priority&quot; bson:&quot;priority&quot;`
    ClientID    string                 `json:&quot;client_id&quot; bson:&quot;client_id&quot;`
    TenantCode  string                 `json:&quot;tenant_code&quot; bson:&quot;tenant_code&quot;`
    UserID      string                 `json:&quot;user_id&quot; bson:&quot;user_id&quot;`
    Payload     map[string]interface{} `json:&quot;payload&quot; bson:&quot;payload&quot;`
    Result      *TaskResult            `json:&quot;result,omitempty&quot; bson:&quot;result,omitempty&quot;`
    CreatedAt   time.Time              `json:&quot;created_at&quot; bson:&quot;created_at&quot;`
    StartedAt   *time.Time             `json:&quot;started_at,omitempty&quot; bson:&quot;started_at,omitempty&quot;`
    CompletedAt *time.Time             `json:&quot;completed_at,omitempty&quot; bson:&quot;completed_at,omitempty&quot;`
    Timeout     time.Duration          `json:&quot;timeout&quot; bson:&quot;timeout&quot;`
    Retries     int                    `json:&quot;retries&quot; bson:&quot;retries&quot;`
    MaxRetries  int                    `json:&quot;max_retries&quot; bson:&quot;max_retries&quot;`
    Metadata    map[string]interface{} `json:&quot;metadata&quot; bson:&quot;metadata&quot;`
}
</code></pre>

<h4 id="task-orchestrator-implementation">Task Orchestrator Implementation<a class="headerlink" href="#task-orchestrator-implementation" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type TaskOrchestrator struct {
    queue          TaskQueue
    router         TaskRouter
    clientManager  ClientManager
    taskTracker    TaskTracker
    config         OrchestratorConfig
    metrics        MetricsCollector
    logger         Logger
}

func (to *TaskOrchestrator) SubmitTask(task *Task) error {
    // Validate task
    if err := to.validateTask(task); err != nil {
        return fmt.Errorf(&quot;task validation failed: %w&quot;, err)
    }

    // Add to queue
    if err := to.queue.Enqueue(task); err != nil {
        return fmt.Errorf(&quot;failed to queue task: %w&quot;, err)
    }

    // Start processing if not async
    if !task.Async {
        return to.processTask(task)
    }

    return nil
}

func (to *TaskOrchestrator) processTask(task *Task) error {
    // Select appropriate client
    client, err := to.selectClient(task)
    if err != nil {
        return fmt.Errorf(&quot;client selection failed: %w&quot;, err)
    }

    // Route task to client
    return to.router.RouteTask(task, client)
}
</code></pre>

<h3 id="priority-and-queue-management">Priority and Queue Management<a class="headerlink" href="#priority-and-queue-management" title="Permanent link">&para;</a></h3>
<h4 id="priority-queue-implementation">Priority Queue Implementation<a class="headerlink" href="#priority-queue-implementation" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type PriorityQueue struct {
    queues   map[int]*Queue  // Priority level -&gt; Queue
    mutex    sync.RWMutex
    maxSize  int
    metrics  *QueueMetrics
}

func (pq *PriorityQueue) Enqueue(task *Task) error {
    pq.mutex.Lock()
    defer pq.mutex.Unlock()

    priority := task.Priority
    if priority &lt; 1 || priority &gt; 5 {
        priority = 3 // Default priority
    }

    queue, exists := pq.queues[priority]
    if !exists {
        queue = NewQueue(pq.maxSize / 5)
        pq.queues[priority] = queue
    }

    return queue.Enqueue(task)
}

func (pq *PriorityQueue) Dequeue() (*Task, error) {
    pq.mutex.Lock()
    defer pq.mutex.Unlock()

    // Process highest priority first
    for priority := 5; priority &gt;= 1; priority-- {
        if queue, exists := pq.queues[priority]; exists {
            if task, err := queue.Dequeue(); err == nil {
                return task, nil
            }
        }
    }

    return nil, ErrQueueEmpty
}
</code></pre>

<h2 id="multi-tenant-architecture">Multi-Tenant Architecture<a class="headerlink" href="#multi-tenant-architecture" title="Permanent link">&para;</a></h2>
<h3 id="tenant-isolation-strategies">Tenant Isolation Strategies<a class="headerlink" href="#tenant-isolation-strategies" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Request Layer"
        REQ[HTTP Request]
        EXTRACT[Extract Tenant Context]
        VALIDATE[Validate Tenant]
    end

    subgraph "Data Layer Isolation"
        subgraph "Database Level"
            DB1[(Tenant A DB)]
            DB2[(Tenant B DB)]
            DB3[(Shared DB)]
        end

        subgraph "Application Level"
            FILTER[Data Filtering]
            SCOPE[Query Scoping]
            ENCRYPT[Tenant Encryption]
        end
    end

    subgraph "Resource Isolation"
        CONN1[Tenant A Connections]
        CONN2[Tenant B Connections]
        CACHE1[Tenant A Cache]
        CACHE2[Tenant B Cache]
    end

    REQ --> EXTRACT
    EXTRACT --> VALIDATE
    VALIDATE --> FILTER
    VALIDATE --> SCOPE

    FILTER --> DB1
    FILTER --> DB2
    FILTER --> DB3

    SCOPE --> ENCRYPT
    ENCRYPT --> CONN1
    ENCRYPT --> CONN2

    CONN1 --> CACHE1
    CONN2 --> CACHE2

    style DB1 fill:#e8f5e8
    style DB2 fill:#fff3e0
    style DB3 fill:#e3f2fd
    style ENCRYPT fill:#ffcdd2
</div>

<h3 id="tenant-management_1">Tenant Management<a class="headerlink" href="#tenant-management_1" title="Permanent link">&para;</a></h3>
<h4 id="tenant-model">Tenant Model<a class="headerlink" href="#tenant-model" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type Tenant struct {
    ID           string            `json:&quot;id&quot; bson:&quot;_id&quot;`
    Code         string            `json:&quot;code&quot; bson:&quot;code&quot;`
    Name         string            `json:&quot;name&quot; bson:&quot;name&quot;`
    Description  string            `json:&quot;description&quot; bson:&quot;description&quot;`
    Status       string            `json:&quot;status&quot; bson:&quot;status&quot;`
    DatabaseInfo DatabaseInfo      `json:&quot;database_info&quot; bson:&quot;database_info&quot;`
    Settings     TenantSettings    `json:&quot;settings&quot; bson:&quot;settings&quot;`
    Limits       ResourceLimits    `json:&quot;limits&quot; bson:&quot;limits&quot;`
    CreatedAt    time.Time         `json:&quot;created_at&quot; bson:&quot;created_at&quot;`
    UpdatedAt    time.Time         `json:&quot;updated_at&quot; bson:&quot;updated_at&quot;`
    Metadata     map[string]interface{} `json:&quot;metadata&quot; bson:&quot;metadata&quot;`
}

type DatabaseInfo struct {
    Type         string `json:&quot;type&quot; bson:&quot;type&quot;`
    Host         string `json:&quot;host&quot; bson:&quot;host&quot;`
    Port         int    `json:&quot;port&quot; bson:&quot;port&quot;`
    Database     string `json:&quot;database&quot; bson:&quot;database&quot;`
    Username     string `json:&quot;username&quot; bson:&quot;username&quot;`
    Password     string `json:&quot;password&quot; bson:&quot;password&quot;`
    SSL          bool   `json:&quot;ssl&quot; bson:&quot;ssl&quot;`
    MaxPoolSize  int    `json:&quot;max_pool_size&quot; bson:&quot;max_pool_size&quot;`
}

type TenantSettings struct {
    TimeZone           string            `json:&quot;timezone&quot; bson:&quot;timezone&quot;`
    Language           string            `json:&quot;language&quot; bson:&quot;language&quot;`
    Features           []string          `json:&quot;features&quot; bson:&quot;features&quot;`
    SecurityPolicy     SecurityPolicy    `json:&quot;security_policy&quot; bson:&quot;security_policy&quot;`
    NotificationConfig NotificationConfig `json:&quot;notification_config&quot; bson:&quot;notification_config&quot;`
}

type ResourceLimits struct {
    MaxClients      int `json:&quot;max_clients&quot; bson:&quot;max_clients&quot;`
    MaxTasks        int `json:&quot;max_tasks&quot; bson:&quot;max_tasks&quot;`
    MaxStorageGB    int `json:&quot;max_storage_gb&quot; bson:&quot;max_storage_gb&quot;`
    MaxBandwidthMBs int `json:&quot;max_bandwidth_mbs&quot; bson:&quot;max_bandwidth_mbs&quot;`
}
</code></pre>

<h4 id="tenant-context-management">Tenant Context Management<a class="headerlink" href="#tenant-context-management" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type TenantContext struct {
    TenantID     string                 `json:&quot;tenant_id&quot;`
    TenantCode   string                 `json:&quot;tenant_code&quot;`
    UserID       string                 `json:&quot;user_id&quot;`
    Permissions  []string               `json:&quot;permissions&quot;`
    Settings     TenantSettings         `json:&quot;settings&quot;`
    Limits       ResourceLimits         `json:&quot;limits&quot;`
    DBSession    database.Session       `json:&quot;-&quot;`
    CacheClient  cache.Client           `json:&quot;-&quot;`
    Metadata     map[string]interface{} `json:&quot;metadata&quot;`
}

type TenantManager struct {
    tenantRepo    TenantRepository
    dbManager     DatabaseManager
    cacheManager  CacheManager
    encryptionSvc EncryptionService
    mutex         sync.RWMutex
    tenantCache   map[string]*TenantContext
}

func (tm *TenantManager) GetTenantContext(tenantCode string) (*TenantContext, error) {
    // Check cache first
    if ctx, exists := tm.tenantCache[tenantCode]; exists {
        return ctx, nil
    }

    // Load from database
    tenant, err := tm.tenantRepo.GetByCode(tenantCode)
    if err != nil {
        return nil, fmt.Errorf(&quot;tenant not found: %w&quot;, err)
    }

    // Create database session
    dbSession, err := tm.dbManager.CreateTenantSession(tenant.DatabaseInfo)
    if err != nil {
        return nil, fmt.Errorf(&quot;failed to create DB session: %w&quot;, err)
    }

    // Create cache client
    cacheClient, err := tm.cacheManager.CreateTenantClient(tenantCode)
    if err != nil {
        return nil, fmt.Errorf(&quot;failed to create cache client: %w&quot;, err)
    }

    ctx := &amp;TenantContext{
        TenantID:    tenant.ID,
        TenantCode:  tenant.Code,
        Settings:    tenant.Settings,
        Limits:      tenant.Limits,
        DBSession:   dbSession,
        CacheClient: cacheClient,
    }

    // Cache context
    tm.tenantCache[tenantCode] = ctx

    return ctx, nil
}
</code></pre>

<h3 id="database-isolation">Database Isolation<a class="headerlink" href="#database-isolation" title="Permanent link">&para;</a></h3>
<h4 id="tenant-specific-database-connections">Tenant-Specific Database Connections<a class="headerlink" href="#tenant-specific-database-connections" title="Permanent link">&para;</a></h4>
<pre class="highlight"><code class="language-go">type DatabaseManager struct {
    defaultDB     database.Database
    tenantDBs     map[string]database.Database
    poolManager   ConnectionPoolManager
    encryptionSvc EncryptionService
    mutex         sync.RWMutex
}

func (dm *DatabaseManager) CreateTenantSession(dbInfo DatabaseInfo) (database.Session, error) {
    tenantKey := fmt.Sprintf(&quot;%s:%s&quot;, dbInfo.Host, dbInfo.Database)

    // Check if tenant DB connection exists
    db, exists := dm.tenantDBs[tenantKey]
    if !exists {
        // Create new connection
        var err error
        db, err = dm.createTenantConnection(dbInfo)
        if err != nil {
            return nil, fmt.Errorf(&quot;failed to create tenant connection: %w&quot;, err)
        }

        dm.mutex.Lock()
        dm.tenantDBs[tenantKey] = db
        dm.mutex.Unlock()
    }

    // Create session with tenant context
    session := db.NewSession()
    session.SetTenantContext(dbInfo.Database)

    return session, nil
}

func (dm *DatabaseManager) createTenantConnection(dbInfo DatabaseInfo) (database.Database, error) {
    // Decrypt database credentials
    password, err := dm.encryptionSvc.Decrypt(dbInfo.Password)
    if err != nil {
        return nil, fmt.Errorf(&quot;failed to decrypt password: %w&quot;, err)
    }

    // Build connection URI
    uri := fmt.Sprintf(&quot;mongodb://%s:%s@%s:%d/%s&quot;,
        dbInfo.Username, password, dbInfo.Host, dbInfo.Port, dbInfo.Database)

    // Configure connection options
    opts := &amp;database.Options{
        MaxPoolSize:     dbInfo.MaxPoolSize,
        ConnectTimeout:  30 * time.Second,
        SocketTimeout:   60 * time.Second,
        SSL:             dbInfo.SSL,
        ReplicaSet:      &quot;&quot;, // Configure if using replica set
    }

    return database.Connect(uri, opts)
}
</code></pre>

<h3 id="data-encryption-per-tenant">Data Encryption per Tenant<a class="headerlink" href="#data-encryption-per-tenant" title="Permanent link">&para;</a></h3>
<pre class="highlight"><code class="language-go">type TenantEncryption struct {
    keyManager    KeyManager
    encryptionSvc EncryptionService
    tenantKeys    map[string][]byte
    mutex         sync.RWMutex
}

func (te *TenantEncryption) EncryptTenantData(tenantCode string, data []byte) ([]byte, error) {
    key, err := te.getTenantKey(tenantCode)
    if err != nil {
        return nil, fmt.Errorf(&quot;failed to get tenant key: %w&quot;, err)
    }

    return te.encryptionSvc.Encrypt(data, key)
}

func (te *TenantEncryption) DecryptTenantData(tenantCode string, encryptedData []byte) ([]byte, error) {
    key, err := te.getTenantKey(tenantCode)
    if err != nil {
        return nil, fmt.Errorf(&quot;failed to get tenant key: %w&quot;, err)
    }

    return te.encryptionSvc.Decrypt(encryptedData, key)
}

func (te *TenantEncryption) getTenantKey(tenantCode string) ([]byte, error) {
    te.mutex.RLock()
    if key, exists := te.tenantKeys[tenantCode]; exists {
        te.mutex.RUnlock()
        return key, nil
    }
    te.mutex.RUnlock()

    // Generate or retrieve tenant-specific key
    key, err := te.keyManager.GetTenantKey(tenantCode)
    if err != nil {
        return nil, err
    }

    te.mutex.Lock()
    te.tenantKeys[tenantCode] = key
    te.mutex.Unlock()

    return key, nil
}
</code></pre>

<hr />
<p><em>Document Version: 1.0</em><br />
<em>Last Updated: October 7, 2025</em><br />
<em>Comprehensive RIS Server Documentation</em></p>
    </main>

    <footer class="footer">
        <p>&copy; 2025 Securaa Security Platform. All rights reserved.</p>
        <p>Documentation generated on December 04, 2025</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#4f46e5',
                primaryTextColor: '#1f2937',
                primaryBorderColor: '#818cf8',
                lineColor: '#6b7280',
                secondaryColor: '#f3f4f6',
                tertiaryColor: '#e5e7eb',
                background: '#ffffff',
                mainBkg: '#f9fafb',
                secondBkg: '#f3f4f6',
                border1: '#e5e7eb',
                border2: '#d1d5db',
                fontFamily: 'Inter, sans-serif',
                fontSize: '14px',
                nodeBorder: '#4f46e5',
                clusterBkg: '#f0f4f8',
                clusterBorder: '#818cf8',
                edgeLabelBackground: '#ffffff'
            },
            flowchart: {
                htmlLabels: true,
                useMaxWidth: true,
                curve: 'basis',
                padding: 15,
                nodeSpacing: 50,
                rankSpacing: 50
            },
            sequence: {
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                useMaxWidth: true
            },
            er: {
                useMaxWidth: true,
                entityPadding: 15,
                fontSize: 12
            },
            class: {
                useMaxWidth: true,
                padding: 10
            },
            gantt: {
                useMaxWidth: true,
                barHeight: 20,
                barGap: 4,
                topPadding: 50,
                leftPadding: 75
            },
            pie: {
                useMaxWidth: true,
                textPosition: 0.5
            },
            mindmap: {
                useMaxWidth: true,
                padding: 10
            },
            securityLevel: 'loose',
            logLevel: 'error'
        });

        // Re-render mermaid diagrams after page load for better sizing
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.querySelectorAll('.mermaid').forEach(function(el) {
                    if (el.getAttribute('data-processed') !== 'true') {
                        mermaid.init(undefined, el);
                    }
                });
            }, 100);
        });
    </script>
</body>
</html>
